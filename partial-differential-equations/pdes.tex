\documentclass[12pt]{article}
\usepackage[utf 8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{amsthm}
\usepackage{esint}
\usepackage{float}
\usepackage{tikz-cd}
\usepackage{marvosym}
\usepackage{empheq}
\usepackage{hyperref}
\hypersetup{colorlinks=true}
\usepackage{pgfplots}
\pgfplotsset{compat=1.15}
\usetikzlibrary{arrows.meta}
\usepackage[nottoc]{tocbibind}
\usepackage[left=2cm,top=2.5cm,right=1.5cm,bottom=2.5cm]{geometry}
\setlength{\parindent}{0pt}

\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\diver}{div}
\DeclareMathOperator{\Real}{Re}
\DeclareMathOperator{\Img}{Im}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\area}{area}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\var}{var}
\DeclareMathOperator{\sd}{sd}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator*{\esssup}{ess\,sup}

\renewcommand{\thesubsubsection}{\alph{subsubsection})}

\newtheorem{proposition}{Proposition}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{corollary}{Corollary}[section]
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem*{definition*}{Definition}
\newtheorem*{claim*}{Claim}
\newtheorem{claim}{Claim}
\newtheorem*{remark}{Remark}
\newtheorem*{notation}{Notation}
\newtheorem*{note}{Note}
\newtheorem{explanation}{Explanation}
\newtheorem*{warning}{Warning}
\newtheorem*{revision}{Revision}
\newtheorem*{recall}{Recall}
\newtheorem*{summary}{Summary}
\newtheorem*{goal}{Goal}
\newtheorem*{idea}{Idea}
\newtheorem*{motivation}{Motivation}
\newtheorem*{question}{Question}
\newtheorem*{answer}{Answer}
\newtheorem*{exercise}{Exercise}
\newtheorem{example}{Example}
\newtheorem*{example*}{Example}

\title{Partial Differential Equations}
\author{Gero Friesecke\\\\Notes taken by:\\Alejandro Plaza Gall\'{a}n}
\date{Summer semester 2022}

\begin{document}
%26/04/2022
\maketitle
\tableofcontents
\newpage
\setcounter{section}{-1}
\section{Notation}
%Section 0
\subsection*{Partial derivatives}
Let $u:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}^m$, $\Omega$ open, $x\in\Omega$, $x=(x_1,\ldots,x_n)$.
\[\frac{\partial u}{\partial x_i}(x)=\lim_{h\to0}\frac{u(x_1,\ldots,x_{i-1},x_i+h,x_{i+1},\ldots,x_n)-u(x)}{h}=\lim_{h\to0}\frac{u(x+he_i)-u(x)}{h},\]
\[\frac{\partial^2u}{\partial x_i\partial x_j}=\frac{\partial(\frac{\partial u}{\partial x_j})}{\partial x_i}(x),\]
etc., order doesn't matter (Schwarz).
\[Du(x)=\left(\begin{matrix}\frac{\partial u_1}{\partial x_1}(x)&\ldots&\frac{\partial u_1}{\partial u_m}(x)\\\vdots&&\vdots\\\frac{\partial u_m}{\partial x_1}(x)&\ldots&\frac{\partial u_n}{\partial x_m}(x)\end{matrix}\right)\in\mathbb{R}^{m\times n}\]
matrix of all partial derivatives (Jacobian)

\subsection*{Special case: scalar functions ($\boldsymbol{m=1}$)}
\[\nabla u(x)=\left(\begin{matrix}\frac{\partial u}{\partial x_1}(x)\\\vdots\\\frac{\partial u}{\partial x_n}(x)\end{matrix}\right)\in\mathbb{R}^n\]
is the gradient ($\nabla u(x)=Du(x)^{\intercal}$)
\[D^2u(x)=D\nabla u(x)=\left(\begin{matrix}\frac{\partial^2u}{\partial x_1^2}&\ldots&\frac{\partial^2u}{\partial x_n\partial x_1}\\\vdots&&\vdots\\\frac{\partial^2u}{\partial x_1\partial x_n}&\ldots&\frac{\partial^2u}{\partial x_n^2}\end{matrix}\right)\in\mathbb{R}^{n\times n}\]
is the Hessian

\[\Delta u(x)=\tr D^2u(x)=\sum_{i=1}^n\frac{\partial^2u}{\partial x_1^2}(x)\in\mathbb{R}\]
is the Laplacian.

\subsection*{Special case: vector fields ($\boldsymbol{m=n}$)}
\[\diver u(x)=\sum_{i=1}^n\frac{\partial u_i}{\partial x_i}(x)\in\mathbb{R}\]
is the divergence. Note $\Delta u(x)=\diver\nabla u(x)$. Laplacian = div of grad.

\subsection*{Alternative notations for partial derivatives}
\[\frac{\partial u}{\partial x_i}=u_{x_i}=u_{-i}=D_iu=\partial_iu=\partial_{x_i}u\]

\renewcommand{\thesection}{\Roman{section}}
\section{Introduction}
%Section I
C.F. von Weizs\"{a}der: The general nonlinear partial differential equation is a meta-law of very high generality.

\begin{definition*}
A \textbf{partial differential equation (PDE)} is an equation of the form
\[F\left(x,u(x),\frac{\partial u}{\partial x_1}(x),\ldots,\frac{\partial u}{\partial x_n}(x),\frac{\partial^2u}{\partial x_1^2}(x),\ldots,\frac{\partial^2u}{\partial x_i\partial x_j}(x),\ldots,\text{higher derivatives}\right)=0\ \ \forall x\in\Omega,\]
where $F$ given (``the law''), $u:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}^m$ unknown function, and partial derivatives w.r.t. at least 2 different components of $x$ are present.
\end{definition*}

\begin{definition*}
The \textbf{Order} of the PDE is the maximal order of derivative that occurs.

A PDE is called:
\begin{itemize}
\item \textbf{linear} if $F$ is linear in $u$ and its derivatives,
\item \textbf{quasilinear} if $F$ is linear in highest order derivatives,
\item \textbf{fully nonlinear} if $F$ is nonlinear in highest order derivatives.
\end{itemize}

The \textbf{dimension} of the PDE is $\dim(\Omega)\geq2$
\end{definition*}
3 axes of increasing difficulty: order, dimension and linearity

\begin{example*}
Some basic examples.

\begin{enumerate}[label=\alph*)]
\item \textbf{Transport equation.} $u:\Omega\times\mathbb{R}\rightarrow\mathbb{R}$, $u=u(x,t)$, $x\in\Omega\subseteq\mathbb{R}^d$, $t\in\mathbb{R}$, $v:\mathbb{R}^d\rightarrow\mathbb{R}^d$ given vector field.
\[\frac{\partial u}{\partial t}(x,t)+v(x)\cdot\nabla_xu(x,t)=0\]

``$F$'' form:
\[F(x,u(x),\text{derivatives of }u\text{ at }x)=\frac{\partial u}{\partial t}(x)+\sum_{i=1}^dv_i(x)\frac{\partial u}{\partial x_i}(x).\]

The PDE is linear of $1$\textsuperscript{st} order.

\item \textbf{Laplace's equation.} $u:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}$,
\begin{equation}\tag{1}\label{Laplace}
\Delta u=0.
\end{equation}

\begin{example*}
$n=2$ $f:\mathbb{R}^2\cong\mathbb{C}\rightarrow\mathbb{C}$ holomorphic. Then $u=\Real f$ or $u=\Img f$ solve \eqref{Laplace}.
\end{example*}

Solutions to \eqref{Laplace} are called \textbf{harmonic functions}.

For example $u(x_1,x_2)=x_1^2+x_2^2$ is not harmonic because $\Delta u(x)=2+2$.

However, $u(x_1,x_2)=x_1^2-x_2^2$ is harmonic because $\Delta u(x)=2-2=0$.

\item \textbf{Poisson equation.} $-\Delta u=f$. It is linear of $2$\textsuperscript{nd} order.
\begin{align*}
&u:\mathbb{R}^3\longrightarrow\mathbb{R}\left\{\begin{array}{l}\text{electrostatic potential of a charge distribution},\\\text{gravitational potential of a mass distribution},\end{array}\right.\\
&f:\mathbb{R}^3\longrightarrow\mathbb{R}\text{ given}.
\end{align*}
``$F$'' form:
\[F\left(x,\frac{\partial^2u}{\partial x_1^2},\ldots,\frac{\partial^2u}{\partial x_n^2}\right)=f(x)+\sum_{i=1}^n\frac{\partial^2u}{\partial x_i^2}(x)=0\ \ \forall x\]

It is of $2$\textsuperscript{nd} order, linear.

\begin{warning}
In general, linear combinations of solutions are not solutions!
\end{warning}

\item \textbf{Wave equation.} $u=u(x,t)$, $u:\Omega\times\mathbb{R}\rightarrow\mathbb{R}$, $\Omega\subseteq\mathbb{R}^d$, t = time, $x$ = spatial coordinates.

\[\frac{\partial^2u}{\partial t^2}=\Delta u,\ \ \Delta u=\sum_{i=1}^n\frac{\partial^2u}{\partial x_i^2}\]

$\boldsymbol{d=1}$: $u(x,t)$ is the transversal displacement of a point $x$ on a vibrating string at time $t$

$\boldsymbol{d=2,3}$: the elastic membrane of a drum, sound.

\item \textbf{Heat or diffusion equation.} $u=u(x,t)$, $u:\Omega\times\mathbb{R}\rightarrow\mathbb{R}$, $\Omega\subseteq\mathbb{R}^d$.

\[\frac{\partial u}{\partial t}=\Delta u.\]

$\boldsymbol{d=1}$: $\Omega=[0,L]$,
\[\frac{\partial u}{\partial t}=\frac{\partial^2u}{\partial x^2},\text{ or }u_t=u_{xx}\]

$u(x,t)$ is the temperature at a point $x\in[0,L]$ of a wire at time $t$, or at a point $x\in\Omega$ of a 3D body at time $t$. (Fourier, physics)

$u(x,t)$ is the probability density that a sotchastic (Brownian) particle is at point $x$ at time $t$. (Einstein, Wiener, Stochastics)

\item \textbf{Schr\"{o}dinger equation.} $\psi:\mathbb{R}^3\times\mathbb{R}\rightarrow\mathbb{C}$, $\psi=\psi(x,t)$
\[i\frac{\partial\psi}{\partial t}(x,t)=-\frac{1}{2}\Delta\psi(x,t)-\frac{1}{|x|}\psi(x,t)\]

$|\psi(x,t)|^2$ is the probability density of an electron in a hydrogen atom to be at position $x$ at time $t$ in quantum physics.

\item \textbf{Black-Schokes equation.} $u=u(x,t)$, $x\geq0$, $t\geq0$, $u\geq0$, $u:\mathbb{R}^+\times\mathbb{R}^+\rightarrow\mathbb{R}^+$.

\[u_t+\frac{1}{2}\sigma^2x^2u_{xx}+rxu_x-ru=0,\]

where $r,\sigma$ are parameters.

$u$ is the price of an option of an underlying good.

$x$ is the price of the good.

This equation appears in the area of finance (stocks). It is linear of $2$\textsuperscript{nd} order.

\item \textbf{Navier-Stokes equations.} $u:\Omega\times[0,\infty)\rightarrow\mathbb{R}^3$, $\Omega\subseteq\mathbb{R}^3$.

\[\left\{\begin{array}{l}\displaystyle{\frac{\partial u}{\partial t}-(u\cdot\nabla)u-\nu\Delta u=-\nabla p}\\\diver u=0\end{array}\right.\]

$u(x,t)\in\mathbb{R}^3$ is the velocity of fluid at point $x$ at time $t$.

$p(x,t)\in\mathbb{R}$ is the pressure.

$\nu>0$ is a parameter called viscosity.

$\diver u=0$ means that the fluid is incompressible.

This equation appears in engineering.
\end{enumerate}
\end{example*}

\subsection*{Classification of linear 2nd order PDEs in 2 dim.}

\begin{definition*}
$u=u(x,y)$, $(x,y)\in\mathbb{R}^2$, $u:\mathbb{R}^2\rightarrow\mathbb{R}$.

\[Au_{xx}+Bu_{xy}+Cu_{yy}+Du_x+Eu_y+Fu+G=0,\]
where $A=A(x,y)$, $B=B(x,y)$,... This equation is called:
\begin{itemize}
\item \textbf{elliptic} if $AC-B^2>0$ for all $(x,y)$,
\item \textbf{parabolic} if $AC-B^2=0$ for all $(x,y)$,
\item \textbf{hyperbolic} if $AC-B^2<0$ for all $(x,y)$.
\end{itemize}
\end{definition*}

Why the name? If we substitute $u\to1$, $u_x\to\lambda$, $u_y\to\mu$, $u_{xx}\to\lambda^2$, $u_{yy}\to\mu^2$, etc. Then the equation turns out
\[A\lambda^2+B\lambda\mu+C\mu^2+D\lambda+E\mu+F=0,\]
which is a quadratic equation for $(\lambda,\mu)\in\mathbb{R}^2$, whose solution set $(\lambda,\mu)$ is:
\begin{itemize}
\item an ellipse if $AC-B^2>0$,
\item a parabola if $AC-B^2=0$,
\item a hyperbola if $AC-B^2<0$.
\end{itemize}

It seems crazy, but it is useful! E.g., the solutions of an elliptic equation are smooth, while the solutions of a hyperbolic equation are rough (discontinuous...)

\[\left.\begin{array}{r}\text{Poisson eq.}\\\text{heat eq.}\\\text{wave eq.}\end{array}\right\}\text{are prototypes of}\left\{\begin{array}{l}\text{an elliptic PDE},\\\text{a parabolic PDE,}\\\text{a hyperbolic PDE.}\end{array}\right.\]

\subsection*{Questions about PDEs}
\begin{itemize}
\item Do there exist solutions?

\item Are solutions unique?

\begin{itemize}
\item Boundary conditions

\item Initial conditions
\end{itemize}

\item Behaviour?

\begin{itemize}
\item Smooth or singular?

\item Simple or complicated?

\item Sensitive to parameters?

\begin{itemize}
\item Wave equation: YES

\item Heat equation: NO
\end{itemize}
\end{itemize}

\item Explicit solution formulae?

\begin{itemize}
\item Want simplicity
\end{itemize}

\item Numerical methods?

\begin{itemize}
\item In math, want error control

\item Want efficiency
\end{itemize}

\item Is there a PDE which is a simpler or better model?
\end{itemize}

%28/04
\renewcommand{\theHsection}{introduction.\thesection}
\renewcommand{\thesection}{\arabic{section}}
\setcounter{section}{0}
\section{Transport equation}\label{transport_eq}
%Section 1
Unknown: $u:\mathbb{R}^d\times\mathbb{R}\rightarrow\mathbb{R}$, $u=u(x,t)$, $x\in\mathbb{R}^d$, $t\in\mathbb{R}$ time.

\begin{enumerate}[label=\alph*)]
\item\label{transport} $u_t+v\cdot\nabla u=0$ in $\mathbb{R}^d\times\mathbb{R}$,
\[u_t=\frac{\partial u}{\partial t},\hspace{5mm}\nabla u=\left(\begin{matrix}\frac{\partial u}{\partial x_1}\\\vdots\\\frac{\partial u}{\partial x_d}\end{matrix}\right)\in\mathbb{R}^d,\]
$v\in\mathbb{R}^d$ fixed vector.

\item $v=v(x)$, $v:\mathbb{R}^d\rightarrow\mathbb{R}^d$ given vector field. Linear, $1$\textsuperscript{st} order, dim $d+1$.

Initial condition:
\begin{equation}\tag{IC}\label{transport_IC}
u(x,0)=u_0(x)\ \ \forall x\in\mathbb{R}^d,
\end{equation}
$u_0:\mathbb{R}^d\rightarrow\mathbb{R}$ given.

Plan:
\begin{itemize}
\item solve transport equation + \eqref{transport_IC} (show $\exists$ unique solution; formula for solution) [in terms of ``data'': $v,u_0$],
\item simple examples,
\item visualize (movie).
\end{itemize}
\end{enumerate}

\begin{enumerate}[label=\alph*)]
\item $\frac{\partial u}{\partial t}+v\cdot\nabla u=0$, $v\in\mathbb{R}^d$.

\begin{claim*}
$u(x,t)\coloneqq u_0(x-vt)$ solves \ref{transport}, \eqref{transport_IC}.
\end{claim*}

\begin{proof}
Let $g(t)=x-vt$, so $u_0(x-vt)=u_0(g(t))$.
\begin{multline*}
\frac{\partial u}{\partial t}(x,t)=\frac{d}{dt}u_0(x-vt)=Du_0\big(g(t)\big)Dg(t)=Du_0(x-vt)(-v)=\sum_i\partial_iu_0(x-vt)(-v_i)\\
=\nabla u_0(x-vt)\cdot(-v)=-\nabla u(x,t)\cdot v,
\end{multline*}
where $a\cdot b=\sum a_ib_i$.
\end{proof}

\begin{claim*}
This is the only solution.
\end{claim*}

\begin{proof}
Let $u$ be any solution to
\[\left\{\begin{array}{l}\frac{\partial u}{\partial t}+v\cdot\nabla u=0,\\u(x,0)=u_0(x)\ \forall x.\end{array}\right.\]

\begin{idea}
Consider the solution in a ``moving frame'' $\tilde{u}(x,t)=u(x+vt,t)$.
\end{idea}

\begin{claim*}
$\tilde{u}$ is independent of time $t$.
\end{claim*}

\begin{proof}
\[\frac{\partial\tilde{u}}{\partial t}(x,t)=\frac{d}{dt}u(x+vt,t)=\nabla u(x+vt,t)+\frac{\partial u}{\partial t}(x+vt,t)\underset{\text{PDE}}{=}0.\]

Hence,
\[u(x+vt,t)=\tilde{u}(x,t)=\tilde{u}(x,0)=u_0(x)\ \ \forall x,t.\]

The change of variables $x'=x+vt$, $x=x'-vt$ leads to
\[u(x',t)=u_0(x'-vt)\ \ \forall x',t.\]
\end{proof}
\end{proof}

\item $v\in\mathbb{R}^d$, $v=v(x)$ vector field.

$x_0+vt$ is the solution at time $t$ to the ODE
\[\left\{\begin{array}{l}\dot{x}(t)=v\ \forall t,\\x(0)=x_0.\end{array}\right.\]

$\phi_t(x_0)$ is the solution at time $t$ to the ODE
\begin{equation}\tag{$*$}\label{vector_field}
\left\{\begin{array}{l}\dot{x}(t)=v(x(t))\ \forall t,\\x(0)=x_0.\end{array}\right.
\end{equation}

$\phi_t:\mathbb{R}^d\rightarrow\mathbb{R}^d$ is the time\,-\,$t$ map of flow map of the ODE.

ODE theory: if $v:\mathbb{R}^d\rightarrow\mathbb{R}^d$ is Lipschitz, then $\phi_t$ exists, it is unique and it is a $C^1$\,-\,diffeomorphism.

$x_0-vt$ leads to $\phi_t^{-1}(x_0)$.

\begin{recall}
$\phi_t^{-1}(x_1)$ is the solution at time $t$ to the ``backward ODE''
\[\left\{\begin{array}{l}\dot{x}(t)=-v(x(t))\ \forall t,\\x(0)=x_1.\end{array}\right.\]
\end{recall}

\begin{claim*}
$u(x,t)=u_0(\phi_t^{-1}(x))$ is the unique solution to
\begin{empheq}[left=\empheqlbrace]{align}
\frac{\partial u}{\partial t}+v\cdot\nabla u=0,\tag{b}\label{transport_case}\\
u(x,0)=u_0(x)\ \forall x.\tag{IC}\label{initial_condition}
\end{empheq}
\end{claim*}

\begin{proof}
$u(x,t)$ any function of $x$ and $t$.

Transform to moving frame: $\tilde{u}(x,t)\coloneqq u(\phi_t(x),t)$. ($\phi_t(x)=x+vt$ if $v$ is constant)

\[\partial_t\tilde{u}(x,t)=\nabla u\big(\phi_t(x),t\big)\cdot\underbrace{\frac{d}{dt}\phi_t(x)}_{=v(\Phi_t(x))}+\frac{\partial u}{\partial t}(\phi_t(x),t).\]

\[\partial_t\tilde{u}(x,t)=0\ \forall x,t\Longleftrightarrow u\text{ solves \eqref{transport_case} }\forall x,t.\]

\eqref{initial_condition} for $\tilde{u}$: since $\phi_t(x)|_{t=0}=x$, $\tilde{u}(x,0)=u(x,0)$, and so
\[\text{\eqref{initial_condition} for }\tilde{u}\Longleftrightarrow\text{\eqref{initial_condition} for }u.\]

But $\tilde{u}$ solves
\begin{align*}
\left\{\begin{array}{l}\partial_t\tilde{u}(x,t)=0\\\tilde{u}(x,0)=u_0(x)\ \forall x\end{array}\right\}\Longleftrightarrow\tilde{u}(x,t)=u_0(x)\ \forall x,t&\Longleftrightarrow u(\phi_t(x),t)=u_0(x)\ \forall x,t\\
&\Longleftrightarrow u(x',t)=u_0(\phi_t^{-1}(x'))\ \forall x',t;
\end{align*}
where $x'=\phi_t(x)$, $\phi_t^{-1}(x')=x$.
\end{proof}
\end{enumerate}

\begin{summary}
\begin{theorem}
%Theorem 1.1
Given any Lipschitz continuous vector field $v:\mathbb{R}^d\rightarrow\mathbb{R}^d$ and any $u_0\in C^1(\mathbb{R}^d)$, then \eqref{transport_case}, \eqref{initial_condition} has a unique solution $u\in C^1(\mathbb{R}^d\times\mathbb{R})$ and $u$ is given by the above formula.
\end{theorem}
\end{summary}

\begin{example*}
Explicit examples: $d=2$, dim of PDE $=3$.

\begin{enumerate}[label=\arabic*)]
\item $v(x,y)=\left(\begin{matrix}x\\y\end{matrix}\right)$, $(x,y)\in\mathbb{R}^2$, $u=u(x,y,t)$.

\item $v(x,y)=\left(\begin{matrix}y\\-x\end{matrix}\right)$.
\end{enumerate}

\begin{enumerate}[label=\arabic*)]
\item
\[
\begin{array}{ll}
\dot{x}=x,&x(0)=x_0;\\\dot{y}=y,&y(0)=y_0.
\end{array}
\]

\[\left(\begin{matrix}x\\y\end{matrix}\right)(t)=\left(\begin{matrix}x_0e^t\\y_0e^t\end{matrix}\right)=\phi_t(x_0,y_0),\]

\[\phi_t^{-1}(x,y)=\left(\begin{matrix}x_0e^{-t}\\y_0e^{-t}\end{matrix}\right),\]

\[u(x,y,t)=u_0(e^{-t}x,e^{-t}y)\xrightarrow[t\to\infty]{}u_0(0,0),\]

\[u_0(x,y)=e^{-(x^2+y^2)}\xrightarrow[t\to\infty]{}1.\]

\item
\[
\begin{array}{ll}
\dot{x}=y,&x(0)=x_0;\\
\dot{y}=-x,&y(0)=y_0.
\end{array}
\]

\[\left(\begin{matrix}x\\y\end{matrix}\right)(t)=\left(\begin{matrix}\cos t&\sin t\\-\sin t&\cos t\end{matrix}\right)\left(\begin{matrix}x_0\\y_0\end{matrix}\right)=\phi_t(x_0,y_0),\]

This is a rotation matrix $R(t)$ by angle $t$.

\[\phi_t^{-1}(x,y)=R(t)^{-1}\left(\begin{matrix}x\\y\end{matrix}\right)=\left(\begin{matrix}\cos t&-\sin t\\\sin t&\cos t\end{matrix}\right)\left(\begin{matrix}x\\y\end{matrix}\right),\]

\[u(x,y,t)=u_0(\cos t\,x-\sin t\,y,\sin t\,x+\cos t\,y)=u_0\left(R(t)^{-1}\left(\begin{matrix}x\\y\end{matrix}\right)\right),\]

\[u_0(x,y)=e^{-((x-a)^2+y^2)},\]

\[u(x,y,t)=e^{-[(x\cos t-y\sin t-a)^2+(x\sin t+y\cos t)^2]}.\]
\end{enumerate}
\end{example*}

\begin{summary}
The transport equation transports mass around in $\mathbb{R}^d$ along the solutions to the ODE generated by the vectorfield $v(x)$.
\end{summary}

%03/05
\renewcommand{\theHsection}{section.\thesection}
\section{Laplace's and Poisson's equation}\label{Laplace_Poisson}
%Section 2
Laplace's equation:
\begin{equation}\tag{L}\label{LaplaceL}
\Delta u=0,
\end{equation}
$u=u(x)$, $x\in\mathbb{R}^n$, $u:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}$.

Poisson's equation:
\begin{equation}\tag{P}\label{Poisson}
-\Delta u=f,
\end{equation}
$f:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}$ given.

\begin{recall}
From Lecture 1:
\begin{itemize}
\item $\displaystyle{\Delta u(x)=\sum_{i=1}^n\frac{\partial^2u}{\partial x_i^2}(x)}$ Laplacian of $u$,
\item solutions to \eqref{LaplaceL} are called harmonic functions,
\item \eqref{LaplaceL}, \eqref{Poisson} linear, $2$\textsuperscript{nd} order PDEs,
\item several reasons to be interested.
\end{itemize}
\end{recall}

A mathematical reason to be interested in \eqref{LaplaceL}:

If $f=u+iv:\mathbb{C}\rightarrow\mathbb{C}$ holomorphic (i.e., complex differentiable), then $u=\Real f$ and $v=\Img f$ are harmonic.

\begin{proof}
$f$ holomorphic implies $u,v$ satisfy Cauchy-Riemann equations:
\[\left.\begin{array}{r}u_x=v_y,\\v_x=-u_y,\end{array}\right\}\Rightarrow\left\{\begin{array}{l}u_{xx}=v_{yx},\\v_{xy}=-u_{yy};\end{array}\right.\]
\[\Delta u=u_{xx}+u_{yy}=v_{yx}-v_{xy}=0,\]
by Schwarz's theorem.
\end{proof}

Helps to demystify fact that once complex-differentiable functions are infinitely complex-differentiable (will see: harmonic functions are infinitely differentiable!)

\subsection{Radial solutions to \texorpdfstring{\eqref{LaplaceL}}{(L)}}
\begin{goal}
Compute them all.
\end{goal}

Motivation: helps to understand general solutions to both \eqref{LaplaceL} and \eqref{Poisson}.

So, want to find $u:\mathbb{R}^n\setminus\{0\}\rightarrow\mathbb{R}$ such that
\begin{alignat*}{2}
u(x)&=F\big(|x|\big)\ &&\text{ for some }F:(0,\infty)\rightarrow\mathbb{R}\\
\Delta u&=0&&\text{ in }\mathbb{R}^n\setminus\{0\}.
\end{alignat*}

\textbf{2 useful identities:}
\begin{itemize}
\item factorization of $\Delta$:
\[\Delta=\diver\nabla,\]
(see lecture 1);
\item product rule for $\diver$:
\[\diver(\varphi\vec{v})=\nabla\varphi\cdot\vec{v}+\varphi\diver\vec{v},\]
for $\varphi:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}$ scalar, $\vec{v}:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}^n$ vector field.
\end{itemize}

\begin{recall}
Proof: using the product rule and the definition of $\nabla$ and $\diver$,
\[\diver(\varphi\vec{v})=\sum_i\partial_i(\varphi v_i)=\sum_i\big(\partial_i\varphi v_i+\varphi\partial_iv_i\big)=\nabla\varphi\cdot\vec{v}+\varphi\diver\vec{v}.\]
\end{recall}

Compute $\Delta u$ for $u(x)=F(|x|)$, $F$ general:
\[\nabla u(x)=F'\big(|x|\big)\nabla|x|,\]
\[\nabla|x|=\nabla\sqrt{x_1^2+\cdots+x_n^2}=\frac{1}{2\sqrt{x_1^2+\cdots+x_n^2}}\nabla(x_1^2+\cdots+x_n^2)=\frac{1}{2\sqrt{x_1^2+\cdots+x_n^2}}\left(\begin{matrix}2x_1\\\vdots\\2x_n\end{matrix}\right)=\frac{x}{|x|},\]
\begin{multline*}
\Delta|x|=\diver\nabla|x|=\diver\left(\frac{1}{|x|}x\right)=\left(\nabla\frac{1}{|x|}\right)\cdot x+\frac{1}{|x|}\diver x\\
=-\frac{1}{|x|^2}\nabla|x|\cdot x+\frac{1}{|x|}\sum_i\partial_ix_i=-\frac{1}{|x|}+\frac{n}{|x|}=\frac{n-1}{|x|},
\end{multline*}
\begin{multline*}
\Delta u(x)=\diver\nabla u(x)=\diver\big(F'\big(|x|\big)\nabla|x|\big)=\nabla F'\big(|x|\big)\cdot\frac{x}{|x|}+F'\big(|x|\big)\Delta|x|\\
=F''\big(|x|\big)\nabla|x|\cdot\frac{x}{|x|}+F'\big(|x|\big)\frac{n-1}{|x|}=F''\big(|x|\big)+\frac{n-1}{|x|}F'\big(|x|\big).
\end{multline*}

Hence,
\[\Delta u=0\Longleftrightarrow\boldsymbol{F''(r)+\frac{n-1}{r}F'(r)=0}\ \ \forall r\in(0,\infty).\]

\begin{note}
The equation for $F$ depends on the space dimension $n$.
\end{note}

\begin{itemize}
\item $\boldsymbol{n=1}$:
\begin{align*}
F''(r)=0&\Longleftrightarrow F(r)=ar+b\text{ for some }a,b\in\mathbb{R}\\
&\Longleftrightarrow u(x)=F\big(|x|\big)=a|x|+b\text{ for some }a,b\in\mathbb{R}.
\end{align*}

\item $\boldsymbol{n\geq2}$: denote $F'\eqqcolon G$, then the equation becomes
\[G'+\frac{n-1}{r}G=0\Leftrightarrow\frac{dG}{dr}=-\frac{n-1}{r}G\Leftrightarrow\frac{dG}{G}=-\frac{n-1}{r}\,dr\Leftrightarrow\log G=-(n-1)\log r+C,\ \ C\in\mathbb{R}\]\[\Leftrightarrow G=e^{-(n-1)\log r}\cdot a=\left(e^{\log r}\right)^{-(n-1)}\cdot a=\frac{1}{r^{n-1}}\cdot a,\ \ a\in\mathbb{R}\]

To find $F$, need to distinguish $n-1=1$ and $n-1\geq2$.

\begin{itemize}
\item $\boldsymbol{n=2}$: $G(r)=\frac{a}{r}$, $F(r)=a\log r+b$, $a,b\in\mathbb{R}$. $u(x)=a\log|x|+b$.

\item $\boldsymbol{n\geq3}$: $F(r)=\frac{a}{(n-2)r^{n-2}}+b$, $a,b\in\mathbb{R}$.
\end{itemize}
\end{itemize}

\begin{summary}
\begin{theorem}
%Theorem 2.1
If $u(x)=F(|x|)$ for some $F\in C^2((0,\infty))$, $u:\mathbb{R}^n\setminus\{0\}\rightarrow\mathbb{R}$, then
\[u\text{ solves \eqref{LaplaceL}}\Longleftrightarrow u(x)=\left\{\begin{array}{lll}a|x|+b&\text{if}&n=1,\\a\log|x|+b&\text{if}&n=2,\vspace{1mm}\\\displaystyle{\frac{a}{(n-2)|x|^{n-2}}+b}&\text{if}&n\geq3,\end{array}\right.\text{ for some }a,b\in\mathbb{R}.\]
\end{theorem}
\end{summary}

\subsection[Poisson's equation in \texorpdfstring{$\mathbb{R}^n$}{R\textasciicircum n}]{Poisson's equation in \texorpdfstring{$\boldsymbol{\mathbb{R}^n}$}{R\textasciicircum n}}
The fundamental theorem of calculus gives a solution for the ODE $y'=f$, $y:\mathbb{R}\rightarrow\mathbb{R}$, whose integral formula is
\[y(x)=\int_{x_0}^xf(s)\,ds+C=\int_{\mathbb{R}}\boldsymbol{1}_{[x_0,x]}(s)f(s)\,ds.\]

The equivalent more-dimensional of the theorem is the solution to the PDE $-\Delta u=f$ (and $u(x)\rightarrow0$ as $|x|\to\infty$), which in its integral form is
\[u(x)=\int_{\mathbb{R}^n}\Phi(x-y)f(y)\,dy,\]
where $\Phi$ is one of the radial solutions to $\Delta\Phi=0$.

\begin{definition*}
The function
\[\Phi(z)\coloneqq\left\{\begin{array}{lll}\displaystyle{-\frac{1}{\omega_2}\log|z|}&\text{if}&n=2,\\\displaystyle{\frac{1}{(n-2)\omega_n|x|^{n-2}}}&\text{if}&n\geq3,\end{array}\right.\]
where $\omega_n$ is the area of the unit sphere in $\mathbb{R}^n$: $\{x\in\mathbb{R}^n:|x|=1\}$, is called the \textbf{fundamental solution} of the Laplace's equation.

Reason for normalization: proof of Theorem \ref{Poisson_sol}.
\end{definition*}

\begin{itemize}
\item $n=2$: $\omega_2=2\pi$ is the length of the unit circumference,
\[\Phi(x)=-\frac{1}{2\pi}\log|x|;\]
\item $n=3$: $\omega_3=4\pi$ is the area of the unit circumference,
\[\Phi(x)=\frac{1}{4\pi}\frac{1}{|x|}.\]
\end{itemize}

Preliminary investigation of
\begin{equation}\tag{1}\label{definition_u}
u(x)\coloneqq\int_{\mathbb{R}^n}\Phi(x-y)f(y)\,dy,
\end{equation}
where $\Phi$ is the fundamental solution of \eqref{LaplaceL}.

Na\"{i}ve computation of $\Delta u$:
\begin{enumerate}[label=(\roman*)]
\item start from $x\mapsto\Phi(x)$, this is harmonic in $\mathbb{R}^n\setminus\{0\}$;
\item shift by a vector $y\in\mathbb{R}^n$, $x\mapsto\Phi(x-y)$, this is harmonic in $\mathbb{R}^n\setminus\{y\}$;
\item multiply by a number $f(y)\in\mathbb{R}$, $x\mapsto\Phi(x-y)f(y)$ this is harmonic in $\mathbb{R}^n\setminus\{y\}$;
\item take superposition (add up different $x\mapsto\Phi(x-y)f(y)$), $x\mapsto\int_{\mathbb{R}^n}\Phi(x-y)f(y)\,dy$, is this still harmonic?
\end{enumerate}

Na\"{i}ve calculation:
\[\Delta u(x)=\Delta_x\int_{\mathbb{R}^n}\Phi(x-y)f(y)\,dy=\int_{\mathbb{R}^n}\underbrace{\Delta_x\Phi(x-y)}_{\mathclap{=0\ \forall y\in\mathbb{R}^n\setminus\{x\}}}f(y)\,dy=0.\]
Introducing the Laplacian underneath the integral sign is not only unjustified; it is wrong.



\begin{theorem}\label{Poisson_sol}
%Theorem 2.2
\emph{\textbf{(Solution to Poisson's equation in $\boldsymbol{\mathbb{R}^n}$)}} Define $u$ by \eqref{definition_u} and assume $f\in C^2(\mathbb{R}^n)$, $f$ has compact support. Then:
\begin{enumerate}[label=(\roman*)]
\item $u\in C^2(\mathbb{R}^n)$,
\item $-\Delta u=f$ in $\mathbb{R}^n$, i.e., $u$ solves \eqref{Poisson}.
\end{enumerate}
\end{theorem}

Heuristic explanation why introducing the Laplacian might be unjustified.
\[\Phi(x)=\frac{1}{(n-2)\omega_n|x|^{n-2}},\ n\geq3\]
\[\frac{\partial^2\Phi(x)}{\partial x_i^2}=\frac{n}{\omega_n|x|^n}\cdot\frac{x_i^2}{|x|^2}\]
$\frac{x_i^2}{|x|^2}\leq1$, reaching the equality on the $i$-th axis and $\frac{n}{\omega_n|x|^n}\notin L^1(B_1(0))$.

Differentiating under the integral gives an integrand which is not integrable!

In $n$ dimensions, $\frac{1}{|x|^{\alpha}}\in L^1(B_1(0))\Leftrightarrow\alpha<n\Leftrightarrow\text{order of singularity}<\text{space dimension}$.

%05/05
\begin{revision}
(Analysis III) Integration by parts and Gauss's theorem.

\begin{theorem*}
\emph{\textbf{(Gauss)}} Let $\Omega\subseteq\mathbb{R}^n$ open bounded with $C^1$ boundary, $V\in C^1(\overline{\Omega};\mathbb{R}^n)$ a vector field. Then
\[\int_{\Omega}\diver v=\int_{\partial\Omega}v(x)\cdot\nu(x)\,dS(x),\]
where $\nu(x)$ is the outward unit normal to $\partial\Omega$ at $x$.
\end{theorem*}

Gauss's theorem is the analogue of the fundamental theorem of calculus.

\begin{theorem*}
\emph{\textbf{(Integration by parts formula)}} $\Omega,v$ as above, $u\in C^1(\overline{\Omega};\mathbb{R})$ a scalar function. Then
\[\int_{\Omega}u\diver v=\int_{\partial\Omega}uv\cdot\nu\,dS-\int_{\Omega}\nabla u\cdot v.\]
\end{theorem*}

\begin{proof}
From the product rule for the divergence, $\diver(uv)=u\diver v+\nabla u\cdot v$. From Gauss's theorem,
\begin{align*}
\int_{\Omega}\diver(uv)&=\int_{\partial\Omega}uv\cdot\nu\,dS\\
&=\int_{\Omega}u\diver v+\int_{\Omega}\nabla u\cdot v
\end{align*}
\end{proof}
\end{revision}

\begin{proof}
(Theorem \ref{Poisson_sol})

\begin{enumerate}[label=\arabic*.]
\item\label{Poisson_sol_diff} Differentiability. Substituting $z=x-y$ and renaming, we get
\[u(x)=\int_{\mathbb{R}^n}\Phi(x-y)f(y)\,dy=\int_{\mathbb{R}^n}\Phi(z)f(x-z)\,dz=\int_{\mathbb{R}^n}\Phi(y)f(x-y)\,dy.\]
Difference quotient: $h\in\mathbb{R}\setminus\{0\}$, $e_i=(0,\ldots,0,1,0,\ldots,0)$ with the $1$ in the $i$-th component.
\[\frac{u(x+he_i)-u(x)}{h}=\int_{\mathbb{R}^n}\Phi(y)\frac{f(x+he_i-y)-f(x-y)}{h}\,dy\longrightarrow\int_{\mathbb{R}^n}\Phi(y)\frac{\partial f}{\partial x_i}(x-y)\,dy,\]
by dominated convergence, because $\Phi(h)\in L^1$ on bounded regions and
\[\frac{f(x+he_i-y)-f(x-y)}{h}\xrightarrow{\text{uniformly}}\frac{\partial f}{\partial x_i}(x-y).\]

Hence, $u$ is differentiable and
\[\frac{\partial u}{\partial x_i}(x)=\int_{\mathbb{R}^n}\Phi(y)\frac{\partial f}{\partial x_i}(x-y)\,dy.\]

Analogously, $u$ is twice differentiable and
\[\frac{\partial^2u}{\partial x_i\partial x_j}(x)=\int_{\mathbb{R}^n}\Phi(y)\frac{\partial^2f}{\partial x_i\partial x_j}(x-y)\,dy.\]

Since expressions for the derivatives are continuous in $x$ (again by dominated convergence), $u\in C^2(\mathbb{R}^n)$.

\item Infer integral representation of $\Delta u$ and ``cut out'' singularity
\begin{enumerate}[label=(\arabic*)]
\item\label{compact_supp} Since $f$ has compact support, for $R$ sufficiently large, $f,\nabla f,D^2f\equiv0$ for $|y|\geq R$. Let $\epsilon\in(0,1)$.
\[\Delta u(x)\underset{\text{\ref{Poisson_sol_diff}}}{=}\int_{\mathbb{R}^n}\Phi(y)\Delta f(x-y)\,dy=\int_{B_R(0)}\Phi(y)\Delta f(x-y)\,dy=I_{\epsilon}+J_{\epsilon},\]
where
\[I_{\epsilon}\coloneqq\int_{B_{\epsilon}(0)}\Phi(y)\Delta f(x-y)\,dy,\ \ J_{\epsilon}\coloneqq\int_{B_R(0)\setminus B_{\epsilon}(0)}\Phi(y)\Delta f(x-y)\,dy.\]

\item\label{Iepsto0}
\begin{claim*}
$I_{\epsilon}\xrightarrow[\epsilon\to0]{}0$.
\end{claim*}

\begin{proof}
\[|I_{\epsilon}|\leq n\sup_z|D^2f(z)|\cdot\int_{B_{\epsilon}}|\Phi(y)|\,dy,\]
for $n\geq3$, taking polar coordinates ($r=|y|$),
\begin{multline*}
\int_{B_{\epsilon}}|\Phi(y)|\,dy=\frac{1}{(n-2)\omega_n}\int_{B_{\epsilon}(0)}\frac{1}{|y|^{n-2}}\,dy=\frac{1}{(n-2)\omega_n}\omega_n\int_0^{\epsilon}r^{n-1}\frac{1}{r^{n-2}}\,dr\\
=\frac{1}{n-2}\int_0^{\epsilon}r\,dr=\frac{1}{n-2}\frac{\epsilon^2}{2}\xrightarrow[\epsilon\to0]{}0.
\end{multline*}
\end{proof}
\end{enumerate}

\item Integration by parts to rewrite $J_{\epsilon}$.

\begin{enumerate}[label=(\arabic*),resume]
\item\label{integrals} Note that $\Delta_xf(x-y)=\Delta_yf(x-y)=\diver_y\nabla_yf(x-y)$.
\begin{multline*}
J_{\epsilon}=\int_{B_R(0)\setminus B_{\epsilon}(0)}\Phi(y)\Delta_xf(x-y)\,dy=\int_{B_R(0)\setminus B_{\epsilon}(0)}\Phi(y)\diver_y\nabla_yf(x-y)\,dy\\
=\int_{\partial B_R(0)}\Phi(y)\underbrace{\nabla_yf(x-y)}_{\mathclap{=0\text{ on }\partial B_R(0)}}\cdot\nu(y)\,dS(y)+\underbrace{\int_{\partial B_{\epsilon}(0)}\Phi(y)\nabla_yf(x-y)\cdot\nu(y)\,dS(y)}_{\eqqcolon K_{\epsilon}}\\
\underbrace{-\int_{B_R(0)\setminus B_{\epsilon}(0)}\nabla_y\Phi(y)\cdot\nabla_yf(x-y)\,dy}_{\eqqcolon L_{\epsilon}}.
\end{multline*}
(The normal vector $\nu(y)$ points toward the origin on $\partial B_{\epsilon}(0)$, since it always points outside $B_R(0)\setminus B_{\epsilon}(0)$.)

\item\label{Kepsto0}
\begin{claim*}
$K_{\epsilon}\xrightarrow[\epsilon\to0]{}0$.
\end{claim*}

\begin{proof}
\begin{multline*}
|K_{\epsilon}|\leq\sup_z|\nabla f(z)|\cdot\int_{\partial B_{\epsilon}(0)}|\Phi(y)|\,dy=\sup_z|\nabla f(z)|\cdot\frac{1}{(n-2)\omega_n}\frac{1}{\epsilon^{n-2}}\omega_n\epsilon^{n-1}\\
=\sup_z|\nabla f(z)|\cdot\frac{\epsilon}{n-2}\xrightarrow[\epsilon\to0]{}0.
\end{multline*}
\end{proof}
\end{enumerate}

\item Rewrite $L_{\epsilon}$ using another integration by parts:
\begin{multline}\tag{5}\label{minus_mean_value}
L_{\epsilon}=-\int_{B_R(0)\setminus B_{\epsilon}(0)}\nabla_y\Phi(y)\cdot\nabla_yf(x-y)\,dy=-\int_{\partial B_{\epsilon}(0)}\big(\nabla_y\Phi(y)\big)\cdot\nu(y)f(x-y)\,dS(y)\\
-\underbrace{\int_{\partial B_R(0)}\big(\nabla_y\Phi(y)\big)\cdot\nu(y)f(x-y)\,dS(y)}_{=0}+\int_{B_R(0)\setminus B_{\epsilon}(0)}\underbrace{\diver_y\nabla_y\Phi(y)}_{=\Delta_y\Phi(y)=0}f(x-y)\,dy\\
=-\int_{\partial B_{\epsilon}(0)}-\frac{1}{\omega_n|y|^{n-1}}\frac{y}{|y|}\cdot\left(-\frac{y}{|y|}\right)f(x-y)\,dS(y)=-\frac{1}{\omega_n}\int_{\partial B_{\epsilon}(0)}\frac{1}{|y|^{n-1}}f(x-y)\,dS(y)\\
=-\frac{1}{\omega_n\epsilon^{n-1}}\int_{\partial B_{\epsilon}(0)}f(x-y)\,dS(y)\eqqcolon-\fint_{\partial B_{\epsilon}(0)}f(x-y)\,dS(y)\xrightarrow[\epsilon\to0]{}-f(x),
\end{multline}
since $f$ is continuous. $\fint$ denotes the meanvalue of $f$ on $\partial B_{\epsilon}(0)$, which has $\area(\partial B_{\epsilon}(0))=\omega_n\epsilon^{n-1}$.
\end{enumerate}

\ref{compact_supp}, \ref{Iepsto0}, \ref{integrals}, \ref{Kepsto0}, \eqref{minus_mean_value} imply that $\Delta u(x)=-f(x)$.
\end{proof}

%10/05
\begin{goal}
\begin{itemize}
\item Properties of harmonic functions;
\item properties of Laplace's and Poisson's equations in bounded domains;
\item uniqueness of solutions from last week:
\[\left\{\begin{array}{lll}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega,\end{array}\right.\]
``boundary value problem''.
\end{itemize}
\end{goal}

The main tool is the following theorem.

\begin{theorem}
%Theorem 2.3
\emph{\textbf{(Mean value formulae)}} $\Omega\subseteq\mathbb{R}^n$ open, $u\in C^2(\Omega)$ harmonic, $\overline{B_r(x)}=\{y\in\mathbb{R}^n:|y-x|\leq r\}\subseteq\Omega$. Then
\[u(x)=\fint_{\partial B_r(x)}u(y)\,dS(y)=\fint_{B_r(x)}u(y)\,dy.\]
\end{theorem}

Notation: $\fint$ is the mean value, i.e.,
\[\fint_{\mathcal{S}}u(y)\,dS(y)=\frac{\int_{\mathcal{S}}u(y)\,dy}{\area(\mathcal{S})},\hspace{5mm}\fint_{\Omega}u(y)\,dy=\frac{\int_{\Omega}u(y)\,dy}{\vol(\Omega)}.\]

\begin{example*}
$n=2$: consider $u(x,y)=x^2-y^2$; then, $u_{xx}=2$, $u_{yy}=-2$, $\Delta u=u_{xx}+u_{yy}=0$, $u(0,0)=0$.
\[\fint_{B_r(0)}u=\fint_{B_r(0)}x^2-\fint_{B_r(0)}y^2=0.\]
\end{example*}

\begin{proof}
Use that if a formula is true for one value of a parameter and its derivative with respect to the parameter is $0$, then it is true for ``all'' values of the parameter.

\[\phi(r)\coloneqq\fint_{\partial B_r(x)}u(y)\,dS(y)\hspace{10mm}(r>0)\]
\begin{equation}\tag{$*$}\label{phicontrahitur}
\phi(r)\xrightarrow[r\to0]{}u(x),
\end{equation}
since $u$ is continuous. It suffices to show $\phi'(r)=0$. This will imply that $\phi(r)$ is constant and by \eqref{phicontrahitur}, $\phi(r)=u(x)$.

To compute $\phi'(r)$, transform to fixed domain doing the change of variable $z=\frac{x-y}{r}$, $dS(y)=r^{n-1}dS(z)$.

\[\phi(r)=\frac{1}{\omega_nr^{n-1}}\int_{\partial B_r(x)}u(y)\,dS(y)=\frac{1}{\omega_n}\int_{\partial B_1(0)}u(x+rz)\,dS(z)\]

\[\phi'(r)=\frac{1}{\omega_n}\int_{B_1(0)}\nabla u(x+rz)\cdot\underbrace{\frac{d}{dr}(x+rz)}_{=z}dS(z)=\frac{1}{\omega_n}\int_{\partial B_r(x)}\nabla u(y)\cdot\frac{y-x}{r}\frac{1}{r^{n-1}}\,dS(y),\]

$\nu(y)=\frac{y-x}{r}$ is the outward unit normal to $\partial B_r(x)$ at $y$. By Gauss's theorem,
\[\phi'(r)=\frac{1}{\omega_nr^{n-1}}\int_{B_r(x)}\diver\big(\nabla u(y)\big)\,dy=\frac{1}{\omega_nr^{n-1}}\int_{B_r(x)}\Delta u(y)\,dy=0.\]

Second equality in the theorem. Curvilinear Fubini:
\[\int_{B_r}=\int_{s=0}^r\int_{\partial B_s}.\]

\begin{multline*}
\int_{B_r(x)}u(y)\,dy=\int_{s=0}^r\int_{\partial B_s(x)}u(y)\,dS(y)=\int_0^r\area\big(\partial B_s(x)\big)\cdot u(x)\,ds\\
=\int_0^r\omega_ns^{n-1}\,ds\cdot u(x)=\frac{\omega_n}{n}s^n\Big|_0^r\cdot u(x)=\frac{\omega_n}{n}r^n\cdot u(x)=\vol B_r(x)\cdot u(x).
\end{multline*}
\end{proof}

\begin{example*}
($n=3$)
\[\omega_3=\area(\text{unit sphere})=4\pi,\]
\[\vol\big(B_r(0)\big)=\frac{4\pi}{3}r^3.\]
\end{example*}

\begin{theorem}
%Thm 2.4
\emph{\textbf{(Maximum principle)}} $\Omega\subseteq\mathbb{R}^n$ open bounded, $u\in C^2(\Omega)\cap C(\overline{\Omega})$, $u$ harmonic in $\Omega$. Then
\begin{enumerate}[label=(\roman*)]
\item\label{weak_max} \emph{\textbf{maximum principle}}:
\[\max_{\overline{\Omega}}u=\max_{\partial\Omega}u;\]
\item\label{strong_max} \emph{\textbf{strong maximum principle}}: if in addition, there exists $x_0\in\Omega$ such that
\[u(x_0)=\max_{\overline{\Omega}}u\]
and $\Omega$ is connected, then
\[u\text{ is constant in }\Omega.\]
\end{enumerate}
\end{theorem}

Analogous statements hold for ``min'' instead of ``max''.

\begin{proof}
Let $x_0$ be as in \ref{strong_max}, $u(x_0)\eqqcolon M$. Consider the set $A=\{x\in\Omega:u(x)=M\}$. By assumption, $A\neq\emptyset$, since $x_0\in A$.

Use the fact from topology that if $\Omega$ is connected, $A\subseteq\Omega$ is open and $A\subseteq\Omega$ relatively closed (i.e., $A=\Omega\cap C$ for some closed $C$), then $A=\Omega$.

\begin{claim}
%Claim 1
$A$ is open.
\end{claim}

\begin{proof}
Use the mean value formula. Pick $r>0$ such that $\overline{B_r(x_0)}\subseteq\Omega$.
\[M=u(x_0)=\fint_{B_r(x_0)}u(y)\,dy.\]

This implies, as $u\leq M$, that $u\equiv M$ on $B_r(x_0)$, so $B_r(x_0)\subseteq A$, so $A$ is open.
\end{proof}

\begin{claim}
%Claim 2
$A$ is relatively closed in $\Omega$.
\end{claim}

\begin{proof}
$C=\{x\in\overline{\Omega}\,|\,u(x)=M\}$ is closed, since $u$ is continuous. $A=\Omega\cap C$.
\end{proof}

\ref{weak_max} follows from \ref{strong_max}.
\end{proof}

\begin{theorem}
%Thm 2.5
\emph{\textbf{(Uniqueness in bounded domains)}} Let $\Omega\subseteq\mathbb{R}^n$ open and bounded, $g\in C(\partial\Omega)$, $f\in C(\Omega)$. Then there exists at most one solution $u\in C^2(\Omega)\cap C(\overline{\Omega})$ to the boundary value problem
\[\left\{\begin{array}{lll}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]
\end{theorem}

\begin{proof}
Suppose $u_1,u_2$ solutions. Consider the difference $v\coloneqq u_1-u_2$. It satisfies
\[
\begin{array}{cl}
-\Delta v=-\Delta u_1+\Delta u_2=f-f=0&\text{ in }\Omega,\\
v=0&\text{ on }\partial\Omega.
\end{array}
\]

By the maximum principle, $\max_{\overline{\Omega}}v=\max_{\partial\Omega}v=0$.

By the ``minimum principle'', $\min_{\overline{\Omega}}v=\min_{\partial\Omega}v=0$.

Hence, $v=0$.
\end{proof}

How unique is the solution to $-\Delta u=f$ in $\mathbb{R}^n$ found last week
\begin{equation}\tag{1}\label{Poisson_sol_uniq}
u(x)=\int_{\mathbb{R}^n}\Phi(x-y)f(y)\,dy?
\end{equation}

Recall that $\Phi$ is the fundamental solution to $-\Delta\Phi=0$.

\begin{claim*}
If $f:\mathbb{R}^n\rightarrow\mathbb{R}$ is continuous and has compact support and $n\geq3$, the function $u$ defined by \eqref{Poisson_sol_uniq} satisfies
\[u(x)\xrightarrow[|x|\to\infty]{}0,\]
called \textbf{asymptotic boundary condition}.
\end{claim*}

\begin{proof}
If $x\notin\supp f$,
\begin{multline*}
|u(x)|=\left|\int_{\supp f}\frac{1}{\omega_n|x-y|^{n-2}}f(y)\,dy\right|\leq\int_{\supp f}\frac{1}{\omega_n\dist(x,\supp f)^{n-2}}\big|f(y)\big|\,dy\\
=\int_{\supp f}|f|\cdot\frac{1}{\omega_n\dist(x,\supp f)^{n-2}}\xrightarrow[|x|\to\infty]{}0,
\end{multline*}
since $\int_{\supp f}|f|<\infty$.
\end{proof}

\begin{theorem}\label{Poisson_unique}
%Thm 2.6
\emph{\textbf{(Uniqueness of the explicit solution from Theorem \ref{Poisson_sol})}} For $n\geq3$ and under the assumptions of Theorem \ref{Poisson_sol}, the function \eqref{Poisson_sol_uniq} is the \textbf{unique} solution to
\[\left\{\begin{array}{ll}-\Delta u=f&\text{in }\mathbb{R}^n,\\u(x)\rightarrow0&(|x|\to\infty).\end{array}\right.\]
\end{theorem}

\begin{proof}
$u_1,u_2$ solutions, $v\coloneqq u_1-u_2$. Then $-\Delta v=0$ in $\mathbb{R}^n$ and $v(x)\xrightarrow[|x|\to0]{}0$.

By the maximum principle,
\[\max_{\overline{B_R(0)}}v=\max_{\partial B_R(0)}v\xrightarrow[R\to\infty]{}0,\]
by the asymptotic boundary condition.

Same for the minimum. Thus, $v=0$.
\end{proof}

%12/05
\begin{recall}
Boundary value problem for Poisson's equation:
\[\left\{\begin{array}{ccc}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]
\end{recall}

\begin{goal}
\begin{itemize}
\item Solution formula (for given $f$ and $g$), $\Omega$ a halfspace of ball,
\item regularity of solutions $u$ when $f=0$ (general $\Omega$).
\end{itemize}
\end{goal}

\subsubsection{Halfspace, zero boundary condition.}
$\mathbb{R}_+^n=\{y\in\mathbb{R}^n\,|\,y_n>0\}$.
\begin{empheq}[left=\empheqlbrace]{alignat=2}
-\Delta u=f\ &\text{ in }&&\ \mathbb{R}_+^n,\tag{P}\label{Poisson_halfspace}\\
u=0\ &\text{ on }&&\ \partial\mathbb{R}_+^n=\{y_n=0\}.\tag{BC$_0$}\label{BC_halfspace}
\end{empheq}
$f\in C^2(\mathbb{R}_+^n)$, compact support given.

Starting point: whole-space solution:
\[u(x)=\int_{\mathbb{R}_+^n}\Phi(x-y)f(y)\,dy\]
to \eqref{Poisson_halfspace} (see Theorem \ref{Poisson_sol}). But this $u$ doesn't solve \eqref{BC_halfspace}. $u(x)$ is the potential at $x$ of the whole charge density $f$.

\begin{enumerate}[label=\arabic*.]
\item\label{method_images} Ingenious idea from electrostatics: \textbf{method of images}. For $y=(y_1,\ldots,y_n)$, write $Ry=(y_1,\ldots,y_{n-1},-y_n)$. $Ry$ is called the ``mirror charge''.

$\Phi(x-y)$ is the potential at $x$ of positive unit charge at $y$.

$-\Phi(x-Ry)$ is the potential at $x$ of negative unit charge at $Ry$.

\begin{claim*}
The potential from the mirror charge cancels the potential from the original charge at $y$ for $x\in\partial\mathbb{R}_+^n$, i.e.,
\[\Phi(x-y)-\Phi(x-Ry)=0\ \ \forall x\in\partial\mathbb{R}_+^n.\]
\end{claim*}

\begin{proof}
\begin{multline*}
|x-y|=\sqrt{(x_1-y_1)^2+\cdots+(x_{n-1}-y_{n-1})^2+(-y_n)^2}\\
=\sqrt{(x_1-y_1)^2+\cdots+(x_{n-1}-y_{n-1})^2+y_n^2}=|x-Ry|.
\end{multline*}
Since $\Phi(x-y)$ is a function of $|x-y|$, the claim follows.
\end{proof}

\item Superposition: we change the simple unit charge at $y$ by a charge distribution $f(y)$. Define
\[\tilde{f}(y)\coloneqq\left\{\begin{array}{cc}f(y)&y_n>0,\\-f(Ry)&y_n<0.\end{array}\right.\]
$-f(Ry)$ is the ``mirror charge distribution''.

Let $u$ be the electrostatic potential generated by the original charge distribution and the mirror charge distribution:
\[u(x)\coloneqq\int_{\mathbb{R}^n}\Phi(x-y)\tilde{f}(y)\,dy.\]

\setcounter{claim}{0}
\begin{claim}
%Claim 1
$-\Delta u=f$ in $\mathbb{R}_+^n$.
\end{claim}

\begin{proof}
By Theorem \ref{Poisson_sol}, $-\Delta u=\tilde{f}$ in $\mathbb{R}^n$. By construction of $\tilde{f}$, $\tilde{f}=f$ in $\mathbb{R}_+^n$.
\end{proof}

\begin{claim*}
$u=0$ on $\partial\mathbb{R}_+^n$.
\end{claim*}

\begin{proof}
\[u(x)=\int_{\mathbb{R}_+^n}\Phi(x-y)f(y)\,dy+\int_{\mathbb{R}_-^n}\Phi(x-y)\big(-f(Ry)\big)\,dy.\]
Doing the change of variable $\tilde{y}=Ry$, $y=R\tilde{y}$ and then renaming $\tilde{y}$ as $y$, the second integral becomes
\[\int_{\mathbb{R}_-^n}\Phi(x-y)(-f(Ry))\,dy=\int_{\mathbb{R}_+^n}-\Phi(x-R\tilde{y})f(\tilde{y})\,d\tilde{y}=\int_{\mathbb{R}_+^n}\big[\Phi(x-y)-\Phi(x-Ry)\big]f(y)\,dy\]
By Step \ref{method_images},
\[G(x,y)\coloneqq\Phi(x-y)-\Phi(x-Ry)\equiv0\ \ \forall y\text{ if }x\in\partial\mathbb{R}_+^n\]
In particular, $u(x)=0$ for $x\in\partial\mathbb{R}_+^n$.

$G$ is called the Green's function of
\[\left\{\begin{array}{ccc}-\Delta u=f&\text{in}&\mathbb{R}_+^n,\\u=0&\text{on}&\partial\mathbb{R}_+^n.\end{array}\right.\]
\end{proof}
\end{enumerate}

\subsubsection{Halfspace, nonzero boundary conditions, zero RHS}
\[\left\{\begin{array}{ccc}-\Delta u=0&\text{in}&\mathbb{R}_+^n,\\u=g&\text{on}&\partial\mathbb{R}_+^n,\end{array}\right.\]
for given $g$ bounded and continuous.

Nonrigurous derivation of solution formula. Suppose $u$ is a solution. Use that $G(x,y)$ solves
\begin{empheq}[left=\empheqlbrace]{align}
-\Delta_yG(x,y)=\delta_x(y)\ \ (y\in\mathbb{R}_+^n),\tag{$*$}\label{non_rigorous}\\
G(x,y)|_{\partial\mathbb{R}_+^n}=0\ \ (y\in\partial\mathbb{R}_+^n).\nonumber
\end{empheq}

$\text{\eqref{non_rigorous}}\cdot u(y)$, $\int_{\mathbb{R}_+^n}dy$.
\[\int_{\mathbb{R}_+^n}\big(-\Delta_yG(x,y)\big)u(y)\,dy=\int_{\mathbb{R}_+^n}\delta_x(y)u(y)\,dy=u(x).\]
Integrating by parts,
\[\int_{\mathbb{R}_+^n}\big(-\Delta_yG(x,y)\big)u(y)\,dy=\int_{\mathbb{R}_+^n}\underbrace{\big(-\nabla_yG(x,y)\cdot\nu\big)}_{\eqqcolon K(x,y)}\underbrace{u(y)}_{\mathclap{=g(y)}}dS(y)+\int_{\mathbb{R}_+^n}\nabla_yG(x,y)\cdot\nabla u(y)\,dy\]
\[\int_{\mathbb{R}_+^n}\nabla_yG(x,y)\cdot\nabla u(y)\,dy=-\int_{\partial\mathbb{R}_+^n}\underbrace{G(x,y)}_{=0}\nabla u(y)\cdot\nu\,dS(y)-\int_{\mathbb{R}_+^n}G(x,y)\underbrace{\diver\nabla u(y)}_{=\Delta u(y)=0}dy=0\]

Rigurous version: cut out $B_{\epsilon}(x)$ and integrate over $\mathbb{R}_+^n\setminus B_{\epsilon}(x)$, get extra boundary term, show that it converges to $u(x)$ as $\epsilon\to0$ [exactly as in proof of Theorem \ref{Poisson_sol}].

Compute $K(x,y)$ explicitly:
\[K(x,y)=-\nabla_yG(x,y)\cdot\nu(y),\ \ y\in\partial\mathbb{R}_+^n=\{y_n=0\}.\]

Since $|x-Ry|=|y-Rx|$; for $n\geq3$,
\[G(x,y)=\frac{1}{(n-2)\omega_n|x-y|^{n-2}}-\frac{1}{(n-2)\omega_n|y-Rx|^{n-2}}.\]
For $y\in\partial\mathbb{R}_+^n$,
\begin{multline*}
\nabla_yG(x,y)=-\frac{1}{\omega_n|x-y|^{n-1}}\frac{y-x}{|y-x|}+\frac{1}{\omega_n|y-x|^{n-1}}\frac{y-Rx}{|y-Rx|}\\
=-\frac{1}{\omega_n|y-x|^{n-1}}(Rx-x)=-\frac{1}{\omega_n|y-x|^{n-1}}2x_n\vec{e}_n,
\end{multline*}
\[-\nabla_yG(x,y)\cdot\nu(y)=\frac{2x_n}{\omega_n|x-y|^n}=K(x,y),\]
$K(x,y)$ is called the Poisson kernel. Here $x\in\mathbb{R}_+^n$, $y\in\partial\mathbb{R}_+^n$.

\subsubsection{Nonzero boundary conditions, nonzero RHS}
\begin{empheq}[left=\empheqlbrace]{alignat=2}
-\Delta u=f\ &\text{ in }&&\ \mathbb{R}_+^n,\tag{P}\label{Poisson_nonzero}\\
u=g\ &\text{ on }&&\ \partial\mathbb{R}_+^n.\tag{BC}\label{BC_nonzero}
\end{empheq}
$u_1$ is the solution to
\[\left\{\begin{array}{ccc}-\Delta u=f&\text{in}&\mathbb{R}_+^n,\\u=0&\text{on}&\partial\mathbb{R}_+^n.\end{array}\right.\]
$u_2$ is the solution to
\[\left\{\begin{array}{ccc}-\Delta u=0&\text{in}&\mathbb{R}_+^n,\\u=g&\text{on}&\partial\mathbb{R}_+^n.\end{array}\right.\]

Then, $u_1+u_2$ solves \eqref{Poisson_nonzero}, \eqref{BC_nonzero}.

\begin{summary}
\begin{theorem}\label{Poisson_Green}
%Thm 2.7
$f\in C^2(\mathbb{R}_+^n)$, compact support, $g\in C(\partial\mathbb{R}_+^n)$, $g$ bounded, $G,K$ as above. Then
\[u(x)\coloneqq\int_{\mathbb{R}_+^n}G(x,y)f(y)\,dy+\int_{\partial\mathbb{R}_+^n}K(x,y)g(y)\,dy\ \ (x\in\mathbb{R}_+^n)\]
solves \eqref{Poisson_nonzero} and solves \eqref{BC_nonzero} in the sense that
\[\lim_{\substack{x^{(\nu)}\to x\\x^{(\nu)}\in\mathbb{R}_+^n}}u(x^{(\nu)})=g(x)\ \ \forall x\in\partial\mathbb{R}_+^n.\]
\end{theorem}
\end{summary}

\subsubsection{Ball, zero boundary conditions}
\[\left\{\begin{array}{ccl}-\Delta u=f&\text{in}&B_1(0)=\{|x|<1\},\\u=0&\text{on}&\partial B_1(0).\end{array}\right.\]

$f\in C^2(B_1(0))$, compact support given. Define the ``mirror charge'' by the reflection
\[R(y)=\frac{y}{|y|^2}.\]

\[q(y)=\frac{1}{|y|^{n-2}}>1.\]
Further away, hence bigger.

\begin{itemize}
\item $R$ maps inside to outside \& vice versa.

\item $\displaystyle{R\big(R(y)\big)=\frac{R(y)}{\big|R(y)\big|^2}=\frac{\frac{y}{|y|^2}}{\left(\frac{1}{|y|}\right)^2}=y}$.

\item Joint electrostatic potential of charge and mirror charge:
\[\Phi(x-y)-q(y)\Phi\big(x-R(y)\big).\]
\end{itemize}

\begin{claim*}
Potential from mirror charge cancels that from original charge when $x\in\partial B_1$, i.e.,
\[\Phi(x-y)-q(y)\Phi\big(x-R(y)\big)=0\ \ \forall x\in\partial B_1.\]
\end{claim*}

\begin{proof}
\[\frac{1}{|x-y|^{n-2}}\overset{?}{=}\frac{1}{|y|^{n-2}}\frac{1}{\left|x-\frac{y}{|y|^2}\right|^{n-2}}=\frac{1}{\left||y|x-\frac{y}{|y|}\right|^{n-2}}\ \ \forall x\in\partial B_1\]
This is equivalent to
\[|x|^2-2x\cdot y+|y|^2=|x-y|^2=\left||y|x-\frac{y}{|y|}\right|^2=|y|^2|x|^2-2x\cdot y+1\ \ \forall|x|=1\]
\end{proof}
Offshot. Analogous result for ball to Theorem \ref{Poisson_Green}, with
\[G(x,y)=\Phi(x-y)-q(y)\Phi\big(x-R(y)\big),\]
\[K(x,y)=-\nabla_yG(x,y)\cdot\nu(y)=\frac{1-|x|^2}{\omega_n|x-y|^n}.\]

The expression for $K(x,y)$ can be obtained by explicit calculation.

$G$ and $K$ are called \textbf{Green's function} respectively \textbf{Poisson kernel} \textbf{for the ball}.

%19/05
\subsubsection*{}
Main result: harmonic functions are infinitely differentiable.

\begin{example*}
Solutions to
\[u_{xx}+u_{yy}=0\]
are $C^{\infty}$.

Note. \textbf{Not} true for solutions of just any nice looking PDE.
\end{example*}

\begin{example*}
\[u_{xx}+u_{xy}=0\]
has a solution for which $u_{yy}$ does not exist.

Let $u(x,y)=x+y|y|$.
\[u_x=1,\]
\[u_{xx}=0,\]
\[u_{xy}=0.\]
Hence, $u_{xx}+u_{xy}=0$.
\[u_y(x,y)=\left\{\begin{array}{cc}\frac{d}{dy}(-y^2)&y<0\\\frac{d}{dy}y^2&y>0\end{array}\right\}=\left\{\begin{array}{cc}-2y&y\leq0,\\2y&y>0.\end{array}\right.\]

$u_{yy}$ does not exist at $y=0$.
\end{example*}

Key technique for proving harmonic functions are $C^{\infty}$: \textbf{mollification}.

\textbf{Mollification} is a general method for approximating rough functions by smooth functions.

Intuition. If the delta function were a function, then
\[(\delta*f)(x)=\int\delta(x-y)f(y)\,dy=f(x).\]

We use a ``smoothed out'' delta function.

Definie the so-called \textbf{standard mollifier} by
\[\eta(x)=\left\{\begin{array}{cc}Ce^{\frac{-1}{|x|^2-1}}&|x|<1,\\0&|x|\geq1,\end{array}\right.\]
where $C$ is chosen so that
\[\int_{\mathbb{R}^n}\eta(x)\,dx=1.\]

Can be shown: $\eta\in C^{\infty}(\mathbb{R}^n)$ and $\supp(\eta)=\overline{B_1(0)}$.

(Note that $\eta$ is not equal to its Taylor series, i.e., it is not analytic.)

For $\epsilon>0$, define
\[\eta_{\epsilon}(x)=\frac{1}{\epsilon^n}\eta\left(\frac{x}{\epsilon}\right).\]

Note. $\int_{\mathbb{R}^n}\eta_{\epsilon}(x)\,dx=1$ and $\supp(\eta_{\epsilon})=\overline{B_{\epsilon}(0)}$.

As $\epsilon\to0$, $\eta_{\epsilon}$ ``approximates'' the delta function.

\begin{definition*}
For a locally integrable function $f:\Omega\rightarrow\mathbb{R}$, we define the \textbf{mollification of $\boldsymbol{f}$} as
\[f^{\epsilon}=\eta_{\epsilon}*f.\]
\[f^{\epsilon}(x)=\int_{\Omega}\eta_{\epsilon}(x-y)f(y)\,dy=\int_{B_{\epsilon}(0)}\eta_{\epsilon}(y)f(x-y)\,dy.\]

$f^{\epsilon}:\Omega_{\epsilon}\rightarrow\mathbb{R}$, where $\Omega_{\epsilon}=\{x\in\Omega:\dist(x,\partial\Omega)>\epsilon\}$.
\end{definition*}

\begin{lemma}\label{properties_mollifier}
%Lemma 2.1
\emph{\textbf{(Properties of mollifiers)}}
\begin{enumerate}[label=(\roman*)]
\item\label{mollifier_differentiable} $f^{\epsilon}\in C^{\infty}(\Omega_{\epsilon})$;
\item\label{mollifier_conv_point} $f^{\epsilon}(x)\xrightarrow[\epsilon\to0]{}f(x)$ for a.e. $x\in\Omega$;
\item if $f\in C(\Omega)$, then $f^{\epsilon}\rightarrow f$ uniformly on compact subsets of $\Omega$.
\end{enumerate}
\end{lemma}

\begin{proof}
Exercise sheet 3.

\begin{idea}
\begin{enumerate}[label=(\roman*)]
\item $f^{\epsilon}(x)=\int_{\Omega}\eta_{\epsilon}(x-y)f(y)\,dy$, take derivatives inside onto $\eta_{\epsilon}$;
\item $f^{\epsilon}(x)=\int_{B_{\epsilon}(0)}\eta_{\epsilon}(y)f(x-y)\,dy\approx\int_{B_{\epsilon}(0)}\eta_{\epsilon}(y)f(x)\,dy=f(x)$;
\item same idea as before.
\end{enumerate}
\end{idea}
\end{proof}

\begin{theorem}\label{harmonic_infdiff}
%Thm 2.8
Let $\Omega\subseteq R^n$ open, $u\in C^2(\Omega)$ harmonic. Then, $u\in C^{\infty}(\Omega)$.
\end{theorem}

\begin{proof}
(Mollification and mean value formula)
\begin{multline*}
u^{\epsilon}(x)=(\eta_{\epsilon}*u)(x)=\int_{B_{\epsilon}(0)}\eta_{\epsilon}(y)u(x-y)\,dy=\frac{1}{\epsilon^n}\int_{B_{\epsilon}(0)}\eta\left(\frac{y}{\epsilon}\right)u(x-y)\,dy\\
=\frac{1}{\epsilon^n}\int_0^{\epsilon}\int_{\partial B_r(0)}\eta\left(\frac{r}{\epsilon}\right)u(x-y)\,dS(y)\,dr=\frac{1}{\epsilon^n}\int_0^{\epsilon}\eta\left(\frac{r}{\epsilon}\right)\underbrace{\int_{\partial B_r(0)}u(x-y)\,dS(y)}_{u(x)\cdot\vol(\partial B_r)}dr\\
=\frac{1}{\epsilon^n}\int_0^{\epsilon}\eta\left(\frac{r}{\epsilon}\right)\cdot\vol(\partial B_r)\,dr\,u(x)=\underbrace{\frac{1}{\epsilon^n}\int_{B_{\epsilon}(0)}\eta\left(\frac{y}{\epsilon}\right)\,dy}_{=1}\,u(x)=u(x).
\end{multline*}

Hence, harmonic functions are equal to their own mollification. $u^{\epsilon}\in C^{\infty}$, so $u\in C^{\infty}$.
\end{proof}

\begin{theorem}
%Thm 2.9
\emph{\textbf{(Converse to the mean value formula)}} Let $\Omega\subseteq\mathbb{R}^n$ open, $u\in C(\Omega)$ such that
\[u(x)=\fint_{\partial B_r(x)}u(y)\,dS(y)\]
for all $\partial B_r(x)\subseteq\Omega$. Then, $u\in C^{\infty}(\Omega)$ and $\Delta u=0$.
\end{theorem}

\begin{proof}
Note that the proof of Theorem \ref{harmonic_infdiff} never used that $u$ was differentiable (just that it satisfied the mean value property). So, the exact same proof tells us $u\in C^{\infty}(\Omega)$.

From the proof of the mean value formula,
\[\phi(r)=\fint_{\partial B_r(x)}u(y)\,dS(y),\]
\[\phi'(r)=\frac{r}{n}\fint_{B_r(x)}\Delta u(y)\,dy.\]

Suppose $\Delta u(x)\neq0$. Since $\Delta u$ is continuous, $\exists B_{\epsilon}(x)\subseteq\Omega$ such that $\Delta u>0$ (or $<0$) in all of $B_{\epsilon}(x)$. But this contradicts $\phi'(r)=0$. $\Rightarrow\Leftarrow$
\end{proof}

\section{Heat equation}\label{heat_equation}
%Section 3
\begin{align*}
u_t&=\Delta u\text{ in }\Omega\times[0,\infty)\\
(u_t&=u_{xx}\text{ if }\Omega\text{ in 1D})
\end{align*}

\subsection{Boundary conditions for the heat equation}
%Subsection 3.1
$u_t=u_{xx}$, where $u(x)$ is the temperature at point $x$.

\begin{enumerate}[label=(\alph*)]
\item\label{Dirichlet} \textbf{Dirichlet.} $u|_{\partial\Omega}=g_D$. Holds the ends at a fixed temperature.

\item\label{Neumann} \textbf{Neumann.} $\left.\frac{\partial u}{\partial\nu}\right|_{\partial\Omega}=g_N$. Fixes the heat flux through the ends. Flux = 0 $\Leftrightarrow$ insulated.

\item \textbf{Robin.} $\alpha u+\beta\left.\frac{\partial u}{\partial\nu}\right|_{\partial\Omega}=g_R$.
\[\underbrace{\frac{\partial u}{\partial v}}_{\mathclap{\text{heat flux}}}=-\alpha(\underbrace{u_{\text{outside}}-u}_{\mathclap{\text{temperature difference}}})\hspace{3mm}(\alpha>0).\]

\item \textbf{Periodic.} $u(a,t)=u(b,t)$ ($\Omega=[a,b]$). Basically, the two ends are touching.
\end{enumerate}

Let's look at what happens as $t\to\infty$ with different boundary conditions.

\begin{example*}
Dirichlet: hold each end of bar at a constant temperature, $u(a,t)=\alpha$, $u(b,t)=\beta$.

Assume
\[\lim_{t\to\infty}u(x,t)=u_{\infty}(x).\]

Hence, $\partial_tu(x,t)=0$ as $t\to\infty$. By the heat equation, $\partial_{xx}u(x,t)=0$ as $t\to\infty$.
\[\frac{d^2}{dx^2}u_{\infty}(x)=0,\]
so $u_{\infty}(x)=c_0+c_1x$. Using the boundary conditions,
\[u_{\infty}(x)=\alpha+(\beta-\alpha)\frac{x-a}{b-a}.\]
\end{example*}

\begin{example*}
Neumann: hold $\partial_xu(a,t)=\partial_xu(b,t)=0$, $g_N=0$ (insulated).

%24/05
\[\partial_tu(x,t)\xrightarrow[t\to\infty]{}0\]
Hence, $\partial_{xx}u_{\infty}(x)=0$, so $u_{\infty}(x)=c_0+c_1x$.

By the boundary conditions,
\[0=\left.\frac{\partial u}{\partial\nu}\right|_{x=a}=-c_1,\]
so $u_{\infty}(x)\equiv c_0$.

But what is $c_0$?

Physics: no heat flux through boundary implies total amount of heat in body should be conserved.

Maths: total amount of heat is $\int_a^bu(x,t)\,dx$. Assuming $u$ smooth,
\[\frac{d}{dt}\int_a^bu(x,t)\,dx=\int_a^b\frac{\partial u}{\partial t}(x,t)\,dx=\int_a^b\partial_{xx}u(x,t)\,dx=\partial_xu\Big|_a^b=0.\]

Hence, expect
\[(b-a)c_0=\int_a^bu_{\infty}\,dx=\int_a^bu(x,0)\,dx,\]
\[c_0=\frac{1}{b-a}\int_a^bu(x,0)\,dx=\fint_a^bu(x,0)\,dx,\]
which is the average initial temperature.

So expect $u_{\infty}(x)$ to be constant and
\[u_{\infty}(x)\equiv\fint_a^bu(x,0)\,dx.\]
\end{example*}

Denote $C^{2,1}$ the class of functions twice continuously differentiable in $x$ and once continuously differentiable in $t$.

\begin{proposition}\label{lim0_Dirichlet}
%Proposition 3.1
Let $\Omega=[a,b]$, $u\in C^{2,1}(\overline{\Omega}\times(0,\infty))\cap C(\overline{\Omega}\times[0,\infty))$ be a solution to $u_t=u_{xx}$ with boundary condition as in \ref{Dirichlet}, i.e., $u|_{x=a}=\alpha$, $u|_{x=b}=\beta$, initial condition $u|_{t=0}=u_0$, $u_{\infty}(x)$ as in \ref{Dirichlet}. Then
\[\lim_{t\to\infty}||u(\,\cdot\,,t)-u_{\infty}||_2=0.\]
\end{proposition}

\begin{proposition}\label{lim0_Neumann}
%Proposition 3.2
$u$ as above, boundary condition as in b), i.e., $\partial_xu|_{x=a}=\partial_xu|_{x=b}=0$, initial condition $u|_{t=0}=u_0$, $u_{\infty}(x)$ as in \ref{Neumann}. Then
\[\lim_{t\to\infty}||u(\,\cdot\,,t)-u_{\infty}||_2=0.\]
\end{proposition}

\begin{recall}
The $L^2$ norm of $f:\Omega\rightarrow\mathbb{R}$ is
\[||f||_2=\left(\int_{\Omega}|f|^2\right)^{1/2}\]
\end{recall}

\begin{lemma}
%Lemma 3.1
\emph{\textbf{(Poincar\'{e} inequalities in the interval $\boldsymbol{[a,b]}$)}}
\begin{enumerate}[label=\alph*)]
\item $\exists$ a constant $C>0$ such that
\[\int_a^bu^2\leq C\int_a^b(u_x)^2\]
$\forall u\in C^1([a,b])$ with $u|_{x=a,b}=0$.

\item $\exists$ a constant $C>0$ such that
\[\int_a^b(u-\overline{u})^2\leq C\int_a^b(u_x)^2\]
$\forall u\in C^1([a,b])$, where
\[\overline{u}\coloneqq\frac{1}{b-a}\int_a^bu(y)\,dy\]
is the average of $u$.
\end{enumerate}
\end{lemma}

\begin{remark}
$\text{RHS}=0\Rightarrow\text{LHS}=0$.
\end{remark}

\begin{proof}
\begin{enumerate}[label=\alph*)]
\item\label{Poincare_proofa}
\[u(x)=u(x)-u(a)=\int_a^xu_x(y)\,dy=\int_a^b\boldsymbol{1}_{[a,x]}(y)u_x(y)\,dy.\]
By Cauchy-Schwarz,
\[|u(x)|\leq\int_a^b\boldsymbol{1}_{[a,x]}(y)|u_x(y)|\,dy\leq\left(\int_a^b\boldsymbol{1}_{[a,x]}^2\right)^{1/2}\cdot\left(\int_a^b|u_x|^2\right)^{1/2}.\]
\[u(x)^2\leq(b-a)\int_a^bu_x^2.\]
\[\int_a^bu(x)^2\leq(b-a)^2\int_a^bu_x^2.\]
i.e., assertion with $C=(b-a)^2$.

\item By intermediate value theorem, $\exists x_*\in[a,b]$ such that $u(x_*)=\overline{u}$. Hence,
\[u(x)-\overline{u}=\int_{x_*}^xu_x.\]
Rest of proof same as \ref{Poincare_proofa}. Again, assertion holds with $C=(b-a)^2$.
\end{enumerate}
\end{proof}

\begin{lemma}
%Lemma 3.2
\emph{\textbf{(Gronwall lemma)}} Let $y\in C^1([0,\infty))$ with $y\geq0$ such that $y'\leq\alpha y$ for some constant $\alpha\in\mathbb{R}$. Then,
\[y(t)\leq e^{\alpha t}y(0).\]
\end{lemma}

\begin{remark}
If $y\in C^1([0,\infty))$ with $y\geq0$ such that $y'=\alpha y$, for some constant $\alpha\in\mathbb{R}$, then
\[y(t)=e^{\alpha t}y(0).\]

So Gronwall says if ``$\leq$'' in ODE, get ``$\leq$'' in solution formula.
\end{remark}

\begin{proof}
If $y'\leq\alpha y$, then
\[\frac{d}{dt}(y(t)e^{-\alpha t})=y'e^{-\alpha t}-\alpha ye^{-\alpha t}\leq0.\]
Hence, $t\mapsto y(t)e^{-\alpha t}$ is non increasing, so $\forall\tau\geq0$
\begin{align*}
y(\tau)e^{-\alpha\tau}&\leq y(0)e^{-\alpha0},\\
y(\tau)&\leq y(0)e^{\alpha\tau}.
\end{align*}
\end{proof}

\begin{proof}
(Proposition \ref{lim0_Dirichlet})
\begin{idea}
Apply Gronwall to $y(t)\coloneqq||u(\,\cdot\,,t)-u_{\infty}||_2^2$. The square is for simpler derivative.
\end{idea}

\[v(x,t)\coloneqq u(x,t)-u_{\infty}(x).\]

Which equation is solved by $v$?

Since $\partial_{xx}u_{\infty}=0$,
\[\partial_tv=\partial_tu=\partial_{xx}u=\partial_{xx}v,\]
i.e., $v$ solves the heat equation.

\[v|_{x\in\partial[a,b]}=u(x,t)|_{x\in\partial[a,b]}-u_{\infty}|_{x\in\partial[a,b]}=0,\]
so
\[\left\{\begin{array}{ccc}\partial_tv=\partial_{xx}v&\text{in}&[a,b]\times(0,\infty),\\v=0&\text{on}&\partial[a,b]\times(0,\infty).\end{array}\right.\]

\[\frac{d}{dt}||v(\,\cdot\,,t)||_2^2=\frac{d}{dt}\int_a^bv(x,t)^2\,dx=\int_a^b2v(x,t)\underbrace{\partial_tv(x,t)}_{\mathclap{=\partial_{xx}v(x,t)}}dx=2\underbrace{v(x,t)}_{=0}v_x(x,t)\Big|_{a}^b-\int_a^b2v_x(x,t)\cdot v_x(x,t).\]
Then, by Poincar\'{e},
\[\frac{d}{dt}\int_a^bv(\,\cdot\,,t)^2=-2\int_a^bv_x(\,\cdot\,,t)^2\leq-\frac{2}{c}\int_a^bv(\,\cdot\,,t)^2.\]
By Gronwall,
\[\int_a^bv(\,\cdot\,,t)^2\leq \underbrace{e^{-\frac{2}{c}t}}_{\to0\ (t\to\infty)}\underbrace{\int_a^bv(\,\cdot\,,0)^2}_{\text{constant}}.\]
\end{proof}

\begin{proof}
(Proposition \ref{lim0_Neumann}) Again, let $v(\,\cdot\,,t)\coloneqq u(\,\cdot\,,t)-u_{\infty}$. Same calculation as before; this time, boundary term vanishes due to $v_x|_{x=a,b}=0$.
\end{proof}

\begin{summary}
Heat equation ``irons out'' fluctutations in $u$ as time gets large, as much as consistent with boundary conditions.
\end{summary}

%31/05

\subsection{Two derivations of the heat or diffusion equation}
%Subsection 3.2
\begin{equation}\tag{H}
\frac{\partial u}{\partial t}-D\Delta u=0,
\end{equation}
$u=u(x,t)$, $u:\overline{\Omega}\times[0,\infty)\rightarrow\mathbb{R}$, $D>0$ the ``diffusion coefficient''.

\begin{equation}\tag{IH}
\frac{\partial u}{\partial t}-D\Delta u=f,
\end{equation}
$f:\Omega\times(0,\infty)\rightarrow\mathbb{R}$ given. $\Delta=\Delta_x=\sum_{i=1}^n\frac{\partial^2}{\partial x_i^2}$, $\Omega\subseteq\mathbb{R}^n$.

\subsubsection*{Heat transfer}

$\Omega\subseteq R^n$ region occupied by isotropic material of mass density $\rho>0$ (e.g., water); receives energy from external source at rate $r$.

\subsubsection*{Physical principles}

\begin{enumerate}[label=(\arabic*)]
\item\label{conservation_energy} Conservation of energy: rate of change of internal energy of any test volume $V\subseteq\Omega$ equals the heat flux through body $\partial V$ + rate of change due to external source.

\item Fourier's law: heat flux is proportional to minus the temperature gradient (in particular, heat flows from hot to cold)

\item Internal energy is proportional to temperature.
\end{enumerate}

Translate into math formulae:
\begin{enumerate}[label=(\arabic*)]
\item\label{conservation_energy_eq} $e(x,t)$ internal energy density per unit mass at time $t$.

Total internal energy in test volume $V$:
\[\int_V\rho e(x,t)\,dx.\]

Rate of change of internal energy in $V$:
\[\frac{d}{dt}\int_V\rho e(x,t)\,dx=\int_V\rho\frac{\partial e}{\partial t}(x,t)\,dx.\]

$q(x,t)$ the heat flux vector.

Incoming heat flux through $\partial V$:
\[-\int_{\partial V}q\cdot\nu\,dS\underset{\text{Gauss}}{=}-\int_V\diver q\,dx.\]

$r(x,t)$ the rate of supplied energy density per unit volume, per unit time.

Rate of change of total energy in $V$ due to external source:
\[\int_Vr(x,t)\,dx.\]

So
\[\text{\ref{conservation_energy}}\Longleftrightarrow\int_V\rho\frac{\partial e}{\partial t}\,dx=-\int_V(\diver q-r)\,dx.\]

True for all test volumes $V\subseteq\Omega$. Hence,
\[\rho\frac{\partial e}{\partial t}=-\diver q+r.\]

\item\label{Fouriers_law_eq} $\theta(x,t)$ the temperature at point $x$ at time $t$.
\[q(x,t)=-k\nabla_x\theta(x,t),\]
$k>0$ is a material constant (the thermal conductivity).

\item\label{thermo_eq} \[e=c_0\theta,\]
$c_0>0$ a material constant (the specific heat).
\end{enumerate}

Substitute \ref{Fouriers_law_eq} and \ref{thermo_eq} into \ref{conservation_energy_eq}:
\begin{align*}
\rho c_0\frac{\partial\theta}{\partial t}&=k\diver\nabla\theta+r,\\
\frac{\partial\theta}{\partial t}&=D\Delta\theta+f,
\end{align*}
where
\[D=\frac{k}{\rho c_0}=\frac{\text{thermal conductivity}}{\text{specific heat}\cdot\text{mass density}}\]
is the diffusion coefficient and
\[f=\frac{r}{\rho c_0}=\frac{\text{rate supplied energy density per unit volume}}{\text{specific heat}\cdot\text{mass density}}.\]

\subsubsection*{Symmetric random walk in 1D and macroscopic models of diffusion}

Consider a particle moving on the $x$-axis according to the following rules:
\begin{enumerate}[label=(\arabic*)]
\item at time $t=0$, start at $x=0$;
\item\label{distance_step} in a time step $\tau>0$, particle moves left or right by a distance $h$, with equal probability.
\end{enumerate}

After $N$ timesteps, at time $t=N\cdot\tau$, particle is at \textbf{some} position $x=mh$ with $m\in\mathbb{Z}\cap[-N,N]$.

Quantity of interest: $p(x,t)$ the probability that particle is at $x$ at time $t$.

\textbf{Compute $\boldsymbol{p}$.} To reach $x=mh$, particle has done:
\begin{itemize}
\item $k$ steps to the right,
\item $N-k$ steps to the left.
\end{itemize}
$m=0+k\cdot(+1)+(N-k)\cdot(-1)=2k-N$, so
\[k=\frac{m+N}{2}.\]
\[p(x,t)=\frac{\text{\# paths with }k\text{ (out of }N\text{) steps to right}}{\text{\# paths with }N\text{ steps}}=\frac{\binom{N}{k}}{2^N}\eqqcolon p_{N,k},\]
where
\[\binom{N}{k}=\frac{N!}{k!(N-k)!}\]
is the binomial coefficient.

Want to pass from the discrete model to a continuous model with $p(x,t)$ the probability \textbf{density} that the particle is at $x\in\mathbb{R}$ at time $t$.

Hence, would like to send $\tau\to0$, $h\to0$.

Want to keep 2 quantities invariant: for fixed final time $t=t_1$,
\[\mathbb{E}_t(x)\text{ the mean},\]
\[\mathbb{E}_t(x^2)-\mathbb{E}_t(x)^2\text{ the variance}.\]

\textbf{Compute these.} Use $m=2k-N$ and compute $\mathbb{E}(k),\mathbb{E}(k(k-1))$.
\[\mathbb{E}(k)=\sum_{k=0}^Nk\cdot p_{N,k}=\frac{1}{2^N}\sum_{k=0}^Nk\cdot\binom{N}{k},\]
\[\mathbb{E}\big(k(k-1)\big)=\sum_{k=0}^Nk(k-1)p_{N,k}=\frac{1}{2^N}\sum_{k=0}^Nk(k-1)\cdot\binom{N}{k}.\]

Trick. Use generating function
\[G(s)\coloneqq\frac{1}{2^N}\sum_{k=0}^N\binom{N}{k}s^k=\frac{(1+s)^N}{2^N},\]
by the binomial theorem.

\[\mathbb{E}(k)=G'(s)|_{s=1}=\left.\frac{N(1+s)^{N-1}}{2^N}\right|_{s=1}=\frac{N}{2},\]
\[\mathbb{E}\big(k(k-1)\big)=G''(s)|_{s=1}=\left.\frac{N(N-1)(1+s)^{N-2}}{2^N}\right|_{s=1}=\frac{N(N-1)}{4},\]
since $\frac{d^2}{ds^2}s^k=k(k-1)s^{k-2}$.
\[\mathbb{E}(k^2)=\mathbb{E}\big(k(k-1)\big)+\mathbb{E}(k)=\frac{N(N-1)}{4}+\frac{N}{2}=\frac{N(N+1)}{4}.\]

Now recall position $m$ after $N$ steps is $m=2k-N$, so
\[\mathbb{E}(m)=N-N=0.\]
\[\mathbb{E}(m^2)-\mathbb{E}(m)^2=\mathbb{E}(m^2)=\mathbb{E}\big((2k-N)^2\big)=\mathbb{E}(4k^2-4kN+N^2)=N(N+1)-4\frac{N}{2}\cdot N+N^2=N.\]

Now use $x=h\cdot m$,
\[\mathbb{E}(x)=0,\]
\[\mathbb{E}(x^2)-\mathbb{E}(x)^2=\var(x)=h^2\cdot N,\]
\[\sd(x)=\sqrt{\var(x)}=h\sqrt{N},\]
the standard deviation.

Expected distance from $0$ after $N$ steps is $\mathcal{O}(h\sqrt{N})$. Fix final time and standard deviation:
\begin{alignat*}{2}
t_1=N_{\tau}&\Leftrightarrow\tau=\frac{t_1}{N}&&\text{time step}\sim\frac{1}{N}\\
\sd_{t_1}(x)=\sqrt{N}h&\Leftrightarrow h=\frac{\sd_{t_1}(x)}{\sqrt{N}}\hspace{5mm}&&\text{spatial step}\sim\frac{1}{\sqrt{N}}
\end{alignat*}

$N\to\infty$ at fixed $t_1$ and $\sd_{t_1}(x)$ means
\begin{equation}\tag{$*$}\label{limit_RW}
\begin{split}
\tau&\to0,\\
h&\to0,\\
\frac{h^2}{\tau}&\equiv\text{const}=\frac{\sd_{t_1}(x)^2}{t_1},
\end{split}
\end{equation}
which is an interesting limit.

Updating rule \ref{distance_step}:
\begin{equation}\tag{U}\label{distance_step_updated}
p(x,t+\tau)=\frac{p(x-h,t)+p(x+h,t)}{2}
\end{equation}

Taylor expansion, assuming $(x,t)\mapsto p(x,t)$ $C^2$ in $t$, $C^4$ in $x$,
\[p(x,t+\tau)=p(x,t)+\frac{\partial p}{\partial t}(x,t)\tau+\mathcal{O}(\tau^2),\]
\[p(x\pm h,t)=p(x,t)\pm\frac{\partial p}{\partial x}(x,t)h+\frac{1}{2}\frac{\partial^2p}{\partial x^2}(x,t)h^2\pm\frac{1}{3!}\frac{\partial^3p}{\partial x^3}(x,t)h^3+\mathcal{O}(h^4).\]
Hence,
\[\frac{p(x+h)+p(x-h)}{2}=p(x,t)+0+\frac{1}{2}\frac{\partial^2p}{\partial x^2}(x,t)h^2+0+\mathcal{O}(h^4).\]
\begin{align*}
\text{\eqref{distance_step_updated}}\Leftrightarrow\frac{\partial p}{\partial t}\cdot\tau+\mathcal{O}(\tau^2)=\frac{h^2}{2}\frac{\partial^2p}{\partial x^2}+\mathcal{O}(h^4)\\
\frac{\partial p}{\partial t}+\mathcal{O}(\tau)=\underbrace{\frac{h^2}{2\tau}p_{xx}}_{\mathclap{=\text{const}\eqqcolon D}}+\mathcal{O}\left(\vphantom{\frac{h^2}{\tau}}\right.\underbrace{\frac{h^2}{\tau}}_{\equiv\text{const}}\cdot\underbrace{h^2}_{\rightarrow0}\left.\vphantom{\frac{h^2}{\tau}}\right)
\end{align*}

Hence, in limit \eqref{limit_RW}
\[p_t=Dp_{xx},\]
\[D=\frac{h^2}{2\tau}=\frac{\sd^2_{t_1}(x)}{2t_1}\]
the diffusion coefficient.

This derivation of the heat equation and the microscopic formula for $D$, goes back to A. Einstein (1905).

%02/06
\subsection{The Fourier transform}
%Subsection 3.3
Fourier 1807, 1811.
\[\hat{f}(k^{(1)})e^{ik^{(1)}\cdot x}+\hat{f}(k^{(2)})e^{ik^{(2)}\cdot x}+\cdots\]

\begin{align*}
f\text{ periodic}&\longrightarrow k^{(j)}\in\mathbb{Z},\text{ discrete sum }\sum_{f\in\mathbb{Z}};\\
f\text{ decays at }\infty&\longrightarrow k^{(j)}\in\mathbb{R},\text{ continuous superposition }\int_{k\in\mathbb{R}}.
\end{align*}

\begin{definition*}
\textbf{(Function space $\boldsymbol{L^1(\Omega)}$)} Let $\Omega\subseteq\mathbb{R}^n$ open.
\[L^1(\Omega)\coloneqq\left\{f:\Omega\longrightarrow\mathbb{C}\,\left|\,f\text{ measurable},\int_{\Omega}|f|<\infty\right.\right\}.\]
\end{definition*}

\begin{definition*}
For any $f\in L^1(\mathbb{R}^n)$, define its \textbf{Fourier transform} by
\[\hat{f}(k)\coloneqq\int_{\mathbb{R}^n}e^{-ik\cdot x}f(x)\,dx,\]
where $k\in\mathbb{R}^n$, $\hat{f}:\mathbb{R}^n\rightarrow\mathbb{C}$ and
\[k\cdot x=\sum_{j=1}^nk_jx_j\]
is the usual inner product on $\mathbb{R}^n$.
\end{definition*}

\begin{warning}
No unified normalization convention. Also used:
\begin{align*}
\hat{f}(k)&=\int e^{-i2\pi k\cdot x}f(x)\,dx,\\
\hat{f}(k)&=\frac{1}{(2\pi)^{n/2}}\int e^{-ik\cdot x}f(x)\,dx,
\end{align*}
or ``$+$'' not ``$-$''...
\end{warning}

\begin{note}
$|\text{integrand}|=\underbrace{|e^{ik\cdot x}|}_{=1}\cdot|f(x)|\in L^1(\mathbb{R}^n)$.
\end{note}

\begin{theorem}\label{properties_FT}
%Thm 3.1
\emph{\textbf{(Properties of Fourier transform)}} Suppose $f:\mathbb{R}^n\rightarrow\mathbb{C}$ satisfies
\begin{equation}\tag{$*$}\label{bis_L1}
f\in L^1(\mathbb{R}^n),\ \hat{f}\in L^1(\mathbb{R}^n).
\end{equation}
Then $f$ can be reconstructed from its Fourier transform as follows:
\begin{equation}\tag{R}\label{Fourier_inverse}
f(x)=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\hat{f}(k)e^{ik\cdot x}\,dk\ \text{ for a.e. }x\in\mathbb{R}^n.
\end{equation}

Moreover, if $g$ is another function satisfying \eqref{bis_L1}, then
\begin{enumerate}[label=\arabic*)]
\item Plancherel's formula:
\[\int_{\mathbb{R}^n}f\bar{g}=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\hat{f}\bar{\hat{g}};\]
\item Plancherel's formula:
\[\int_{\mathbb{R}^n}|f|^2=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}|\hat{f}|^2;\]
\item Fourier transform of a convolution:
\[\widehat{f*g}=\hat{f}\hat{g},\]
where
\[(f*g)(x)=\int_{\mathbb{R}^n}f(x-y)g(y)\,dy;\]
\item Fourier transform of a product:
\[\widehat{f\cdot g}=\frac{1}{(2\pi)^n}\hat{f}*\hat{g};\]
\item\label{FT_translate} Fourier transform of a translate:
\[\widehat{f(\,\cdot\,+a)}(k)=e^{ik\cdot a}\hat{f}(k);\]
\item\label{FT_derivative} Fourier transform of a derivative: if in addition $f$ is continuously differentiable and $\frac{\partial f}{\partial x_i}\in L^1(\mathbb{R}^n)$, then
\[\widehat{\frac{\partial f}{\partial x_j}}(k)=ik_j\hat{f}(k);\]
\item Fourier transform of a rescale:
\[\widehat{f(ax)}(k)=\frac{1}{a^n}\hat{f}\left(\frac{k}{a}\right).\]
\end{enumerate}
\end{theorem}

\begin{remark}
For PDEs, key point is \ref{FT_derivative}. Fourier transform transforms differentiation (with respect to $x_j$) into something much simpler, namely multiplication (by $ik_j$). Allows to solve many PDEs explicitly; Fourier's motivation for introducing the FT in 1811.
\end{remark}

\begin{proof}
\begin{enumerate}[label=\arabic*)]
\item[(R)] Next week.

\item Class.

\item Class.

\item
\begin{multline*}
\widehat{f*g}(k)=\int_{\mathbb{R}^n}(f*g)(x)e^{-ik\cdot x}\,dx=\int_{\mathbb{R}^n}\left(\int_{\mathbb{R}^n}f(x-y)g(y)\,dy\right)e^{-ik\cdot x}\,dx\\
\underset{\text{Fubini}}{=}\int_{\mathbb{R}^n}\underbrace{\left(\int_{\mathbb{R}^n}f(x-y)e^{-ik\cdot x}\,dx\right)}_{=\widehat{f(\,\cdot\,-y)}(k)\underset{\text{\ref{FT_translate}}}{=}\hat{f}(k)\cdot e^{-ik\cdot y}}g(y)\,dy=\hat{f}(k)\cdot\int_{\mathbb{R}^n}g(y)e^{-ik\cdot y}\,dy=\hat{f}(k)\hat{g}(k).
\end{multline*}

\item Class.

\item $g(x)\coloneqq f(x+a)$. Doing the change of variable $y=x+a$, we obtain
\begin{multline*}
\hat{g}(k)=\int_{\mathbb{R}^n}e^{-ik\cdot x}g(x)\,dx=\int_{\mathbb{R}^n}e^{-ik\cdot x}f(x+a)\,dx\\
=\int_{\mathbb{R}^n}e^{-ik\cdot(y-a)}f(y)\,dy=\int_{\mathbb{R}^n}e^{-ik\cdot y}\underbrace{e^{ik\cdot a}}_{\mathclap{\text{indep. of }y}}f(y)\,dy=e^{ik\cdot a}\hat{f}(y).
\end{multline*}

\item For simplicity, assume $f=0$ outside some bounded set.
\begin{multline*}
\widehat{\frac{\partial f}{\partial x_j}}(k)=\int_{\mathbb{R}^n}e^{-ik\cdot x}\frac{\partial f}{\partial x_j}(x)\,dx=\int_{\mathbb{R}^{n-1}}\left(\int_{\mathbb{R}}e^{-i(k_1x_1+\cdots+k_jx_j+\cdots+k_nx_n)}\frac{\partial f}{\partial x_j}(x)\,dx_j\right)\prod_{l:l\neq j}dx_l\\
\underset{\text{parts}}{=}\int_{\mathbb{R}^{n-1}}\left(-\int_{\mathbb{R}}\left(\frac{\partial}{\partial x_j}e^{-i(k_1x_1+\cdots+k_jx_j+\cdots+k_nx_n)}\right)f(x)\,dx_j\right)\prod_{l:l\neq j}dx_l\\
=ik_j\int_{\mathbb{R}^n}e^{-ik\cdot x}f(x)\,dx=ik_j\hat{f}(k).
\end{multline*}
\end{enumerate}
\end{proof}

\begin{remark}
The rule
\[\frac{\partial}{\partial x_j}e^{ik\cdot x}=ik_je^{ik\cdot x}\]
means that $x\mapsto e^{ik\cdot x}$ is an \textbf{eigenfunction} of the differentiation operator $\frac{\partial}{\partial x_j}$.

As a consequence, $x\mapsto e^{ik\cdot x}$ is also an eigenfunction of compositions and linear combinations of the $\frac{\partial}{\partial x_j}$, e.g.,
\[\Delta e^{ik\cdot x}=\sum_{j=1}^n\frac{\partial^2}{\partial x_j^2}e^{ik\cdot x}=\sum_{j=1}^nik_j\cdot ik_j\cdot e^{ik\cdot x}=-\sum_{j=1}^nk_j^2e^{ik\cdot x}=-|k|^2e^{ik\cdot x}.\]

This is why Fourier ``expanded into $e^{ik\cdot x}$ functions''.
\end{remark}

\begin{example*}
Important example: Fourier transform of a Gaussian. $n=1$,
\[f(x)=e^{-\frac{x^2}{2a^2}}.\]
\[\hat{f}(k)=\int_{\mathbb{R}}e^{-ikx-\frac{x^2}{2a^2}}\,dx=\int_{\mathbb{R}}e^{-\left(\frac{x}{\sqrt{2}a}+\frac{iak}{\sqrt{2}}\right)^2+\left(\frac{iak}{\sqrt{2}}\right)^2}\,dx=e^{-\frac{a^2k^2}{2}}\underbrace{\int_{\mathbb{R}}e^{-\left(\frac{x}{\sqrt{2}a}+\frac{iak}{\sqrt{2}}\right)^2}\,dx}_{\eqqcolon I}\]

\begin{claim*}
$\int_{\mathbb{R}}e^{-\alpha(x+i\beta)^2}\,dx$, $\alpha>0$, $\beta\in\mathbb{R}$, is independent of $\beta$!
\end{claim*}

\begin{explanation}
Contour integration in $\mathbb{C}$.

\begin{center}
\begin{tikzpicture}
\newcommand{\infvar}{5}
\newcommand{\betavar}{4}
\newcommand{\arr}{1}

\draw [->] (-\infvar,0) -- (\arr,0);
\draw (\arr,0) -- (\infvar,0);
\draw [->] (\infvar,0) -- (\infvar,\betavar/2);
\draw (\infvar,\betavar/2) -- (\infvar,\betavar);
\draw [->] (\infvar,\betavar) -- (-\arr,\betavar);
\draw (-\arr,\betavar) -- (-\infvar,\betavar);
\draw [->] (-\infvar,\betavar) -- (-\infvar,\betavar/2);
\draw (-\infvar,\betavar/2) -- (-\infvar,0);
\draw [fill] (0,0) circle (1pt);
\draw [below] (0,0) node {$0$};
\draw [above] (0,\betavar) node {$\mathcal{C}$};
\draw [below left] (-\infvar,0) node {$-\infty$};
\draw [below right] (\infvar,0) node {$\infty$};
\draw [above right] (\infvar,\betavar) node {$\infty+i\beta$};
\draw [above left] (-\infvar,\betavar) node {$-\infty+i\beta$};
\end{tikzpicture}
\end{center}

Let $\gamma_1=\mathbb{R}$, $\gamma_2=\mathbb{R}+i\beta$, $\mathcal{C}$ the counter-clockwise rectangle formed by $\gamma_1,\gamma_2$ and the vertical segments.

$f(z)=e^{-\alpha z^2}$ is holomorphic, so
\[\int_{\mathcal{C}}f(z)\,dz=0.\]

$f=0$ on vertical segments, so
\[\int_{-\infty}^{\infty}e^{-\alpha x^2}\,dx=\int_{\gamma_1}f(z)\,dz=\int_{\gamma_2}f(z)\,dz=\int_{-\infty}^{\infty}e^{-\alpha(x+i\beta)^2}\,dx.\]
\end{explanation}

\begin{explanation}
\[\frac{d}{d\beta}\int_{\mathbb{R}}e^{-\alpha(x+i\beta)^2}\,dx=\int_{\mathbb{R}}-2\alpha(x+i\beta)\cdot ie^{-\alpha(x+i\beta)^2}\,dx=\int_{\mathbb{R}}i\frac{d}{dx}e^{-\alpha(x+i\beta)^2}\,dx=ie^{-\alpha(x+i\beta)^2}\Big|_{-\infty}^{\infty}=0.\]

Hence, doing the change of variable $y=\frac{x}{\sqrt{2}a}$, $dx=2\sqrt{a}\,dy$,
\[I=\int_{\mathbb{R}}e^{-\left(\frac{x}{\sqrt{2}a}\right)^2}\,dx=\sqrt{2}a\underbrace{\int_{\mathbb{R}}e^{-y^2}\,dy}_{\sqrt{\pi}}=\sqrt{2\pi a^2}.\]

Thus,
\[\hat{f}(k)=e^{-\frac{a^2k^2}{2}}\sqrt{2\pi a^2}.\]
\end{explanation}

Up to normalization, Fourier transform of a Gaussian of standard deviation $a$ is a Gaussian of standard deviation $\frac{1}{a}$.

Generalizes to $n$ dimensions $G:\mathbb{R}^n\rightarrow\mathbb{R}$,
\[G(x)=\frac{1}{\sqrt{2\pi a^2}^n}e^{-\frac{|x|^2}{2a^2}}=\frac{1}{\sqrt{2\pi a^2}^n}e^{-\frac{x_1^2}{2a^2}}\cdots e^{-\frac{x_n^2}{2a^2}}=\prod_{j=1}^ng(x_j),\]
where
\[g(s)=\frac{1}{\sqrt{2\pi a^2}}e^{-\frac{s^2}{2a^2}}\]
is the 1D Gaussian, normalized such that $\int g=1$.

\[\widehat{G}(k)=\int_{\mathbb{R}^n}e^{-ik\cdot x}G(x)\,dx=\int_{\mathbb{R}}\cdots\int_{\mathbb{R}}\prod_{j=1}^ne^{-ik_jx_j}g(x_j)\,dx_1\cdots dx_n=\prod_{j=1}^n\hat{g}(k_j)\underset{\text{1D}}{=}e^{-\frac{a^2|k|^2}{2}}.\]

\begin{remark}
\[1=\widehat{G}(0)=\int_{\mathbb{R}^n}e^{-i0\cdot x}G(x)\,dx=\int G=1.\]
\end{remark}
\end{example*}

%09/06
\subsection[Solving the heat equation in \texorpdfstring{$\mathbb{R}^n$}{R\textasciicircum n}]{Solving the heat equation in \texorpdfstring{$\boldsymbol{\mathbb{R}^n}$}{R\textasciicircum n}}
%Subsection 3.4
\begin{equation}\tag{H}\label{heat_eq}
\frac{\partial u}{\partial t}=D\Delta u\ \text{
in }\mathbb{R}^n\times(0,\infty);
\end{equation}
\begin{equation}\tag{IC}\label{ini_con_heat}
u(x,0)=u_0(x),\ \text{ for }x\in\mathbb{R}^n;
\end{equation}
\begin{equation}\tag{BC}\label{boun_con_heat}
u(x,t)\xrightarrow[|x|\to\infty]{}g\ \ \forall t>0,
\end{equation}
($g$ is a given constant).

\begin{note}
W.l.o.g. we can take $g=0$ (because $u-g$ satisfies \eqref{heat_eq} but goes to $0$ as $|x|\to\infty$).
\end{note}

Suppose $u$ is a smooth solution that decays rapidly as $|x|\to\infty$, so that $u(\,\cdot\,,t),\frac{\partial u}{\partial t}(\,\cdot\,,t)\in L^1(\mathbb{R}^n)$ $\forall t>0$.

As in the exercise sheet from last week, we will solve the PDE by Fourier transforming in $x$:
\[\mathcal{F}\left[\frac{\partial u}{\partial t}\right]=\mathcal{F}[D\Delta u],\]
\begin{multline*}
\frac{\partial}{\partial t}\mathcal{F}[u]=D\mathcal{F}\left[\sum_{i=1}^n\partial_i\partial_iu\right]=D\sum_{i=1}^n\mathcal{F}[\partial_i\partial_iu]=D\sum_{i=1}^nik_i\mathcal{F}[\partial_iu]\\
=D\sum_{i=1}^n(ik_i)^2\mathcal{F}[u]=-D\sum_{i=1}^nk_i^2\mathcal{F}[u]=-D|k|^2\mathcal{F}[u].
\end{multline*}
That is,
\[\frac{\partial}{\partial t}\hat{u}(k,t)=-D|k|^2\hat{u}(k,t).\]

The Fourier transform turned the PDE into a bunch of ODEs parametriced by $k$.

Since $k$ is a constant with respect to the ODE in $t$, the solution to the ODE is the exponential function:
\[\hat{u}(k,t)=ce^{-D|k|^2t}.\]

We can find $c$ by plugging in the initial condition:
\[\hat{u}(k,0)=ce^0=c=\hat{u}_0(k),\]
by Fourier transform of \eqref{ini_con_heat}. So,
\[\hat{u}(k,t)=\hat{u}_0(k)e^{-D|k|^2t}.\]

Now, we inverse transform to find $u$:
\[u(x,t)=\mathcal{F}^{-1}\big[\hat{u}(k,t)\big]=\mathcal{F}^{-1}\big[\hat{u}_0(k)\underbrace{e^{-D|k|^2t}}_{=\widehat{G}_t(k)}\big],\]
where
\[G_t(x)=\frac{1}{\sqrt{4\pi Dt}^n}e^{-\frac{|x|^2}{4Dt}}\]
is the Gaussian. By the convolution property of FT,
\[u(x,t)=G_t*u_0=\frac{1}{\sqrt{4\pi Dt}^n}\int_{\mathbb{R}^n}e^{-\frac{|x-y|^2}{4Dt}}u_0(y)\,dy.\]
(Fourier 1811)

$G_t$ is called the \textbf{fundamental solution} to the heat equation.

\begin{note}
$G_t$ solves \eqref{heat_eq} ``by construction'' because
\[\widehat{G}_t=ce^{-D|k|^2t}\Longrightarrow\partial_t\widehat{G}_t=-D|k|^2\widehat{G}_t\Longrightarrow\partial_tG_t=D\Delta G_t.\]
\end{note}

\begin{remark}
You found $G_t$ in Exercise 3 on Sheet 4 by using radial symmetry.
\end{remark}

$G_t$ is the Gaussian with standard deviation proportional to $\sqrt{t}$.

\begin{remark}
\[\frac{(\text{Standard deviation at time }t)^2}{t}=\text{constant},\]
just like with the random walk derivation.

$G_t(x)$ is precisely the continuum limit of the probability $p(x,t)$ for the stochastic particle.
\end{remark}

Back to solving the heat equation.

So far, we showed that
\[u\text{ smooth}+\text{decaying}+\text{satisfies \eqref{heat_eq}, \eqref{ini_con_heat}, \eqref{boun_con_heat}}\Longrightarrow u=G_t*u_0.\]

Now, we want to show the other direction: given $u_0$, define $u=G_t*u_0$ and show that $u$ satisfies \eqref{heat_eq}, \eqref{ini_con_heat}, \eqref{boun_con_heat}.

W.l.o.g. we again assume $g=0$ in the boundary condition.

\begin{theorem}\label{th_sol_heat}
%Thm 3.2
\emph{\textbf{(Solution to the heat equation in $\boldsymbol{\mathbb{R}^n}$)}} Let $u_0\in C(\mathbb{R}^n)$ and $u_0$ bounded. Define $u$ by
\[u(x,t)=(G_t*u_0)(x)=\frac{1}{\sqrt{4\pi Dt}^n}\int_{\mathbb{R}^n}e^{-\frac{|x-y|^2}{4Dt}}u_0(y)\,dy\]
for $x\in\mathbb{R}^n$, $t>0$. Then,
\begin{enumerate}[label=(\arabic*)]
\item (solves \eqref{heat_eq}) $u$ is in $C^2$ and solves \eqref{heat_eq};
\item (solves \eqref{ini_con_heat}) $\displaystyle{\lim_{t\to0^+}u(x,t)=u_0(x)}$ $\forall x\in\mathbb{R}^n$;
\item  (solves \eqref{boun_con_heat}) If $u\in L^1(\mathbb{R}^n)$, then $\displaystyle{\lim_{|x|\to\infty}u(x,t)=0}$ $\forall t>0$.
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}[label=(\arabic*)]
\item Follows from the fact that $(x,t)\mapsto G_t(x-y)$ solves \eqref{heat_eq} $\forall x\in\mathbb{R}^n$, $t>0$ and the usual arguments to differentiate under the integral.

\item
\[G_t=\widetilde{G}_{\sqrt{2Dt}},\]
where
\[\widetilde{G}_{\epsilon}(x)=\frac{1}{\sqrt{2\pi\epsilon^2}^n}e^{-\frac{|x|^2}{2\epsilon^2}}.\]

$\widetilde{G}_{\epsilon}$ is a (non-compactly supported) mollifier:
\begin{itemize}
\item $\widetilde{G}_{\epsilon}(x)=\frac{1}{\epsilon^n}\widetilde{G}_1(\frac{x}{\epsilon})$;
\item $\widetilde{G}_1\geq0$;
\item $\widetilde{G}_1\in C^{\infty}$;
\item $\int_{\mathbb{R}^n}\widetilde{G}_1=1$;
\item all derivatives are integrable.
\end{itemize}

It can be shown that Lemma \ref{properties_mollifier} \ref{mollifier_conv_point} still holds (even though $\widetilde{G}_{\epsilon}$ is not compactly supported).
%Lemma 2.1 (e)
\[f^{\epsilon}=G_{\epsilon}*f\xrightarrow[\epsilon\to0]{}f.\]
Lemma \ref{properties_mollifier} \ref{mollifier_conv_point} implies the result.

\item Omitted.
\end{enumerate}
\end{proof}

\begin{theorem}
%Thm 3.3
\emph{\textbf{(Smoothing)}} The solution from Theorem \ref{th_sol_heat} is in $C^{\infty}(\mathbb{R}^n\times(0,\infty))$. In particular, $\forall t>0$, $u(\,\cdot\,,t)\in C^{\infty}(\mathbb{R}^n)$, even though $u(\,\cdot\,,0)=u_0$ can be any bounded continuous function!
\end{theorem}

\begin{proof}
Lemma \ref{properties_mollifier} \ref{mollifier_differentiable}.
\end{proof}

\begin{corollary}
%Corollary 3.1
\emph{\textbf{(Convergence to uniform temperature)}} If $u_0\in L^1$, then the solution from Theorem \ref{th_sol_heat} satisfies
\[\lim_{t\to\infty}u(x,t)=0\ \ \forall x\in\mathbb{R}^n.\]
\end{corollary}

\begin{proof}
\[\big|u(x,t)\big|=\left|\frac{1}{\sqrt{4\pi Dt}^n}\int_{\mathbb{R}^n}\underbrace{e^{-\frac{|x-y|^2}{4Dt}}}_{\leq1}u_0(y)\,dy\right|\leq\frac{1}{\sqrt{4\pi Dt}^n}\int_{\mathbb{R}^n}\big|u_0(y)\big|\,dy=\frac{||u_0||_{L^1}}{\sqrt{4\pi Dt}^n}\xrightarrow[t\to\infty]{}0.\]
\end{proof}

\begin{remark}
If the boundary condition $g$ is not $0$, then
\[u(x,t)=g+\big(G_t*(u_0-g)\big)(x)=g+\frac{1}{\sqrt{4\pi Dt}^n}\int_{\mathbb{R}^n}e^{-\frac{|x-y|^2}{4Dt}}\big(u_0(y)-g\big)\,dy\xrightarrow[t\to\infty]{}g,\]
as long as $u_0-g\in L^1$.
\end{remark}

Behaviour as $t\to\infty$ does \textbf{not} depend on the initial condition -- only on the boundary conditions.

\begin{proof}
(Fourier reconstruction formula: Theorem \ref{properties_FT} \eqref{Fourier_inverse})
\begin{equation}\tag{R}
f(x)=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\hat{f}(k)e^{ik\cdot x}\,dk,\ \text{ for a.e. }x\in\mathbb{R}^n.
\end{equation}

We will prove this in 3 steps:
\begin{enumerate}[label=(\arabic*)]
\item prove for $f$ a Gaussian;
\item prove for $f^{\epsilon}=G_{\epsilon}*f$;
\item take $\epsilon\to0$.
\end{enumerate}

\begin{enumerate}[label=\arabic*.]
\item\label{inverse_Gaussian} Take
\[f(x)=G_{\sigma}(x)=\frac{1}{\sqrt{2\pi\sigma^2}^n}e^{-\frac{|x|^2}{2\sigma^2}},\]
where $G_{\sigma}$ is not the same as $G_t$.

\begin{recall}
(Last lecture)
\[\mathcal{F}\Big[e^{-\frac{|x|^2}{2a^2}}\Big]=\sqrt{2\pi a^2}^ne^{-\frac{a^2|k|^2}{2}}.\]
\end{recall}
So,
\begin{align*}
\widehat{G}_{\sigma}(k)&=e^{-\frac{\sigma^2|k|^2}{2}},\\
\widehat{\widehat{G}}_{\sigma}(x)&=\sqrt{2\pi\left(\frac{1}{\sigma}\right)^2}^ne^{-\frac{|x|^2}{2\sigma^2}}.
\end{align*}

Doing the change of variable $l=-k$,
\begin{multline*}
\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\widehat{G}_{\sigma}(k)e^{ik\cdot x}\,dk=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}e^{-\frac{\sigma^2|k|^2}{2}}e^{ik\cdot x}\,dk=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}e^{-\frac{\sigma^2|l|^2}{2}}e^{-il\cdot x}\,dl\\
=\frac{1}{(2\pi)^n}\widehat{\widehat{G}}_{\sigma}(x)=\frac{1}{(2\pi)^n}\sqrt{2\pi\frac{1}{\sigma^2}}^ne^{-\frac{|x|^2}{2\sigma^2}}=\frac{1}{\sqrt{2\pi\sigma^2}^n}e^{-\frac{|x|^2}{2\sigma^2}}=G_{\sigma}(x).
\end{multline*}

\item\label{inverse_mollified} $f_{\epsilon}=G_{\epsilon}*f$, $f\in L^1$, $\hat{f}\in L^1$, $\epsilon>0$.

By Step \ref{inverse_Gaussian},
\[G_{\epsilon}(x-y)=(2\pi)^{-n}\int e^{i(x-y)\cdot k}\widehat{G}_{\epsilon}(k)\,dk.\]
Hence,
\begin{multline*}
(G_{\epsilon}*f)(x)=\int G_{\epsilon}(x-y)f(y)\,dy=(2\pi)^{-n}\int\int e^{i(x-y)\cdot k}\widehat{G}_{\epsilon}(k)f(y)\,dk\,dy\\
=(2\pi)^{-n}\int e^{ix\cdot k}\widehat{G}_{\epsilon}(k)\underbrace{\int e^{-iy\cdot k}f(y)\,dy}_{=\hat{f}(k)}dk\\
=(2\pi)^{-n}\int e^{ix\cdot k}\widehat{G}_{\epsilon}(k)\hat{f}(k)\,dk=(2\pi)^{-n}\int e^{ix\cdot k}\widehat{G_{\epsilon}*f}(k)\,dk.
\end{multline*}

\item From part \ref{inverse_mollified}:
\[(G_{\epsilon}*f)(x)=(2\pi)^{-n}\int_{\mathbb{R}^n}e^{ik\cdot x}\widehat{G}_{\epsilon}(k)\hat{f}(k)\,dk=(2\pi)^{-n}\int_{\mathbb{R}^n}e^{ik\cdot x}e^{-\frac{\epsilon^2|k|^2}{2}}\hat{f}(k)\,dk.\]

Take $\epsilon\to0$:
\begin{itemize}
\item by Lemma \ref{properties_mollifier}, but with non-compactly supported mollifier,
\[(G_{\epsilon}*f)(x)\xrightarrow[\epsilon\to0]{}f(x);\]
\item by dominated convergence theorem,
\[\int_{\mathbb{R}^n}e^{ik\cdot x}e^{-\frac{\epsilon^2|k|^2}{2}}\hat{f}(k)\,dk\xrightarrow[\epsilon\to0]{}\int_{\mathbb{R}^n}e^{ik\cdot x}\hat{f}(k)\,dk;\]
dominated convergence theorem applies because
\[\Big|e^{ik\cdot x}\underbrace{e^{-\frac{\epsilon^2|k|^2}{2}}}_{\leq1}\hat{f}(k)\Big|\leq\big|\hat{f}(k)\big|\in L^1(\mathbb{R}^n).\]
\end{itemize}

Thus,
\[f(x)=(2\pi)^{-n}\int_{\mathbb{R}^n}e^{ik\cdot x}\hat{f}(k)\,dk.\]
\end{enumerate}
\end{proof}

%14/06
\section{A weaker notion of solution}
%Section 4
\begin{motivation}
\begin{enumerate}[label=(\arabic*)]
\item Transport equation.
\[u_t+bu_x=0,\]
$u=u(x,t)\in C^1(\mathbb{R}\times\mathbb{R})$, $x,t\in\mathbb{R}$, $b\in\mathbb{R}$;
\[u(x,0)=u_0(x),\]
$\forall x\in\mathbb{R}$, $u_0$ given.

Solution formula: see Section \ref{transport_eq},
%\S 2
\[u(x,t)=u_0(x-bt).\]

Solution formula makes sense even when $u_0$ is not differentiable, say just in $L^1(\mathbb{R})$.

Does this $u$ satisfy the transport equation in some sense?

\item Poisson equation.
\[-\Delta u=f,\]
$u=u(x)$, $x\in\mathbb{R}^n$, $f$ given.

We showed that
\[\Phi(x)=\frac{1}{(n-2)\omega_n|x|^{n-2}}\]
satisfies
\[-\Delta\Phi=0\]
in $\mathbb{R}^n\setminus\{0\}$.

Does this $\Phi$ satisfy some form of the Poisson equation in $\mathbb{R}^n$?

Yes, in the notion of `weak solution' of a PDE. This notion revolutionized PDE theory; many ``hard'' solutions became ``easy''.
\end{enumerate}
\end{motivation}

\subsection*{Transport equation.}
\begin{equation}\tag{T}\label{transport_strong}
u_t+bu_x=0,
\end{equation}
$u=u(x,t)\in C^1(\mathbb{R}\times\mathbb{R})$, $b\in\mathbb{R}$ constant.
\begin{equation}\tag{IC}
u(x,0)=u_0(x),
\end{equation}
$\forall x\in\mathbb{R}$.

\begin{notation}
$C_0^{\infty}(\Omega)\coloneqq\{\varphi:\Omega\rightarrow\mathbb{R}\,|\,\varphi\text{ infinitely differentiable},\,\supp\varphi\text{ compact}\}$
\end{notation}

Functions in this space are called \textbf{test functions}.

\begin{idea}
Can multiply a PDE by a test function and integrate.
\end{idea}

\eqref{transport_strong} $u_t+bu_x=0$ | $\cdot\varphi\in C_0^{\infty}(\mathbb{R}\times\mathbb{R})$, $\int_{\mathbb{R}\times\mathbb{R}}dxdt$.
\[\int_{\mathbb{R}}\int_{\mathbb{R}}u_t\varphi+\int_{\mathbb{R}}\int_{\mathbb{R}}bu_x\varphi=0\]
Choose $R>0$, $T>0$ so large that $\varphi\equiv0$ outside $(-R,R)$ and $(-T,T)$.

\[\int_{\mathbb{R}}\int_{\mathbb{R}}u_t\varphi=\int_{\mathbb{R}}\left(\int_{-T}^Tu_t\varphi\,dt\right)dx=\underbrace{u\varphi\Big|_{-T}^T}_{=0}-\int_{-T}^Tu\varphi_t\,dt,\]
\[\int_{\mathbb{R}}\int_{\mathbb{R}}bu_x\varphi=\int_{\mathbb{R}}\left(\int_{-R}^Rbu_x\varphi\,dx\right)dt=\underbrace{bu\varphi\Big|_{-R}^R}_{=0}-\int_{-R}^Rbu\varphi_x\,dx.\]

The equation turns into
\begin{equation}\tag{T$'$}\label{transport_weak}
\int_{\mathbb{R}}\int_{\mathbb{R}}u(-\varphi_t-b\varphi_x)=0\ \ \forall\varphi\in C_0^{\infty}(\mathbb{R}\times\mathbb{R}).
\end{equation}

\begin{note}
LHS makes sense when $u\in L_{\text{loc}}^1(\mathbb{R}\times\mathbb{R})$.
\end{note}

\begin{definition*}
$u\in L_{\text{loc}}^1(\mathbb{R}\times\mathbb{R})$ is called a \textbf{weak solution} of the PDE \eqref{transport_strong} if it satisfies \eqref{transport_weak}.
\end{definition*}
\begin{question}How rich is \eqref{transport_weak}? Can we recover \eqref{transport_strong} from \eqref{transport_weak}?
\end{question}

\begin{proposition}\label{transport_weak_equivalence}
%Proposition 4.1
For $u\in C^1(\mathbb{R}\times\mathbb{R})$, $b\in\mathbb{R}$, the following are equivalent:
\begin{enumerate}[label=(\roman*)]
\item\label{transport_strong_equivalent} $u$ solves \eqref{transport_strong}, i.e., $u_t+bu_x=0$ in $\mathbb{R}\times\mathbb{R}$;
\item\label{transport_weak_equivalent} $u$ solves \eqref{transport_weak}.
\end{enumerate}
\end{proposition}

\begin{lemma}\label{calculus_variations}
%Lemma 4.1
\emph{\textbf{(Fundamental lemma of the calculus of variations)}} Let $\Omega\subseteq\mathbb{R}^n$ open, $u\in L_{\text{loc}}^1(\Omega)$. If $\int_{\Omega}u\varphi=0$ $\forall\varphi\in C_0^{\infty}(\Omega)$, then $u\equiv0$.
\end{lemma}

\begin{proof}
Only for $u$ continuous. Indirect: suppose $u\not\equiv0$. Then $\exists x_0\in\Omega$ such that $u(x_0)\neq0$. W.l.o.g. $u(x_0)>0$. Since $u$ is continuous, $\exists\epsilon>0$ such that $u>0$ in $B_{\epsilon}(x_0)$.

Choose $\varphi_{\epsilon}\in C^{\infty}(\mathbb{R}^n)$, $\varphi_{\epsilon}>0$ in $B_{\epsilon}(x_0)$, $\varphi_{\epsilon}=0$ outside $B_{\epsilon}(x_0)$. E.g., standard mollifier from Section \ref{Laplace_Poisson} will do. Then,
\[\int_{\Omega}u\varphi_{\epsilon}=\int_{B_{\epsilon}(x_0)}u\varphi_{\epsilon}>0.\ \text
\Lightning\]
\end{proof}

\begin{proof}
(Proposition \ref{transport_weak_equivalence})

``\ref{transport_strong_equivalent}$\Rightarrow$\ref{transport_weak_equivalent}'' Done.

``\ref{transport_strong_equivalent}$\Leftarrow$\ref{transport_weak_equivalent}'' Integrating by parts and by Lemma \ref{calculus_variations},
\[\text{\ref{transport_weak_equivalent}}\Longrightarrow\int_{\mathbb{R}}\int_{\mathbb{R}}(u_t+bu_x)\varphi=0\ \forall\varphi\in C_0^{\infty}(\mathbb{R}\times\mathbb{R})\Longrightarrow u_t+bu_x\equiv0\Longrightarrow\text{\ref{transport_strong_equivalent}}.\]
\end{proof}

Nice! For smooth $u$, weak solution $\Leftrightarrow$ classical solution.

\subsubsection*{Notion of weak solution for the initial value problem \textbf{\eqref{transport_weak_initial}}, \textbf{\eqref{initial_transport_weak}}.}
\begin{equation}\tag{T}\label{transport_weak_initial}
u_t+bu_x=0,
\end{equation}
$(x,t)\in\mathbb{R}\times[0,\infty)$;
\begin{equation}\tag{IC}\label{initial_transport_weak}
u(\,\cdot\,,0)=u_0.
\end{equation}
Multiply by $\varphi(x,t)\in C_0^{\infty}(\mathbb{R}\times[0,\infty))$ ($\varphi$ can be nonzero at $t=0$), $\int_0^{\infty}\int_{\mathbb{R}}dxdt$.

\[\int_{\mathbb{R}}\left(\int_0^{\infty}u_t\varphi\,dt\right)dx+\int_0^{\infty}\left(\int_{\mathbb{R}}bu_x\varphi\,dx\right)dt=0.\]

\[\int_0^{\infty}u_t\varphi\,dt=u\varphi\Big|_{t=0}^{\infty}-\int_0^{\infty}u\varphi_t\,dt=-u_0\varphi(\,\cdot\,,0)-\int_0^{\infty}u\varphi_t\,dt,\]
\[\int_{\mathbb{R}}bu_x\varphi\,dx=-\int_{\mathbb{R}}bu\varphi_x\,dx,\]

\begin{equation}\tag{$*$}\label{transport_weak_explicit}
-\int_{\mathbb{R}}u_0(x)\varphi(x,0)\,dx-\int_0^{\infty}\int_{\mathbb{R}}u(\varphi_t+b\varphi_x)\,dx\,dt=0\ \ \forall\varphi\in C_0^{\infty}\big(\mathbb{R}\times[0,\infty)\big).
\end{equation}

\begin{definition*}
$u\in C(\mathbb{R}\times[0,\infty))$ is called a weak solution to \eqref{transport_weak_initial}, \eqref{initial_transport_weak} if \eqref{transport_weak_explicit} holds.
\end{definition*}

\begin{remark}
(Technical) It is sufficient for the above definition that $u$ is in the space $C\big([0,\infty);L^1(\mathbb{R})\big)$, defined as
\[\Big\{u:\mathbb{R}\times[0,\infty)\rightarrow\mathbb{R}\,\Big|\,u\text{ measurable},u(\,\cdot\,,t)\in L^1(\mathbb{R})\ \forall t\in[0,\infty),\big|\big|u(\,\cdot\,,s)-u(\,\cdot\,,t)\big|\big|_{L^1(\mathbb{R})}\xrightarrow[s\to t]{}0\ \forall t\Big\}.\]

It is similar to being ``continuous in $t$ and integrable in $x$''.

Note that if $u_0\in L^1(\mathbb{R})$, then $u(x,t)\coloneqq u_0(x-bt)$ belongs to the above space.
\end{remark}

\begin{proposition}
%Prop. 4.2
For any $u_0\in L^1(\mathbb{R})$, $u(x,t)\coloneqq u_0(x-bt)$ is the unique weak solution to \eqref{transport_weak_initial}, \eqref{initial_transport_weak}.
\end{proposition}

\begin{proof}
Proof that $u$ is a weak solution to \eqref{transport_weak_initial}, \eqref{initial_transport_weak}, i.e., satisfies \eqref{transport_weak_explicit}.

For any $\varphi\in C_0^{\infty}(\mathbb{R}\times[0,\infty))$,
\begin{multline*}
\int\int\big(-\underbrace{\varphi_t}_{\mathclap{\partial_2\varphi}}(x,t)-b\underbrace{\varphi_x}_{\mathclap{\partial_1\varphi}}(x,t)\big)\underbrace{u(x,t)}_{\mathclap{u_0(x-bt)}}\,dx\,dt\\
\underset{y=x-bt}{=}\int\int\underbrace{\big(-\partial_2\varphi(y+bt,t)-b\partial_1\varphi(y+bt,t)\big)}_{=-\frac{d}{dt}\varphi(y+bt,t)}u_0(y)\,dy\,dt\\
=\int_{\mathbb{R}}\underbrace{\left(\int_0^{\infty}-\frac{d}{dt}\varphi(y+bt,t)\,dt\right)}_{=-(0-\varphi(y,0))}u_0(y)\,dy=\int_{\mathbb{R}}\varphi(y,0)u_0(y)\,dy,
\end{multline*}
i.e., \eqref{transport_weak_explicit}.

Proof of uniqueness. Suppose $u,\tilde{u}$ weak solutions to \eqref{transport_weak_initial}, \eqref{initial_transport_weak}. Then $v\coloneqq u-\tilde{u}$ is a weak solution to \eqref{transport_weak_initial}, \eqref{initial_transport_weak}$_0$.

\eqref{initial_transport_weak}$_0$: $v(x,0)=0$ $\forall x$.

Hence, since $v$ is a weak solution, i.e., satisfies \eqref{transport_weak_explicit},
\[0=\int_0^{\infty}\int_{\mathbb{R}}\underbrace{(\varphi_t+b\varphi_x)}_{\eqqcolon f(x,t)}v\ \ \forall\varphi\in C_0^{\infty}\big(\mathbb{R}\times[0,\infty)\big).\]

RTP: $v=0$.

\begin{idea}
Given $f\in C_0^{\infty}(\mathbb{R}\times[0,\infty))$, find $\varphi$ such that
\[\varphi_t+b\varphi_x=f(x,t),\]
(inhomogeneous transport equation).
\end{idea}

Can find a solution, see Sheet 1 Exercise 2. Quick derivation:
\[\varphi_t=-b\varphi_x+f(x,t)\]
ODEs
\[y'=Ay+f.\]
Variation of constants:
\[y(t)=e^{tA}y(0)+\int_0^te^{(t-s)A}f(s)\,ds.\]
``$A=-b\partial_x$''.

\[\varphi(\,\cdot\,,t)=e^{-tb\partial_x}\varphi(\,\cdot\,,0)+\int_0^te^{-(t-s)b\partial_x}f(\,\cdot\,,s)\,ds.\]

Taylor:
\[(e^{-tb\partial_x}h)(x)=\left(I-tb\partial_x+\frac{1}{2!}t^2b^2\partial_x^2-\frac{1}{3!}t^3b^3\partial_x^3\cdots\right)h(x)=h(x-bt).\]

\[\varphi(x,t)=\varphi(x-bt,0)+\int_0^tf\big(x-b(t-s),s\big)\,ds.\]

Can check that this really satisfies the PDE.

This $\varphi\in C_0^{\infty}(\mathbb{R}\times[0,\infty))$ if we choose the initial condition $\varphi(y,0)=-F(y)$, where
\[F(y)\coloneqq\int_0^Tf(y+bs,s)\,ds,\]
$T$ so large that $\supp f\subseteq\mathbb{R}\times[0,T]$, because then
\[\varphi(x-bt,0)+\int_0^tf(x-bt+bs,s)\,ds=\varphi(x-bt,0)+\underbrace{\int_0^Tf(x-bt+bs,s)\,ds}_{=F(x-bt)}=0\ \ \forall t\geq T.\]

Hence, by \eqref{transport_weak_explicit},
\[\int_0^{\infty}\int_{\mathbb{R}}fv=0 \ \ \forall f\in C_0^{\infty}\big(\mathbb{R}\times[0,\infty)\big).\]

By Lemma \ref{calculus_variations},
\[v\equiv0.\]
\end{proof}

%21/06
\subsection*{Notion of weak solution for Poisson's equation}
\begin{equation}\tag{P}\label{Poisson_future_weak}
-\Delta u=f
\end{equation}
in $\mathbb{R}^n$, $f\in C(\mathbb{R}^n)$ given, $u\in C^2(\mathbb{R}^n)$.

Same strategy as for transport equation: multiply PDE by a test function $\varphi\in C_0^{\infty}(\mathbb{R}^n)$ and integrate by parts to move all derivatives onto the test function:
\[\int_{\mathbb{R}^n}(-\Delta u)\varphi=\int_{\mathbb{R}^n}f\varphi.\]
Taking $R$ so large that $\supp\varphi\subseteq B_R$ and integrating by parts, we obtain:
\[\int_{\mathbb{R}}(-\underbrace{\Delta u}_{\mathclap{=\diver\nabla}})\varphi=\int_{B_R}-\Delta u\cdot\varphi=\int_{B_R}\nabla u\cdot\nabla\varphi=\int_{\mathbb{R}^n}\nabla u\cdot\nabla\varphi=\int_{\mathbb{R}^n}u(-\underbrace{\diver\nabla}_{\Delta}\varphi)=\int_{\mathbb{R}^n}u(-\Delta\varphi).\]

This motivates the following.

\begin{definition*}
\begin{enumerate}[label=\alph*)]
\item Let $u,f\in L_{\text{loc}}^1(\mathbb{R}^n)=\{g:\mathbb{R}^n\rightarrow\mathbb{R}\,|\,g\text{ measurable},\int_{B_R}|g|<\infty\ \forall R<\infty\}$. We say that $u$ is a \textbf{weak solution} to Poisson's equation \eqref{Poisson_future_weak} if
\begin{equation}\tag{P$'$}\label{Poisson_weak}
\int_{\mathbb{R}^n}u(-\Delta\varphi)=\int_{\mathbb{R}^n}f\varphi\ \ \forall\varphi\in C_0^{\infty}(\mathbb{R}^n).
\end{equation}

\item Let $u\in L_{\text{loc}}^1(\mathbb{R}^n)$, $\mu$ a measure on $\mathbb{R}^n$. We say that $u$ is a weak solution to
\begin{equation}\tag{P$_{\mu}$}\label{Poisson_measure}
-\Delta u=\mu
\end{equation}
in $\mathbb{R}^n$ if
\begin{equation}\tag{P$_{\mu}'$}\label{Poisson_measure_int}
\int_{\mathbb{R}^n}u(-\Delta\varphi)=\int_{\mathbb{R}^n}\varphi(x)\,d\mu(x)\ \ \forall\varphi\in C_0^{\infty}(\mathbb{R}^n)
\end{equation}
\end{enumerate}
\end{definition*}

\begin{example}
%Example 1
$\mu$ a weighted Lebesgue measure, $\mu=f\,dx$, $f\in L_{\text{loc}}^1(\mathbb{R}^n)$, $f\geq0$.

$\mu(A)=\int_Af$ $\forall A\subseteq\mathbb{R}^n$ Borel set.
\[\int_{\mathbb{R}^n}\varphi\,d\mu=\int_{\mathbb{R}^n}\varphi(x)f(x)\,dx,\]
so \eqref{Poisson_measure_int} = \eqref{Poisson_weak}.
\end{example}

\begin{example}
%Example 2
$\mu$ the Dirac measure (``delta function'' in physics and engineering).

Maths picture: $\mu=\delta_{x_0}$, $x_0\in\mathbb{R}^n$,
\[\mu(A)=\left\{\begin{array}{ll}1&\text{if }\,x_0\in A,\\0&\text{else},\end{array}\right.\ \ \forall A\subseteq\mathbb{R}^n\text{ Borel set}.\]
\[\int_{\mathbb{R}^n}\varphi\,d\mu=\varphi(x_0)\ \ \forall\varphi:\mathbb{R}^n\rightarrow\mathbb{R}\text{ continuous}.\]

Physics picture:
\[\delta_{x_0}(x)=\text{``}\lim_{\epsilon\to0}\text{''}\eta_{\epsilon}(x-x_0),\]
where $\int\eta_{\epsilon}=1$, $\eta_{\epsilon}$ more and more concentrated near $x_0$.

Maths example: $\eta>0$ standard mollifier, i.e., $\eta\geq0$, $\eta>0$ in $B_1(0)$, $\int\eta=1$, $\eta=0$ outside $B_1(0)$, $\eta_{\epsilon}(x)=\epsilon^{-n}\eta(\frac{x}{\epsilon})$.

Note that
\[\int_{\mathbb{R}^n}\varphi(x)\eta_{\epsilon}(x-x_0)\,dx\xrightarrow[\epsilon\to0]{}\varphi(x_0)=\int_{\mathbb{R}^n}\varphi\,d\mu.\]
In this case,
\[\text{\eqref{Poisson_measure_int}}\Longleftrightarrow\int_{\mathbb{R}^n}u(-\Delta\varphi)=\varphi(x_0)\ \ \forall\varphi\in C_0^{\infty}(\mathbb{R}^n).\]
\end{example}

\begin{proposition}\label{Poisson_iff_weak}
%Prop. 4.3
For $u\in C^2(\mathbb{R}^n)$, $f\in C(\mathbb{R}^n)$, the following are equivalent:
\begin{enumerate}[label=(\roman*)]
\item\label{solve_Poisson} $u$ solves \eqref{Poisson_future_weak}, i.e., $-\Delta u(x)=f(x)$ $\forall x\in\mathbb{R}^n$;
\item\label{solve_Poisson_weak} $u$ solves \eqref{Poisson_weak}, i.e., $u$ is a \textbf{weak solution to \eqref{Poisson_future_weak}}.
\end{enumerate}
\end{proposition}

\begin{proof}
\ref{solve_Poisson} $\Rightarrow$ \ref{solve_Poisson_weak}: already done.

\ref{solve_Poisson_weak} $\Rightarrow$ \ref{solve_Poisson}: suppose $u$ satisfies \eqref{Poisson_weak} but \eqref{Poisson_future_weak} fails. Then $\exists x_0\in\mathbb{R}^n$ such that $-\Delta u(x_0)-f(x_0)\neq0$, say $>0$.

Choose $\epsilon$ so small that $-\Delta u(x)-f(x)>0$ in $B_{\epsilon}(x_0)$. Choose $\varphi_{\epsilon}\in C_0^{\infty}(\mathbb{R}^n)$ such that $\varphi_{\epsilon}>0$ in $B_{\epsilon}(x_0)$. Then,
\[\int_{\mathbb{R}^n}u(x)\big(-\Delta\varphi_{\epsilon}(x)\big)\,dx-\int_{\mathbb{R}^n}f(x)\varphi(x)\,dx\underset{\text{parts}}{=}\int_{\mathbb{R}^n}\big(-\Delta u(x)-f(x)\big)\varphi_{\epsilon}(x)\,dx>0.\]
\Lightning\  to \eqref{Poisson_weak}.
\end{proof}

\begin{theorem}\label{Laplace_sol_review}
%Theorem 4.1
\emph{\textbf{(Fundamental solution to Laplace's equation, revisited)}} Let
\[\Phi(x)=\left\{\begin{array}{ll}\displaystyle{-\frac{1}{2\pi}\log|x|}&n=2,\\\displaystyle{\frac{1}{(n-2)\omega_n|x|^{n-2}}}&n\geq3.\end{array}\right.\]

\begin{enumerate}[label=\alph*)]
\item $\Phi$ is a weak solution to
\begin{equation}\tag{P$_{\delta_0}$}\label{Poisson_Dirac}
-\Delta\Phi=\delta_0
\end{equation}
in $\mathbb{R}^n$.

\item $\Phi$ is the unique weak solution to \eqref{Poisson_Dirac} subject to the boundary condition
\[\Phi(x)\xrightarrow[|x|\to\infty]{}0\]
when $n\geq3$.
\end{enumerate}
\end{theorem}

Famous special case: $n=3$,
\[-\Delta\frac{1}{4\pi|\,\cdot\,|}=\delta_0\text{ in }\mathbb{R}^3.\]

\begin{proof}
\begin{enumerate}[label=\alph*)]
\item By the definition of weak solutions to \eqref{Poisson_measure}, need to show that
\begin{equation}\tag{P$_{\delta_0}'$}\label{Poisson_Dirac_int}
\int_{\mathbb{R}^n}\big(\underbrace{-\Delta\varphi(x)}_{\eqqcolon g(x)}\big)\Phi(x)\,dx=\varphi(0)\ \ \forall\varphi\in C_0^{\infty}(\mathbb{R}^n).
\end{equation}
Then $g$ solves
\begin{equation}\tag{P}\label{Poisson_eq_BC}
\left\{\begin{array}{ll}-\Delta\varphi=g&\text{in }\mathbb{R}^n,\\\varphi(x)\rightarrow0&(|x|\to\infty).\end{array}\right.
\end{equation}

By the solution formula for \eqref{Poisson_eq_BC} (Theorem \ref{Poisson_sol}) and its uniqueness (Theorem \ref{Poisson_unique}),
\[\varphi(x)=\int_{\mathbb{R}^n}\Phi(x-y)g(y)\,dy,\]
\[\varphi(0)=\int_{\mathbb{R}^n}\underbrace{\Phi(0-y)}_{\Phi(y)}\underbrace{g(y)}_{\mathclap{-\Delta\varphi(y)}}dy,\]
i.e., \eqref{Poisson_Dirac_int}. (Magic!)

\textbf{Summary of magic proof.}

\begin{itemize}
\item Take the formula for reconstructing the test function $\varphi$ from its Laplacian ($-\Delta\varphi$).

\item Evaluate at $x=0$.

\item Then you get the required identity \eqref{Poisson_Dirac_int} for $\Phi$ to be a weak solution to $-\Delta\Phi=\delta_0$ with test function $\varphi$.
\end{itemize}

\item Special case of definition of weak solution to \eqref{Poisson_future_weak} $-\Delta u=f$ when $f=0$.
\end{enumerate}
\end{proof}

\begin{definition*}
$u\in L_{\text{loc}}^1(\mathbb{R}^n)$ is a weak solution to $-\Delta u=0$ (i.e., $u$ is ``weakly harmonic'') if
\[\int_{\mathbb{R}^n}u(-\Delta\varphi)=0\ \ \forall\varphi\in C_0^{\infty}(\mathbb{R}^n).\]
\end{definition*}

\begin{lemma}\label{mollified_weak_harmonic}
%Lemma 4.2
$u\in L_{\text{loc}}^1(\mathbb{R}^n)$ weakly harmonic. Then $\eta_{\epsilon}*u$ is weakly harmonic, where $\eta_{\epsilon}(x)=\epsilon^{-n}\eta(\frac{x}{\epsilon})$, $\eta$ the standard mollifier.
\end{lemma}

\begin{proof}
By a direct calculation,
\[\int_{\mathbb{R}^n}u_{\epsilon}\Delta\varphi=\int_{\mathbb{R}^n}u\Delta(\underbrace{\eta_{\epsilon}^-*\varphi}_{\mathclap{\in C_0^{\infty}(\mathbb{R}^n)}}),\]
where $\eta_{\epsilon}^-(x)\coloneqq\eta_{\epsilon}(-z)$, hence RHS = 0.
\end{proof}

\begin{proof}
(Theorem \ref{Laplace_sol_review})
\begin{enumerate}[label=\alph*)]
\setcounter{enumi}{1}
\item Continued. Suppose $v_1,v_2$ two weak solutions to $-\Delta v_i=\delta_0$, $v_i(x)\xrightarrow[|x|\to\infty]{}0$.

Let $v\coloneqq v_1-v_2$, a weak solution to $-\Delta v=0$, $v(x)\xrightarrow[|x|\to\infty]{}0$.

By Lemma \ref{mollified_weak_harmonic}, $\eta_{\epsilon}*v\in C^{\infty}(\mathbb{R}^n)$ is also a weak solution.

By Proposition \ref{Poisson_iff_weak}, $\eta_{\epsilon}*v$ is a classical solution.

Uniqueness for classical solutions (Theorem \ref{Poisson_unique}) implies $\eta_{\epsilon}*v\equiv0$.

But $\eta_{\epsilon}*v\xrightarrow[\epsilon\to0]{}v$ a.e. Hence, $v\equiv0$ a.e.
\end{enumerate}
\end{proof}

\subsubsection*{Heuristic derivation of equation $\boldsymbol{-\Delta\Phi=\delta_0}$ in physics/engineering literature.}
$\delta_0(x)\approx\eta_{\epsilon}(x)$, $\eta_{\epsilon}(x)=\epsilon^{-n}\eta(\frac{x}{\epsilon})$, $\int\eta_{\epsilon}=\int\eta=1$, $\eta\geq0$, $\eta_{\epsilon}=0$ outside $B_{\epsilon}(0)$.

Consider, instead of
\begin{equation}\tag{P$_{\delta_0}$}\label{Poisson_Dirac_physics}
-\Delta u=\delta_0,
\end{equation}
the classical PDE
\begin{equation}\tag{P$_{\epsilon}$}\label{Poisson_mollified}
-\Delta u_{\epsilon}=\eta_{\epsilon}
\end{equation}

By solution formula for Poisson and its uniqueness (Theorem \ref{Poisson_sol} and Theorem \ref{Poisson_unique}),
\[u_{\epsilon}(x)=\int_{\mathbb{R}^n}\Phi(x-y)\eta_{\epsilon}(y)\,dy.\]

Now let $\epsilon\to0$ and
\begin{itemize}
\item assume solution to \eqref{Poisson_mollified} converges to that of \eqref{Poisson_Dirac_physics};
%(\hyperref[Poisson_mollified]{P$_0$})
\item pass to limit in RHS under the integral sign.
\end{itemize}
This ``implies'' (not rigorously)
\[u(x)=\int_{\mathbb{R}^n}\Phi(x-y)\delta_0(y)\,dy=\Phi(x).\]

%23/06
\section{Sobolev spaces}\label{Sobolev_spaces}
%Section 5
\begin{goal}
Provide proper setting in which methods from functional analysis can be applied to PDEs.
\end{goal}

\begin{recall}
Functional-analytic viewpoint.

Classical: function $u:\Omega\subseteq\mathbb{R}^n\rightarrow\mathbb{R}$, graph: collection of pointwise values, Poisson's equation: $-\Delta u(x)=f(x)$ $\forall x\in\Omega$.

Functional-analytic (modern): single point in an infinite-dimensional vector space $X$, $Au=b$, $u\in X$ ($b\in Y$ given, $A:X\rightarrow Y$ linear operator).
\end{recall}

Here: $A=\Delta$ i.e., $(Au)(x)=\Delta u(x)$ $\forall x$. Looks like linear algebra: $Ax=b$, $x\in\mathbb{R}^l$, $A\in\mathbb{R}^{m\times l}$, $b\in\mathbb{R}^m$.

Good choice of $X$ and $Y$ important. Must reflect the fact that in equation $-\Delta u=f$, $u$ has 2 more derivatives than $f$. The right spaces are called Sobolev spaces. Based on 3 ideas:
\begin{itemize}
\item specify \# of derivatives functions must have: $k\in\mathbb{N}$;
\item use ``weak derivatives'': $v=\frac{\partial u}{\partial x_i}$ if $v$ is a weak solution to this equation;
\item measure size of functions and its (weak) derivatives in $L^p$, $p\in[1,\infty]$, i.e., in an integral norm.
\end{itemize}

Informal definition:
\[W^{k,p}(U)=\{u:U\rightarrow\mathbb{R}\,|\,u\text{ has weak derivatives up to order }k,u\text{ and these derivatives are in }L^p(U)\}.\]

Standard choice for $-\Delta u=f$: $u\in W^{2,p}(U)=X$, $f\in L^p(U)=Y$.

In Section \ref{Poisson_general} we'll use this to prove existence and uniqueness for Poisson's equation in general domains $U$.

\setcounter{subsection}{-1}
\subsection[Revision of \texorpdfstring{$L^p$}{L\textasciicircum p} spaces]{Revision of \texorpdfstring{$\boldsymbol{L^p}$}{L\textasciicircum p} spaces}
%Subsection 5.0
Let $U\subseteq\mathbb{R}^n$ measurable, $1\leq p\leq\infty$.
\[L^p(U)\coloneqq\{u:U\rightarrow\mathbb{R}\,|\,u\text{ measurable},||u||_p<\infty\},\]
where
\[||u||_p\coloneqq\left\{\begin{array}{cl}\displaystyle{\left(\int_U|u|^p\right)^{1/p}}&1\leq p<\infty,\vspace{2mm}\\\displaystyle{\esssup_U|u|=\inf\{C\in\mathbb{R}\,|\,|u(x)|\leq C\text{ for a.e. }x\in U\}}&p=\infty.\end{array}\right.\]

Properties under addition and multiplication of functions:
\begin{itemize}
\item $L^p(U)$ vector space, $||\,\cdot\,||_p$ is a norm on $L^p(U)$ provided we identify two functions which agree a.e.; in particular,
\begin{equation}\tag{Minkowski's inequality}
||u+v||_p\leq||u||_p+||v||_p;
\end{equation}
\item $u\in L^p(U)$, $v\in L^{p'}(U)$ where $\frac{1}{p}+\frac{1}{p'}=1$, then $uv\in L^1(U)$ and
\begin{equation}\tag{H\"{o}lder's inequality}
||uv||_1=\int_U|uv|\leq||u||_p||v||_{p'};
\end{equation}
\item $L^p(U)$ is a Banach space (i.e., all Cauchy sequences are convergent).
\end{itemize}

Space of functions which are ``locally in $L^p$'':
\[L_{\text{loc}}^p(U)\coloneqq\big\{u:U\rightarrow\mathbb{R}\,\big|\,u\text{ measurable},\big|\big|u|_K\big|\big|_p<\infty\ \forall K\subseteq U\text{ compact}\big\}.\]

\subsection{Weak derivatives}
%Subsection 5.1
\begin{definition}
%Def. 5.1
\textbf{(Weak derivative)} Let $U\subseteq\mathbb{R}^n$ be open. Let $u,v\in L_{\text{loc}}^1(U)$, $\alpha=(\alpha_1,\ldots,\alpha_n)\in(\mathbb{N}\cup\{0\})^n$ multiindex of order $|\alpha|=\alpha_1+\cdots+\alpha_n$. Denote
\[D^{\alpha}\coloneqq\frac{\partial^{\alpha_1}}{\partial x_1^{\alpha_1}}\cdots\frac{\partial^{\alpha_n}}{\partial x_n^{\alpha_n}}.\]

We say that $v$ is the $\alpha$\textsuperscript{th} weak partial derivative of $u$, written $D^{\alpha}u=v$, if
\begin{equation}\tag{$*$}\label{weak_derivative}
\int_UuD^{\alpha}\varphi=(-1)^{|\alpha|}\int_Uv\varphi\ \ \forall\varphi\in C_0^{\infty}(U).
\end{equation}
\eqref{weak_derivative} says that $v$ is a weak solution to the PDE $D^{\alpha}u=v$.
\end{definition}

\begin{remark}
Suppose $u$ is $|\alpha|$ times classically differentiable, $v\coloneqq D^{\alpha}u$. Then \eqref{weak_derivative} holds, i.e., ``classical derivative is equal to the weak derivative''.
\end{remark}

\begin{proof}
$D^{\alpha}u=v$. Integrating by parts $|\alpha|$ times,
\[\int_Uv\varphi=\int_U(D^{\alpha}u)\varphi=(-1)^{|\alpha|}\int_UuD^{\alpha}\varphi.\]
\end{proof}

\begin{lemma}
%Lemma 5.1
\emph{\textbf{(Uniqueness)}} A weak $\alpha$\textsuperscript{th} partial derivative, if it exists, is unique (up to a set of measure 0).
\end{lemma}

\begin{proof}
Suppose $v$, $\tilde{v}$ $\alpha$\textsuperscript{th} weak partial derivatives of $u$. Then, $\forall\varphi\in C_0^{\infty}(U)$
\begin{align*}
\int_UuD^{\alpha}\varphi&=(-1)^{|\alpha|}\int_Uv\varphi,\\
\int_UuD^{\alpha}\varphi&=(-1)^{|\alpha|}\int_U\tilde{v}\varphi,\\
0&=\int_U(v-\tilde{v})\varphi
\end{align*}

Choose $\varphi(y)=\eta_{\epsilon}(x-y)$, $\eta_{\epsilon}(z)=\epsilon^{-n}\eta(\frac{z}{\epsilon})$, $\eta$ standard mollifier. Then,
\[0=\big(\eta_{\epsilon}*(v-\tilde{v})\big)(x)\xrightarrow[\text{Lemma \ref{properties_mollifier}}]{}(v-\tilde{v})(x)\text{ for a.e. }x.\]
Thus, $v-\tilde{v}=0$ a.e.
\end{proof}

\subsection{Definition of Sobolev spaces}
%Subsection 5.2
\begin{definition}
%Def. 5.2
\textbf{(Sobolev spaces)} Let $U\subseteq\mathbb{R}^n$ open, $1\leq p\leq\infty$, $k\in\mathbb{N}\cup\{0\}$. The Sobolev space
\[W^{k,p}(U)\]
consists of all functions $u\in L_{\text{loc}}^1(U)$ such that for each multiindex $\alpha\in(\mathbb{N}\cup\{0\})^n$ of order $0\leq|\alpha|\leq k$, the $\alpha$\textsuperscript{th} weak partial derivative of $u$ exists and belongs to $L^p(U)$, with the convention $D^0u=u$. We endow $W^{k,p}(U)$ with the norm
\[||u||_{W^{k,p}}\coloneqq\left\{\begin{array}{cc}\displaystyle{\left(\sum_{0\leq|\alpha|\leq k}||D^{\alpha}u||_p^p\right)^{1/p}}&1\leq p<\infty,\\\\\displaystyle{\sum_{0\leq|\alpha|\leq k}||D^{\alpha}u||_{\infty}}&p=\infty.\end{array}\right.\]

As for $L^p(U)$, we identify functions in $W^{k,p}(U)$ which coincide a.e.
\end{definition}

\begin{proposition}
%Prop. 5.1
$W^{k,p}(U)$ is a vector space and $||\,\cdot\,||_{W^{k,p}}$ is a norm.
\end{proposition}

\begin{proof}
Vector space: because $L^p(U)$ is a vector space and weak derivatives are linear, i.e., if $u$ and $v$ have an $\alpha$\textsuperscript{th} partial derivative $D^{\alpha}u$ respectively $D^{\alpha}v$, then $\lambda u+\mu v$ has an $\alpha$\textsuperscript{th} partial derivative, namely $\lambda D^{\alpha}u+\mu D^{\alpha}v$.

Norm:
\begin{itemize}
\item positivity: $||u||_{W^{k,p}}=0\Rightarrow||D^0u||_p=||u||_p=0\Rightarrow u=0$;
\item homogeneity: trivial;
\item triangle inequality: from triangle inequality for $L^p$.
\end{itemize}
\end{proof}

\setcounter{example}{0}
\begin{example}
$n=1$, $U=(0,2)$, $u$ has a kink;
\begin{align*}
u(x)&=\left\{\begin{array}{ll}x&0<x\leq1,\\1&1\leq x<2;\end{array}\right.\\
v(x)&=\left\{\begin{array}{ll}1&0<x\leq1,\\0&1\leq x<2.\end{array}\right.
\end{align*}

\begin{center}
\begin{tikzpicture}[scale=4]
\newcommand{\exc}{0.2}
\newcommand{\sep}{0.05}
\coordinate (kink) at (1.3,0.8);

\draw (0,0) -- (1,1);
\draw (1,1) -- (2,1);
\draw (-\exc,0) -- (2+\exc,0);
\draw [dash pattern=on 4pt off 4pt] (1,0) -- (1,1);
\draw [above left] (1/2,1/2) node {$u$};
\draw [->] (kink) -- (1+\sep,1-\sep);
\draw [below right] (kink) node {kink};
\draw [below] (0,0) node {$0$};
\draw [below] (1,0) node {$1$};
\draw [below] (2,0) node {$2$};
\end{tikzpicture}
\end{center}

\begin{center}
\begin{tikzpicture}[scale=4]
\newcommand{\exc}{0.2}
\newcommand{\tickw}{0.025}

\draw (0,1) -- (1,1);
\draw [color=gray] (-\exc,0) -- (2+\exc,0);
\draw (1,0) -- (2,0);
\draw [dash pattern=on 4pt off 4pt] (1,0) -- (1,1);
\draw [below] (1/2,1) node {$v$};
\draw (0,-\tickw) -- (0,\tickw);
\draw [below] (0,-\tickw) node {$0$};
\draw [below] (1,-\tickw) node {$1$};
\draw [below] (2,-\tickw) node {$2$};
\end{tikzpicture}
\end{center}

\begin{claim*}
$v$ is the weak derivative of $u$, i.e., $u'=v$ in the weak sense.
\end{claim*}

\begin{proof}
Need to show:
\[\int_0^2u\varphi'=-\int_0^2v\varphi\ \ \forall\varphi\in C_0^{\infty}((0,2)).\]

Calculate
\begin{multline*}
\int_0^2u\varphi'=\int_0^1u\varphi'+\int_1^2u\varphi'\underset{\text{def of }u}{=}\int_0^1x\varphi'(x)\,dx+\int_1^21\cdot\varphi'(x)\,dx=x\varphi(x)\Big|_0^1-\int_0^11\cdot\varphi(x)\,dx+\varphi(x)\Big|_1^2\\
=1\cdot\varphi(1)-0-\int_0^1\varphi+0-\varphi(1)=-\int_0^11\cdot\varphi-\int_1^20\cdot\varphi=-\int_0^2v\cdot\varphi.
\end{multline*}
\end{proof}
\end{example}

\begin{example}
$U=(0,2)$, $u$ has a jump;
\[u(x)=\left\{\begin{array}{ll}x&0<x\leq1,\\2&1<x<2.\end{array}\right.\]

\begin{claim*}
$u$ does not have a weak derivative.
\end{claim*}

\begin{proof}
Need to show there does not exist any $v\in L_{\text{loc}}^1((0,2))$ such that
\[\int_0^2u\varphi'=-\int_0^2v\varphi\ \ \forall\varphi\in C_0^{\infty}((0,2)).\]

Suppose otherwise. Then,
\begin{multline*}
-\int_0^2v\varphi=\int_0^2u\varphi'=\int_0^1x\varphi'(x)\,dx+\int_1^22\varphi'(x)\,dx=x\varphi(x)\Big|_0^1-\int_0^11\cdot\varphi(x)\,dx+2\varphi(x)\Big|_1^2\\
=\varphi(1)-0-\int_0^1\varphi-2\varphi(1)=-\int_0^1\varphi-\varphi(1).
\end{multline*}

Now the $\varphi(1)$ terms don't cancel.

\begin{idea}
Choose $\varphi_m$ such that $\varphi_m(1)=1$, $0\leq\varphi_m\leq1$, $\varphi_m(x)\rightarrow0$ $\forall x\neq1$.
\end{idea}
\[0\longleftarrow-\int_0^2v\varphi_m=-\int_0^1\varphi_m-\varphi_m(1)\longrightarrow0-1.\ \text{\Lightning}\]
\end{proof}
\end{example}

%28/06
\begin{example*}
\[W^{1,p}(U)=\left\{u\in L^p(U):\text{ the weak partial derivatives }\frac{\partial u}{\partial x_1},\ldots,\frac{\partial u}{\partial x_n}\text{ exist and belong to }L^p(U)\right\}\]
\end{example*}

Plan:
\begin{itemize}[label=$-$]
\item calculus side of $W^{k,p}$,
\item functional analysis side of $W^{k,p}$,
\item applications (i.e., solving PDEs).
\end{itemize}

\subsection{Basic properties of Sobolev spaces}
%Subsection 5.3
\begin{theorem}\label{Sobolev_calculus}
%Thm 5.1
\emph{\textbf{(Calculus in Sobolev spaces)}} Suppose $\Omega\subseteq\mathbb{R}^n$ open, $u,v\in W^{k,p}(\Omega)$, $|\alpha|\leq k$.
\begin{enumerate}[label=(\roman*)]
\item\label{Sobolev_calculus_Schwarz} (Weak Schwarz) $D^{\alpha}u\in W^{k-|\alpha|,p}(\Omega)$ and
\[D^{\alpha}(D^{\beta}u)=D^{\beta}(D^{\alpha}U)=D^{\alpha+\beta}u\]
$\forall$ multiindices $|\alpha|+|\beta|\leq k$.

\item\label{Sobolev_calculus_linearity} (Linearity) $\forall\lambda,\mu\in\mathbb{R}$ $\lambda u+\mu v\in W^{k,p}(\Omega)$ and $D^{\alpha}(\lambda u+\mu v)=\lambda D^{\alpha}u+\mu D^{\alpha}v$.

\item\label{Sobolev_calculus_restriction} (Restriction) $\Omega'\subseteq\Omega$ open, then $u|_{\Omega'}\in W^{k,p}(\Omega')$.

\item\label{Sobolev_calculus_product} (Product rule) If $\psi\in C_0^{\infty}(\Omega)$, then $\psi u\in W^{k,p}(\Omega)$ and
\begin{equation}\tag{Leibnitz rule}
D^{\alpha}(\psi u)=\sum_{\beta\leq\alpha}\binom{\alpha}{\beta}D^{\beta}\psi D^{\alpha-\beta}u,
\end{equation}
where
\[\binom{\alpha}{\beta}=\frac{\alpha!}{\beta!(\alpha-\beta)!},\hspace{5mm}\alpha!=\prod_{i=1}^n\alpha_i!.\]
\end{enumerate}
\end{theorem}

\textbf{Important special cases of \ref{Sobolev_calculus_Schwarz} and \ref{Sobolev_calculus_product}.}
\begin{enumerate}[label=(\roman*)]
\item If $|\alpha|=1$, then $D^{\alpha}u=\frac{\partial u}{\partial x_i}$ for some $i\in\{1,\ldots,n\}$.

If $u\in W^{2,p}(\Omega)$, then $\frac{\partial u}{\partial x_i}\in W^{1,p}(\Omega)$ and
\[\frac{\partial}{\partial x_j}\left(\frac{\partial}{\partial x_i}u\right)=\frac{\partial}{\partial x_i}\left(\frac{\partial}{\partial x_j}u\right).\]

\begin{note}
This is \textbf{not} always true for classical derivatives. For classical derivatives, we need extra assumptions for this to be true (e.g., continuity of the $2$\textsuperscript{nd} partial derivatives).

In this sense, weak derivatives are \textbf{better} than classical derivatives.
\end{note}

\setcounter{enumi}{3}
\item If $u\in W^{1,p}(\Omega)$ and $\psi\in C_0^{\infty}(\Omega)$, then $\psi u\in W^{1,p}(\Omega)$ and
\[\frac{\partial}{\partial x_i}(\psi u)=\left(\frac{\partial}{\partial x_i}\psi\right)u+\psi\frac{\partial}{\partial x_i}u.\]
\end{enumerate}

\begin{proof}
(Theorem \ref{Sobolev_calculus}) \ref{Sobolev_calculus_linearity}, \ref{Sobolev_calculus_restriction} follow straight forwardly from the definitions.
\begin{enumerate}[label=(\roman*)]
\item Let $\phi\in C_0^{\infty}(\Omega)$.
\begin{multline*}
\int_{\Omega}D^{\beta}(D^{\alpha}u)\phi\,dx=(-1)^{|\beta|}\int_{\Omega}D^{\alpha}uD^{\beta}\phi\,dx=(-1)^{|\alpha|+|\beta|}\int_{\Omega}uD^{\alpha}(D^{\beta}\phi)\,dx\\
\underset{\text{Schwarz}}{=}(-1)^{|\alpha|+|\beta|}\int_{\Omega}uD^{\beta}(D^{\alpha}\phi)\,dx=(-1)^{|\alpha|}\int_{\Omega}D^{\beta}uD^{\alpha}\phi\,dx\\
=\int_{\Omega}D^{\alpha}(D^{\beta}u)\phi\,dx\underset{\text{Schwarz}}{=}\underbrace{(-1)^{|\alpha|+|\beta|}}_{=(-1)^{|\alpha+\beta|}}\int_{\Omega}uD^{\alpha+\beta}\phi\,dx=\int_{\Omega}D^{\alpha+\beta}u\phi\,dx.
\end{multline*}
Since the terms are equal $\forall\phi\in C_0^{\infty}(\Omega)$, Lemma \ref{calculus_variations} implies that
\[D^{\beta}(D^{\alpha}u)=D^{\alpha}(D^{\beta}u)=D^{\alpha+\beta}u\text{ a.e.}\]

\item We will show the case $k=1$, $|\alpha|=1$ (i.e., $D^{\alpha}=\frac{\partial}{\partial x_i}$). [The general case follows by induction.]

Let $u\in W^{1,p}(\Omega)$, $\psi\in C_0^{\infty}(\Omega)$. We need to show two things:
\begin{enumerate}[label=(\alph*)]
\item $\psi u\in W^{1,p}(\Omega)$,
\item $\partial_i(\psi u)=\psi\partial_iu+u\partial_i\psi$.
\end{enumerate}
\begin{proof}
\begin{enumerate}[label=(\alph*)]
\setcounter{enumii}{1}
\item We want to show that $\psi\partial_iu+u\partial_i\psi$ is the weak derivative of $\psi u$.
%(b)

\begin{idea}
$\phi,\psi\in C_0^{\infty}(\Omega)\Rightarrow\phi\psi\in C_0^{\infty}(\Omega)$, so use $\phi\psi$ as a test function in the definition of the weak derivative of $u$.
\end{idea}

\begin{multline*}
\int_{\Omega}\partial_iu(\psi\phi)\,dx=-\int_{\Omega}u\partial_i(\psi\phi)\,dx=-\int_{\Omega}u\big[\psi\partial_i\phi+\phi\partial_i\psi\big]\,dx\\
=-\int_{\Omega}u\psi\partial_i\phi\,dx-\int_{\Omega}(u\partial_i\psi)\phi\,dx.
\end{multline*}
Therefore,
\[\int_{\Omega}\big[\psi\partial_iu+u\partial_i\psi\big]\phi\,dx=-\int_{\Omega}(\psi u)\partial_i\phi\,dx\ \ \forall\phi\in C_0^{\infty}(\Omega).\]
So, by definition of weak derivative of $\psi u$,
\begin{equation}\tag{$*$}\label{product_rule}
\partial_i(\psi u)=\psi\partial_iu+u\partial_i\psi.
\end{equation}

\setcounter{enumii}{0}
\item
%(a)
\[||\psi u||_{L^p(\Omega)}=\left(\int_{\Omega}|\psi u|^p\,dx\right)^{1/p}\leq||\psi||_{L^{\infty}(\Omega)}\left(\int|u|^p\,dx\right)^{1/p}=||\psi||_{L^{\infty}(\Omega)}||u||_{L^p(\Omega)}<\infty.\]

Hence, $\psi u\in L^p(\Omega)$.

Since $\frac{\partial u}{\partial x_i}\in L^p(\Omega)$ and $\frac{\partial\psi}{\partial x_i}\in C_0^{\infty}(\Omega)$, we can use the same argument to show $\psi\frac{\partial u}{\partial x_i}$ and $u\frac{\partial\psi}{\partial x_i}$ are in $L^p(\Omega)$.

Therefore, the RHS of \eqref{product_rule} is in $L^p(\Omega)$, so the LHS must also be.
\end{enumerate}
\end{proof}
\end{enumerate}
\end{proof}

\begin{theorem}\label{Sobolev_Banach}
%Thm 5.2
$W^{k,p}(U)$ is a Banach space.
\end{theorem}

\begin{recall}
A Banach space is a \textbf{complete} normed space.

Complete means that every Cauchy sequence converges in the space.
\end{recall}

\begin{recall}
From Exercise sheet 8, $W^{k,p}(U)$ is \textbf{not} a Banach space with the $L^p$-norm.

In order to make $W^{1,p}(U)$ a Banach space, it is important that we use the $W^{1,p}$-norm!
\end{recall}

\begin{proof}
(Theorem \ref{Sobolev_Banach}) Let $\{u^{(n)}\}_{n=1}^{\infty}$ be a Cauchy sequence in $W^{k,p}(U)$. We want to show that $\exists u\in W^{k,p}(U)$ such that $u^{(n)}\rightarrow u$ in $W^{k,p}(U)$.

\begin{enumerate}[label=\arabic*.]
\item\label{convergence_each_derivative} For each $|\alpha|\leq k$, $\{D^{\alpha}u^{(n)}\}_{n=1}^{\infty}$ is Cauchy in $L^p(U)$. Since $L^p$ is complete, $\exists u_{\alpha}\in L^p(U)$ such that
\[D^{\alpha}u^{(n)}\longrightarrow u_{\alpha}\text{ in }L^p(U).\]
In particular,
\[u^{(n)}\longrightarrow u_{(0,\ldots,0)}\eqqcolon u\text{ in }L^p(U).\]

\item\label{derivative_limit_commute} We want to show that
\[D^{\alpha}u=u_{\alpha}\ \ \forall|\alpha|\leq k.\]
We show this using the definition of weak derivative:
\[\int_UuD^{\alpha}\phi\,dx\underset{\text{DCT}}{=}\lim_{n\to\infty}\int_Uu^{(n)}D^{\alpha}\phi\,dx=\lim_{n\to\infty}(-1)^{|\alpha|}\int_UD^{\alpha}u^{(n)}\phi\,dx\underset{\text{DCT}}{=}(-1)^{|\alpha|}\int_Uu_{\alpha}\phi\,dx.\]

\item By \ref{convergence_each_derivative} and \ref{derivative_limit_commute}, $u\in W^{k,p}(U)$.

\item For $1\leq p<\infty$,
\[||u^{(n)}-u||_{W^{k,p}(U)}=\left(\sum_{|\alpha|\leq k}\right.\underbrace{||D^{\alpha}u^{(n)}-D^{\alpha}u||_{L^p(U)}^p}_{\to0}\left.\vphantom{\sum_{|\alpha|\leq k}}\right)^{1/p}\longrightarrow0,\]
i.e., $u^{(n)}\rightarrow u$ in $W^{k,p}(U)$.

Proof for the case $p=\infty$ is similar.
\end{enumerate}
\end{proof}

%30/06
\subsection[An application: Solving the ODE \texorpdfstring{$\frac{du}{dx}=0$}{du/dx} in \texorpdfstring{$W^{1,1}(I)$}{the 1D Sobolev space}]{An application: Solving the ODE \texorpdfstring{$\boldsymbol{\frac{du}{dx}=0}$}{du/dx} in \texorpdfstring{$\boldsymbol{W^{1,1}(I)}$}{the 1D Sobolev space}}
%Subsection 5.4
This is the simplest differential equation.

\begin{proposition}
%Proposition 5.2
Let $I\subseteq\mathbb{R}$ be an open interval. Let $u\in W^{1,1}(I)$ (i.e., $u\in L^1(I)$ and $\frac{du}{dx}\in L^1(I)$). Suppose that $\frac{du}{dx}=0$. Then $\exists C\in\mathbb{R}$ such that $u(x)=C$ a.e.
\end{proposition}

\begin{proof}
By definition of the weak derivative,
\[\int_Iu\frac{d\phi}{dx}\,dx=-\int_I0\cdot\phi\,dx=0\ \ \forall\phi\in C_0^{\infty}(I).\]

\begin{idea}
Choose $\phi$ so that $\int_Iu\frac{d\phi}{dx}\,dx$ is approximately the difference of two values of $u$.
\end{idea}

Let $\eta_{\epsilon}\in C_0^{\infty}(\mathbb{R})$ be the standard mollifier. We choose
\[\phi(x)=\int_{-\infty}^x\big[\eta_{\epsilon}(t-b)-\eta_{\epsilon}(t-a)\big]\,dt\]
so that
\[\frac{d\phi}{dx}=\eta_{\epsilon}(x-b)-\eta_{\epsilon}(x-a)\]
and $\phi\in C_0^{\infty}(I)$. Then, we see that
\begin{multline*}
0=\int_Iu(x)\big[\eta_{\epsilon}(x-b)-\eta_{\epsilon}(x-a)\big]\,dx=\int_{\mathbb{R}}u(x)\big[\eta_{\epsilon}(x-b)-\eta_{\epsilon}(x-a)\big]\,dx\\
=(u*\eta_{\epsilon})(b)-(u*\eta_{\epsilon})(a)\xrightarrow[\epsilon\to0]{}u(b)-u(a),
\end{multline*}
for a.e. $a,b\in I$.

Therefore, $u$ is equal to some constant a.e.
\end{proof}

\begin{summary}
\begin{itemize}[label=$-$]
\item Solutions to $\frac{du}{dx}=0$ in $W^{1,1}(I)$ are the classical solutions.

\item All $W^{1,1}$ solutions to $\frac{du}{dx}=0$ in $W^{1,1}$ are $C^1$ (and even $C^{\infty}$). This is a prototype of a \textbf{regularity theorem}.
\end{itemize}
\end{summary}

\subsection{Approximations of Sobolev functions by smooth functions}
%Subsection 5.5
\subsubsection{Interior approximations of Sobolev functions}

\begin{definition*}
For $U,V\subseteq\mathbb{R}^n$, we say $V$ is \textbf{compactly contained} in $U$ if $\overline{V}$ is compact and $\overline{V}\subseteq U$.
\end{definition*}
\begin{notation}
$V\subset\subset U$ means $V$ is compactly contained in $U$.
\end{notation}

Intuition. If $U$ is open, $V\subset\subset U$ means $V$ is bounded away from $\partial U$. $V$ cannot get arbitrarily close to $\partial U$, $V$ must stay at least some distance $\epsilon$ away.

\begin{definition*}
Let $U\subseteq\mathbb{R}^n$ open. Let $\{u^{(n)}\}_{n=1}^{\infty}\subseteq W^{k,p}(U)$ and $u\in W^{k,p}(U)$. We say $u^{(n)}$ converges to $u$ in $W_{\text{loc}}^{k,p}(U)$ if $||u^{(n)}-u||_{W^{k,p}(V)}\rightarrow0$ for all open $V\subset\subset U$.
\end{definition*}

\begin{example*}
$U=(0,1)$;
\[u^{(n)}(x)=\left\{\begin{array}{ll}nx&0<x<\frac{1}{n},\\1&\frac{1}{n}\leq x\leq1-\frac{1}{n},\\-nx+n&1-\frac{1}{n}<x<1.\end{array}\right.\]

\begin{center}
\begin{tikzpicture}[scale=6]
%n=4
\newcommand{\nvar}{4}
\newcommand{\exc}{0.1}
\newcommand{\tickw}{0.02}
\newcommand{\sep}{0.2}
\newcommand{\vlen}{0.2}

\newcommand{\bezx}{\tickw/2}
\newcommand{\bezy}{\tickw/2}
\draw (-\exc,0) -- (1+\exc,0);
\draw (0,-\exc) -- (0,1+\exc);
\draw (0,0) -- (1/\nvar,1);
\draw (1/\nvar,1) -- (1-1/\nvar,1);
\draw (1-1/\nvar,1) -- (1,0);
\draw (-\tickw,1) -- (\tickw,1);
\draw [above right] (1-1/\nvar,1) node {$u^{(n)}$};
\draw [left] (-\tickw,1) node {$1$};
\draw (1/\nvar,-\tickw) -- (1/\nvar,\tickw);
\draw [below] (1/\nvar,-\tickw) node {$\frac{1}{n}$};
\draw (1-1/\nvar,-\tickw) -- (1-1/\nvar,\tickw);
\draw [below] (1-1/\nvar,-\tickw) node {$1-\frac{1}{n}$};
\draw [below] (1,-\tickw) node {$1$};
\draw ({(1-\vlen)/2},-\tickw) .. controls ({(1-\vlen)/2-\bezx},-\bezy) and ({(1-\vlen)/2-\bezx},\bezy) .. ({(1-\vlen)/2},\tickw);
\draw ({(1+\vlen)/2},-\tickw) .. controls ({(1+\vlen)/2+\bezx},-\bezy) and ({(1+\vlen)/2+\bezx},\bezy) .. ({(1+\vlen)/2},\tickw);
\draw [above] (1/2,0) node {$V$};
\draw [right] (0,-\sep) node {$U=(0,1)$};
\draw [below left] (-\tickw,-\tickw) node {$0$};
\end{tikzpicture}
\end{center}

$u^{(n)}\rightarrow1$ in $W_{\text{loc}}^{1,p}(0,1)$, but $u^{(n)}\not\rightarrow1$ in $W^{1,p}(0,1)$, because $\frac{du^{(n)}}{dx}\not\rightarrow0$ in $L^p(0,1)$.
\end{example*}

\begin{recall}
(Mollification) The standard mollifier:
\[\eta_{\epsilon}(x)=\frac{1}{\epsilon^n}\eta\left(\frac{x}{\epsilon}\right),\]
where:
\begin{itemize}
\item $\eta\in C_0^{\infty}$,
\item $\eta\geq0$,
\item $\int\eta=1$,
\item $\supp(\eta)\subseteq B_1(0)$.
\end{itemize}

Then, for $u\in L_{\text{loc}}^1(U)$, the mollification of $u$ is
\[u^{\epsilon}(x)=(\eta_{\epsilon}*u)(x)=\int\eta_{\epsilon}(x-y)u(y)\,dy,\]
$u^{\epsilon}:U_{\epsilon}\rightarrow\mathbb{R}$.
\end{recall}

\begin{theorem}\label{local_approx_smooth}
%Thm 5.3
\emph{\textbf{(Local approximation by smooth functions)}} Let $U\subseteq\mathbb{R}^n$ open, $k\in\mathbb{N}\cup\{0\}$, $1\leq p<\infty$, $u\in W^{k,p}(U)$, $u^{\epsilon}=\eta_{\epsilon}*u$.

\begin{enumerate}[label=(\roman*)]
\item $u^{\epsilon}\in C^{\infty}(U_{\epsilon})$.

\item\label{conv_Sobolev_loc} $u^{\epsilon}\rightarrow u$ in $W_{\text{loc}}^{k,p}(U)$.
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}[label=(\roman*)]
\item Already proved in Lemma \ref{properties_mollifier} (since $W^{k,p}\subseteq L_{\text{loc}}^1$).

\item Based on two lemmata.
\end{enumerate}
\end{proof}

\begin{lemma}\label{conv_moll_loc}
%Lemma 5.2
$u\in L_{\text{loc}}^p(U)\Rightarrow u^{\epsilon}\rightarrow u$ in $L_{\text{loc}}^p$.
\end{lemma}

\begin{lemma}\label{diff_comm_moll}
%Lemma 5.3
\emph{\textbf{(Differentiation commutes with mollification)}} $D^{\alpha}(\eta_{\epsilon}*u)=\eta_{\epsilon}*D^{\alpha}u$ in $U_{\epsilon}$ $\forall\alpha$.
\end{lemma}

\begin{proof}
(Lemma \ref{diff_comm_moll}) Let $x\in U_{\epsilon}$,
\begin{multline*}
D^{\alpha}(\eta_{\epsilon}*u)(x)=D^{\alpha}\int_U\eta_{\epsilon}(x-y)u(y)\,dy=\int_UD_x^{\alpha}\eta_{\epsilon}(x-y)u(y)\,dy\\
=(-1)^{|\alpha|}\int_UD_y^{\alpha}\underbrace{\eta_{\epsilon}(x-y)}_{\mathclap{=\phi(y)\in C_0^{\infty}(U)}}u(y)\,dy=\int\underbrace{\phi(y)}_{\mathclap{\eta_{\epsilon}(x-y)}}D^{\alpha}u(y)\,dy=(\eta_{\epsilon}*D^{\alpha}u)(x).
\end{multline*}
\end{proof}

\begin{proof}
(Theorem \ref{local_approx_smooth} \ref{conv_Sobolev_loc} using Lemmata \ref{conv_moll_loc} and \ref{diff_comm_moll}) We want to show that for all $V\subset\subset U$ open and $|\alpha|\leq k$,
\[D^{\alpha}u^{\epsilon}\longrightarrow D^{\alpha}u\text{ in }L^p(V).\]

\[D^{\alpha}u^{\epsilon}=D^{\alpha}(\eta_{\epsilon}*u)\underset{\text{Lemma \ref{diff_comm_moll}}}{=}\eta_{\epsilon}*\underbrace{D^{\alpha}u}_{\in L^p(U)}\xrightarrow[\text{Lemma \ref{conv_moll_loc}}]{\epsilon\to0}D^{\alpha}u\text{ in }L^p(V).\]

Then, we have
\[||u^{\epsilon}-u||_{W^{k,p}(V)}=\left(\sum_{0\leq|\alpha|\leq k}\right.\underbrace{||D^{\alpha}u^{\epsilon}-D^{\alpha}u||_{L^p(V)}^p}_{\longrightarrow0}\left.\vphantom{\sum_{0\leq|\alpha|\leq k}}\right)^{1/p}\longrightarrow0.\]
\end{proof}

\begin{proof}
(Lemma \ref{conv_moll_loc})
\begin{idea}
\begin{enumerate}[label=\arabic*.]
\item By Lemma \ref{properties_mollifier}, we know: $W$ open, $f\in C(W)$ imples $\eta_{\epsilon}*f\rightarrow f$ uniformly on compact subsets of $W$.

\item From measure theory, $K\subseteq\mathbb{R}^n$ compact implies $C(K)$ is dense in $L^p(K)$.

\item Let $V\subset\subset W\subset\subset U$. Then, $\exists g\in C(\overline{W})$ such that $g\approx u$ on $W$.
\[\eta_{\epsilon}*u\approx\eta_{\epsilon}*g\xrightarrow{\text{uniformly}}g\approx u.\]
\end{enumerate}
\end{idea}

To rigorously justify this, we need an intermediate technical reslut:
\begin{claim*}
For $\epsilon$ sufficiently small,
\[||\eta_{\epsilon}*w||_{L^p(V)}\leq||w||_{L^p(V)}.\]
\end{claim*}

\begin{proof}
For $\frac{1}{p}+\frac{1}{p'}=1$,
\begin{multline*}
\big|(\eta_{\epsilon}*u)(x)\big|=\left|\int_{B_{\epsilon}(x)}\eta_{\epsilon}(x-y)u(y)\,dy\right|\leq\int_{B_{\epsilon}(x)}\eta_{\epsilon}(x-y)|u(y)|\,dy\\
=\int_{B_{\epsilon}(x)}\eta_{\epsilon}(x-y)^{1-\frac{1}{p}}\eta_{\epsilon}(x-y)^{\frac{1}{p}}|u(y)|\,dy\\
\leq{\underbrace{\left(\int_{B_{\epsilon}(x)}\left(\eta_{\epsilon}(x-y)^{1-\frac{1}{p}}\right)^{p'}dy\right)}_{=1}}^{\frac{1}{p'}}\left(\int_{B_{\epsilon}(x)}\left(\eta_{\epsilon}(x-y)^{\frac{1}{p}}|u(y)|\right)^pdy\right)^{\frac{1}{p}}\\
=\left(\int_{B_{\epsilon}(x)}\eta_{\epsilon}(x-y)|u(y)|^p\,dy\right)^{\frac{1}{p}}.
\end{multline*}

For $\epsilon$ sufficiently small, $B_{\epsilon}(x)\subseteq W$ and
\begin{multline*}
||\eta_{\epsilon}*u||_{L^p(V)}^p=\int_V|\eta_{\epsilon}*u|^p\,dx\leq\int_V\int_{B_{\epsilon}(x)}\eta_{\epsilon}(x-y)|u(y)|^p\,dy\,dx\\
\leq\int_{\mathbb{R}^n}\int_W\eta_{\epsilon}(x-y)|u(y)|^p\,dy\,dx=\int_W|u(y)|^p\underbrace{\int_{\mathbb{R}^n}\eta_{\epsilon}(x-y)}_{=1}dx\,dy=||u||_{L^p(W)}^p.
\end{multline*}
\end{proof}
Now, we can complete the proof of Lemma \ref{conv_moll_loc}.

Let $\delta>0$. Choose $g\in C(\overline{W})$ such that $||u-g||_{L^p(W)}<\delta$. Then,
\begin{multline*}
||\eta_{\epsilon}*u-u||_{L^p(V)}=\big|\big|\eta_{\epsilon}*(u-g)+\eta_{\epsilon}*g-g+g-u\big|\big|_{L^p(V)}\\
\leq\big|\big|\eta_{\epsilon}*(u-g)\big|\big|_{L^p(V)}+||\eta_{\epsilon}*g-g||_{L^p(V)}+||g-u||_{L^p(V)}\\
\leq||u-g||_{L^p(W)}+||\eta_{\epsilon}*g-g||_{L^p(V)}+||g-u||_{L^p(V)}<2\delta+||\eta_{\epsilon}*g-g||_{L^p(V)}\xrightarrow[\epsilon\to0]{}0.
\end{multline*}
\end{proof}

%05/07
\subsubsection{Global approximation of Sobolev functions}
\begin{theorem}\label{Meyers_Serrin}
%Thm 5.4
\emph{\textbf{(Meyers-Serrin theorem)}} $k\in\mathbb{N}$, $l\leq p<\infty$, $U\subseteq\mathbb{R}^n$ open bounded, $u\in W^{k,p}(U)$. Then $\exists u_m\in C^{\infty}(U)\cap W^{k,p}(U)$ such that
\[u_m\longrightarrow u\text{ in }W^{k,p}(U).\]
``$C^{\infty}$ is dense in $W^{k,p}$''.
\end{theorem}

\begin{remark}
We don't assert that $u_m\in C^{\infty}(\overline{U})$, or even $C^0(\overline{U})$.
\end{remark}

\begin{proof}
See Evans.
\end{proof}

In the beginning, there were two approaches to construct the Sobolev spaces. One way was the abstract completion of $C^{\infty}$ with the $W^{k,p}$ norm. The other was via the weak derivatives. Finally, this theorem was discovered and it showed that both were constructions of the same object.

\begin{remark}
(History) Theorem \ref{Meyers_Serrin} was discovered $\sim30$ years after invention of Sobolev spaces:
\begin{itemize}
\item via weak derivatives (our definition): ``$W$'';
\item via abstract completion of $C^{\infty}$ in the Sobolev norm: ``$H$''.
\end{itemize}
Theorem \ref{Meyers_Serrin} appared under the title ``$H=W$''.
%Theorem 6.4
\end{remark}

\subsection{Boundary values of Sobolev functions}
%Subsection 5.6
\begin{question}
Can we make sense of boundary values of Sobolev functions?
\end{question}

\begin{itemize}
\item No hope if $u\in L^p(\Omega)$, $\Omega\subseteq\mathbb{R}^d$ smooth boundary ($\partial\Omega$ has measure $0$).

\item On the other hand, $W^{k,p}$ functions ($k\geq1$) are ``more regular''.
\end{itemize}

Rigorous discussion:
\begin{enumerate}[label=\alph*)]
\item zero boundary values,
\item nonzero boundary values.
\end{enumerate}

\subsubsection{Zero boundary values}
\begin{idea}
Impose boundary conditions on the approximating sequence from Theorem \ref{Meyers_Serrin}.
\end{idea}

\begin{definition*}
Let $\Omega\subseteq\mathbb{R}^n$ be open, $1\leq p\leq\infty$.

\begin{enumerate}[label=(\roman*)]
\item $W_0^{1,p}(\Omega)$ is defined as the closure of $C_0^{\infty}(\Omega)$ in $W^{1,p}(\Omega)$.

\item $W_0^{k,p}(\Omega)$ is defined as the closure of $C_0^{\infty}(\Omega)$ in $W^{k,p}(\Omega)$, $k\geq1$.
\end{enumerate}
\end{definition*}

Intuitively:
\begin{enumerate}[label=(\roman*)]
\item ``$u=0$ on $\partial\Omega$'',
\item ``$D^{\alpha}u=0$ on $\partial\Omega$ $\forall|\alpha|\leq k-1$''.
\end{enumerate}

Fact. $W_0^{1,p}(\Omega)$ is a closed proper (not equal) subspace of $W^{1,p}(\Omega)$ if $\Omega$ is bounded.

Compare. Closure of $C_0^{\infty}(\Omega)$ in $L^p(\Omega)$ is $L^p(\Omega)$.

\subsubsection{Nonzero boundary values}
``Easy'' way: given $g\in W^{1,p}(\Omega)$, define
\[W_g^{1,p}(\Omega)\coloneqq\{u\in W^{1,p}(\Omega):u-g\in W_0^{1,p}(\Omega)\}.\]

Intuitively: ``$u=g$ on $\partial\Omega$''.

\begin{itemize}
\item[$\boldsymbol{\oplus}$] Works for any open bounded set $\Omega$ in $\mathbb{R}^n$.

\item[$\boldsymbol{\ominus}$] Need $g$ not just on $\partial\Omega$, but in $\Omega$.
\end{itemize}

``Hard'' way:
\begin{theorem}\label{trace_operator}
%Thm 5.5
\emph{\textbf{(Trace operator)}} Let $\Omega\subseteq\mathbb{R}^n$ open bounded with $C^1$ boundary, $1\leq p<\infty$.

\begin{enumerate}[label=\alph*)]
\item $\exists$ a linear operator $T:W^{1,p}(\Omega)\rightarrow L^p(\partial\Omega)$ (``trace operator'') such that:
\begin{enumerate}[label=\roman*)]
\item $Tu=u|_{\partial\Omega}$ if $u\in W^{1,p}(\Omega)\cap C(\overline{\Omega})$;
\item $T$ continuous, i.e., $\exists C>0$ such that $||Tu||_{L^p(\partial\Omega)}\leq C||u||_{W^{1,p}(\Omega)}$ $\forall u\in W^{1,p}(\Omega)$.
\end{enumerate}

\item Let $u\in W^{1,p}(\Omega)$. Then, $u\in W_0^{1,p}(\Omega)\Longleftrightarrow Tu=0$.
\end{enumerate}
\end{theorem}

\begin{itemize}
\item[$\boldsymbol{\oplus}$] Boundary values: can require $Tu=g$, need $g$ only on $\partial\Omega$.

\item[$\boldsymbol{\ominus}$] $\Omega$ must have smooth boundary.

\item[$\boldsymbol{\ominus}$] Need to prove existence of $T$.
\end{itemize}

Note the loss of regularity: $u\in W^{1,p}(\Omega)$, but $Tu$ only in $L^p(\partial\Omega)$.

In this course, won't use the trace theorem.

\begin{proof}
\cite{evans2010partial} Evans, Section 5.5.
\end{proof}

\subsection{Sobolev inequalities and embedding theorems}
%Subsection 5.7
If $u$ belongs to some Sobolev space, it also belongs to \textbf{other} Sobolev spaces.

\begin{theorem}
%Thm 6.6
Let $1\leq p<n$.
\begin{enumerate}[label=\alph*)]
\item \textbf{Sobolev inequality.} $\exists$ a constant $C(p,n)$ such that $\forall u\in C_0^{\infty}(\mathbb{R}^n)$
\begin{equation}\tag{S}\label{Sobolev_inequality}
||u||_{L^{\frac{np}{n-p}}(\mathbb{R}^n)}\leq C||Du||_{L^p(\mathbb{R}^n)}.
\end{equation}
More precisely, $C=\frac{(n-1)p}{n-p}$. The exponent $p_*\coloneqq\frac{np}{n-p}$ ($>p$) is called the \textbf{Sobolev exponent}.

\item \textbf{Higher regularity.} $\Omega\subseteq\mathbb{R}^n$ open, $u\in W_0^{1,p}(\Omega)$ implies $u\in L^{p_*}(\Omega)$ and \eqref{Sobolev_inequality} holds.
\end{enumerate}
\end{theorem}

\begin{note}
$p_*>p$, hence ``higher regularity''.
\end{note}

\begin{example*}
(Important) $u\in W_0^{1,2}(\mathbb{R}^3)$, i.e., $\int_{\mathbb{R}^3}|u|^2<\infty$, $\int_{\mathbb{R}^3}|Du|^2<\infty$. Then,
\[p_*=\frac{np}{n-p}=\frac{3\cdot2}{3-2}=6.\]
Hence, $u\in L^6(\mathbb{R}^3)$.
\end{example*}

\subsubsection*{Physics derivation of $\boldsymbol{p_*}$}
(By dimensional analysis) $x=(x_1,\ldots,x_n)\in\mathbb{R}^n$, $u(x)\in\mathbb{R}$,
\begin{align*}
[x_j]=L&\text{ length unit},\\
[u]=U&\text{ unit in which we measure }u.
\end{align*}
Suppose
\[\left(\int_{\mathbb{R}^n}|u|^q\right)^{1/q}\leq C\left(\int_{\mathbb{R}^n}|Du|^p\right)^{1/p}\ \ \forall n.\]

Units of LHS: $(U^q\cdot L^n)^{1/q}=U\cdot L^{n/q}$.

Units of RHS: $((\frac{U}{L})^p\cdot L^n)^{1/p}=U\cdot L^{\frac{n-p}{p}}$.

But LHS and RHS must have same units, so
\begin{equation}\tag{Sobolev exponent}
\frac{n}{q}=\frac{n-p}{p}\Longleftrightarrow q=\frac{n\cdot p}{n-p}=p_*.
\end{equation}

\begin{proof}
\begin{enumerate}[label=\alph*)]
\item $p=1$. To show: $||u||_{L^{\frac{n}{n-1}}}\leq C||Du||_{L^1}$ $\forall u\in C_0^{\infty}(\mathbb{R}^n)$, $n>1$.

By the fundamental theorem of calculus and the fact that $u$ has compact support,
\[u(x)=\int_{-\infty}^{x_i}\frac{\partial u}{\partial x_i}(x_1,\ldots,x_{i-1},y_i,x_{i+1},\ldots,x_n)\,dy_i,\]
\[|u(x)|\leq\int_{-\infty}^{\infty}\big|Du(x_1,\ldots,x_{i-1},y_i,x_{i+1},\ldots,x_n)\big|\,dy_i,\]
\[|u(x)|^{\frac{n}{n-1}}\leq\prod_{i=1}^n\left(\int_{-\infty}^{\infty}\big|Du(x_1,\ldots,y_i,\ldots,x_n)\big|\,dy_i\right)^{\frac{1}{n-1}}.\]

Want: bound on $\int_{\mathbb{R}^n}|u(x)|^{\frac{n}{n-1}}\,dx_1\cdots dx_n$. Successively integrate over $x_1,x_2,\ldots$

\begin{enumerate}[label=\arabic*.]
\item
\begin{multline*}
\int_{-\infty}^{\infty}|u(x)|^{\frac{n}{n-1}}\,dx_1\leq\int_{-\infty}^{\infty}\prod_{i=1}^n\left(\int_{-\infty}^{\infty}\big|Du(x_1,\ldots,y_i,\ldots,x_n)\big|\,dy_i\right)^{\frac{1}{n-1}}\,dx_1\\
={\underbrace{\left(\int_{-\infty}^{\infty}|Du|\,dy_1\right)}_{\eqqcolon I_1\text{ indep. of }x_1}}^{\frac{1}{n-1}}\int_{-\infty}^{\infty}\prod_{i=2}^n\left(\int_{-\infty}^{\infty}|Du|\,dy_i\right)^{\frac{1}{n-1}}\,dx_1.
\end{multline*}

Use H\"{o}lder:
\[\int f_1\cdots f_m\leq||f_1||_{p_1}\cdots||f_m||_{p_m},\ \ \frac{1}{p_1}+\cdots+\frac{1}{p_m}=1.\]
Have $(n-1)=m$ factors, use $p_1=\cdots=p_{n-1}=n-1$, then
\[\underbrace{\frac{1}{n-1}+\cdots+\frac{1}{n-1}}_{n-1\text{ terms}}=1.\]
\[\leq I_1^{\frac{1}{n-1}}\prod_{i=2}^{n-1}{\underbrace{\left(\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}|Du|\,dy_i\,dx_1\right)}_{\eqqcolon I_{1,i}}}^{\frac{1}{n-1}}\]

\item Integrate over $x_2$:
\begin{multline*}
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}|u(x)|^{\frac{n}{n-1}}\,dx_1\,dx_2\leq\int_{-\infty}^{\infty}\cdots\,dx_2=\\
{\underbrace{\left(\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}|Du|\,dx_1\,dx_2\right)}_{=I_{12}\text{ indep of }x_2}}^{\frac{1}{n-1}}\int_{-\infty}^{\infty}I_1^{\frac{1}{n-1}}I_{1,3}^{\frac{1}{n-1}}\cdots I_{1,n}^{\frac{1}{n-1}}\,dx_2,
\end{multline*}
\begin{multline*}
\int_{-\infty}^{\infty}I_1^{\frac{1}{n-1}}I_{1,3}^{\frac{1}{n-1}}\cdots I_{1,n}^{\frac{1}{n-1}}\,dx_2\\
\underset{\text{H\"{o}lder}}{\leq}I_{12}\cdot{\underbrace{\left(\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}|Du|\,dy_1\,dx_1\right)}_{=I_{12}}}^{\frac{1}{n-1}}\cdot\prod_{i=3}^n{\underbrace{\left(\int\int\int|Du|\,dx_1\,dx_2\,dx_i\right)}_{I_{12i}}}^{\frac{1}{n-1}},
\end{multline*}

\[\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}|u(x)|^{\frac{n}{n-1}}\,dx_1\,dx_2\leq(I_{12})^{\frac{2}{n-1}}\prod_{i=3}^nI_{12i}^{\frac{1}{n-1}}.\]

\item Iterate:
\[\int_{-\infty}^{\infty}\cdots\int_{-\infty}^{\infty}|u(x)|^{\frac{n}{n-1}}\,dx_1\cdots dx_{n-1}\leq(I_{12\cdots n-1})^{\frac{n-1}{n-1}}I_{12\cdots(n-1)n}^{\frac{1}{n-1}},\]
\[\int_{\mathbb{R}^n}|u|^{\frac{n}{n-1}}\leq(I_{12\cdots n})^{\frac{n}{n-1}}=\left(\int|Du|\right)^{\frac{n}{n-1}},\]
\[||u||_{\frac{n}{n-1}}\leq||Du||_1.\]
\end{enumerate}

$p>1$. Apply \eqref{Sobolev_inequality} for $p=1$ to $|u|^{\gamma}$, $\gamma>1$ suitable.

Use $D|u|^{\gamma}=\gamma|u|^{\gamma-1}\sgn(u)Du$. So
\[\big|\big||u|^{\gamma}\big|\big|_{\frac{n}{n-1}}\underset{\substack{\text{\eqref{Sobolev_inequality}}\\p=1}}{\leq}\gamma\int_{\mathbb{R}^n}|u|^{\gamma-1}|Du|\underset{\text{H\"{o}lder}}{\leq}\cdots\]

Details: class.
\end{enumerate}
\end{proof}

%07/07
\begin{definition*}
\textbf{(Space of H\"{o}lder continuous functions)} Let $\Omega\subseteq\mathbb{R}^n$, $0<\alpha\leq1$,
\[C^{\alpha}(\Omega)\coloneqq\{u:\Omega\rightarrow\mathbb{R}\,|\,u\text{ continuous},||u||_{C^{\infty}(\Omega)}<\infty\},\]
where
\[||u||_{C^{\alpha}(\Omega)}\coloneqq\sup_{\Omega}|u|+\sup_{\substack{x,y\in\Omega\\x\neq y}}\frac{\big|u(x)-u(y)\big|}{|x-y|^{\alpha}}.\]

Elements of $C^{\alpha}(\Omega)$ are called H\"{o}lder continuous with exponent $\alpha$.

\begin{itemize}
\item Special case. $\alpha=1$: Lipschitz continuous functions ($|u(x)-u(y)|\leq C|x-y|$).

\item General $\alpha$: $\underbrace{|u(x)-u(y)|}_{\sim\epsilon}\leq C{\underbrace{|x-y|}_{\sim\delta}}^{\alpha}$ (some $C$, all $x,y$).
\end{itemize}
\end{definition*}

Better than continuous: controlled dependence of $\epsilon$ on $\delta$.
\[|x-y|\leq\delta\Rightarrow\big|u(x)-u(y)\big|\leq\epsilon\text{ with }\epsilon=C\cdot\delta^{\alpha}.\]

\begin{corollary}
H\"{o}lder continuous implies continuous.
\end{corollary}

Less good than continuously differentiable: $\Omega$ compact and lux, $u$ continuously differentiable implies (Analysis 2) that $u\in C^{\alpha}(\Omega)$ $\forall\alpha\in(0,1]$.

\begin{example*}
$u(x)=\sqrt{|x|}$, $x\in[-1,1]$, $u\in C^{1/2}([-1,1])$.

$u(x)=|x|^{1/3}$, $u\in C^{1/3}([-1,1])$, etc.
\end{example*}

\begin{theorem}\label{Morrey_higher_regularity}
%Thm 5.7
$\Omega\subseteq\mathbb{R}^n$ open bounded, $p>n$.

\begin{enumerate}[label=\alph*)]
\item \textbf{Morrey's inequality.} $\exists C(n,p,\Omega)$ such that $\forall u\in C_0^{\infty}(\Omega)$
\begin{equation}\tag{M}\label{Morrey}
||u||_{C^{\alpha}(\Omega)}\leq C||Du||_{L^p(\Omega)},
\end{equation}
where $\alpha=1-\frac{n}{p}$.

\item\label{higher_regularity} \textbf{Higher regularity.} Let $u\in W_0^{1,p}(\Omega)$. After changing $u$ on a set of measure $0$, $u\in C^{\alpha}(\overline{\Omega})$, $\alpha=1-\frac{n}{p}$. In particular, $u$ is continuous! Moreover, \eqref{Morrey} holds.
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}[label=\alph*)]
\item First, prove auxiliary inequality:
\begin{equation}\tag{A}\label{auxiliary}
\int_{B_r(x)}\big|u(x)-u(y)\big|\,dy\leq\frac{r^n}{n}\int_{B_r(x)}\frac{|\nabla u(y)|}{|x-y|^{n-1}}\,dy.
\end{equation}

\begin{proof}
As in the proof of Sobolev inequality, use the fundamental theorem of calculus.

$w=\frac{y-x}{|y-x|}$, $r'=|x-y|\in(0,r)$, $y=x+r'w$, $w\in\partial B_1(0)$.

\[u(y)-u(x)=u(x+r'w)-u(x)\underset{\text{FTC}}{=}\int_0^{r'}\underbrace{\frac{d}{dt}u(x+tw)}_{=\nabla u(x+tw)\cdot w}dt,\]
\[\big|u(x+r'w)-u(x)\big|\leq\int_0^{r'}\big|\nabla u(x+tw)\big|\cdot\underbrace{|w|}_{=1}dt,\]
\begin{multline*}
\int_{\partial B_1(0)}\big|u(x+r'w)-u(x)\big|\,dS(w)\leq\int_0^{r'}\int_{\partial B_1(0)}\big|\nabla u(x+tw)\big|\,dS(w)dt\\
=\int_0^{r'}t^{n-1}\int_{\partial B_1(0)}\frac{\big|\nabla u(x+tw)\big|}{t^{n-1}}\,dS(w)dt\\
\underset{\substack{y=x+tw\\t^{n-1}=|x-y|^{n-1}}}{=}\int_{B_{r'}(x)}\frac{|\nabla u(y)|}{|x-y|^{n-1}}\,dy\leq\int_{B_r(x)}\frac{|\nabla u(y)|}{|x-y|^{n-1}}\,dy,
\end{multline*}
\[\int_{B_r(0)}\big|u(x+y)-u(x)\big|\,dy\leq\underbrace{\frac{r^n}{n}}_{\mathclap{\vol B_r(0)}}\cdot\int_{B_r(x)}\frac{|\nabla u(y)|}{|x-y|^{n-1}}\,dy,\]
\begin{equation}\tag{A$'$}\label{auxiliary_average}
\underbrace{\fint_{B_r(0)}\big|u(x+y)-u(x)\big|\,dy}_{\underset{x+y=z}{=}\fint_{B_r(x)}|u(z)-u(x)|\,dz}\leq C\int_{B_r(x)}\frac{|\nabla u(y)|}{|x-y|^{n-1}}\,dy.
\end{equation}

Average difference between function values is controlled by a weighted integral of the gradient.
\end{proof}

\begin{claim*}
\[\frac{\big|u(x)-u(y)\big|}{|x-y|^{1-n/p}}\leq C||\nabla u||_{L^p(\Omega)}.\]
\end{claim*}

\begin{idea}
Compare both $u(x)$ and $u(y)$ to $u(z)$, $z$ a third point and average over $z$.
\end{idea}

\begin{proof}
Fix $x\neq y$. Let $r\coloneqq|x-y|$. Let $z\in W\coloneqq B_r(x)\cap B_r(y)$. Then,
\begin{multline*}
\big|u(x)-u(y)\big|=\fint_W\big|u(x)-u(y)\big|\,dz\leq\fint_W\big|u(x)-u(z)\big|\,dz+\fint_W\big|u(y)-u(z)\big|\,dz\\
\leq\underbrace{C\fint_{B_r(x)}\big|u(x)-u(z)\big|\,dz}_{\eqqcolon T_1}+\underbrace{C\fint_{B_r(y)}\big|u(y)-u(z)\big|\,dz}_{\eqqcolon T_2},
\end{multline*}
where
\[C\coloneqq\frac{\vol(B_r)}{\vol(W)}.\]
So can now apply \eqref{auxiliary}.
\begin{multline*}
T_1\underset{\text{\eqref{auxiliary_average}}}{\leq}C'\int_{B_r(x)}\frac{|\nabla u(y)|}{|x-y|^{n-1}}\,dy\underset{\text{H\"{o}lder}}{\leq}C'||\nabla u||_{L^p(B_r(x))}\left|\left|\frac{1}{|x-\,\cdot\,|^{n-1}}\right|\right|_{L^{p'}(B_r(x))}\\
=C'||\nabla u||_{L^p(B_r(x))}\underbrace{\left|\left|\frac{1}{|\,\cdot\,|^{n-1}}\right|\right|_{L^{p'}(B_r(0))}}_{\mathclap{\text{values depend on }r=|x-y|}},
\end{multline*}
where $\frac{1}{p}+\frac{1}{p'}=1$, i.e., $p'=\frac{p}{p-1}$.

Auxiliary calculation:
\begin{multline*}
\left|\left|\frac{1}{|\,\cdot\,|^{n-1}}\right|\right|_{L^{p'}(B_r(0))}=\left(\int_{B_r(0)}\frac{1}{|y|^{(n-1)\cdot\frac{p}{p-1}}}dy\right)^{\frac{p-1}{p}}\underset{\substack{\text{polar}\\\text{coord.}}}{=}\left(\omega_n\int_0^rt^{n-1}\frac{1}{t^{(n-1)\frac{p}{p-1}}}\,dt\right)^{\frac{p-1}{p}}\\
=\left(\omega_n\int_0^rt^{n-1-(n-1)\frac{p}{p-1}}\,dt\right)^{\frac{p-1}{p}}=\left(C\omega_nr^{n-(n-1)\frac{p}{p-1}}\right)^{\frac{p-1}{p}}=(C\omega_n)^{\frac{p-1}{p}}\cdot\underbrace{r^{\frac{-n+p}{p}}}_{\mathclap{=r^{1-\frac{n}{p}}=|x-y|^{1-\frac{n}{p}}}},
\end{multline*}
where
\[n-(n-1)\frac{p}{p-1}=\frac{n(p-1)-(n-1)p}{p-1}=\frac{-n+p}{p-1}.\]

Analogously,
\[T_2\leq\widetilde{C}||\nabla u||_{L^p(B_r(x))}|x-y|^{1-\frac{n}{p}},\]
\[\big|u(x)-u(y)\big|\leq C||\nabla u||_{L^p(B_r(x))}|x-y|^{1-\frac{n}{p}}.\]
\end{proof}

\begin{claim*}
\[\sup_{\Omega}|u|\leq C||\nabla u||_{L^p(\Omega)}.\]
\end{claim*}

\begin{proof}
Fix $x\in\Omega$, pick $y\in\partial\Omega$, use $u(y)=0$.
\[|u(x)|=\big|u(x)-u(y)\big|\leq C|x-y|^{1-\frac{n}{p}}||\nabla u||_{L^p(\Omega)}\leq(\diam\Omega)^{1-\frac{n}{p}}||\nabla u||_{L^p(\Omega)},\]
\[\sup_{\Omega}|u|\leq(\diam\Omega)^{1-\frac{n}{p}}||\nabla u||_{L^p(\Omega)}.\]
\end{proof}

\item Let $u\in W_0^{1,p}(\Omega)$. Choose $u_m\in C_0^{\infty}(\Omega)$, $u_m\rightarrow u$ in $W^{1,p}(\Omega)$.

$\{u_m\}$ convergent in $W^{1,p}$, so $\{u_m\}$ is Cauchy in $W^{1,p}$. By Morrey's inequality, $\{u_m\}$ is Cauchy in $C^{\alpha}(\overline{\Omega})$.

Since $C^{\alpha}(\overline{\Omega})$ is Banach, $\{u_m\}$ is convergent in $C^{\alpha}(\overline{\Omega})$, i.e., $\exists\bar{u}\in C^{\alpha}(\overline{\Omega})$ such that $u_m\rightarrow\bar{u}$ in $C^{\alpha}(\overline{\Omega})$.

In particular, $u_m\rightarrow\bar{u}$ uniformly. Hence, $u_m\rightarrow\bar{u}$ in $L^p(\Omega)$. But limits in $L^p$ are unique (a.e.) and $u_m\rightarrow u$ in $L^p(\Omega)$. Thus, $u=\bar{u}$ a.e.

Hence, $u$ agrees a.e. with the $C^{\alpha}(\overline{\Omega})$ function $\bar{u}$.
\end{enumerate}
\end{proof}

\begin{remark}
(Functions without zero boundary conditions) If in addition $\Omega$ has $C^1$ boundary, then Theorem \ref{Morrey_higher_regularity} \ref{higher_regularity} still holds for $u\in W^{1,p}(\Omega)$ with RHS $||Du||_p$ replaced by $||u||_{W^{1,p}}$.

Assumption that $\Omega$ has $C^1$ boundary cannot be omitted.
\end{remark}

\begin{definition*}
\textbf{(Embedding)} $X,Y$ Banach. We say that $X$ is embedded into $Y$, notation: $X\hookrightarrow Y$, if
\begin{enumerate}[label=(\roman*)]
\item $X\subseteq Y$,
\item $\exists C$ such that $||u||_Y\leq C||u||_X$.
\end{enumerate}
\end{definition*}

\begin{theorem}\label{Sobolev_embeddings}
%Thm 5.8
\emph{\textbf{(Sobolev embeddings)}} Let $k\in\mathbb{N}$, $p\in[1,\infty)$, $\Omega\subseteq\mathbb{R}^n$ open bounded with $C^1$ boundary. Then,
\begin{enumerate}[label=\alph*)]
\item\label{embedding_L} $k<\frac{n}{p}\Longrightarrow W^{k,p}(\Omega)\hookrightarrow L^q(\Omega)$, $\frac{1}{q}=\frac{1}{p}-\frac{k}{n}$;
%Professor wrote 1/q=1/p-1/n
\item\label{embedding_C} $k>\frac{n}{p}\Longrightarrow W^{k,p}(\Omega)\hookrightarrow C^{k-\left[\frac{n}{p}\right]-1,\gamma}(\overline{\Omega})$, where
\[\gamma=\left\{\begin{array}{rcl}\left[\frac{n}{p}\right]+1-\frac{n}{p}&\text{if}&\frac{n}{p}\notin\mathbb{N},\\\text{any el. of }(0,1)&\text{if}&\frac{n}{p}\in\mathbb{N}.\end{array}\right.\]
\end{enumerate}
\end{theorem}

$[x]$ means the integer part of $x\in\mathbb{R}$, $C^{m,\gamma}$ are $m$ times continuously differentiable functions with $D^{\alpha}u\in C^{\gamma}$, $|\alpha|\leq m$.

\begin{itemize}
\item $k=1$: \ref{embedding_L} is the Sobolev inequality, \ref{embedding_C} is Morrey's inequality.

\item Further examples next week.
\end{itemize}

%12/07
Functional analysis + Sobolev spaces = modern theory of PDEs.
\section{Existence and uniqueness for Poisson's equation with general \texorpdfstring{right hand side and boundary conditions}{RHS and BC}}\label{Poisson_general}
%Section 6
\subsection[The notion of weak solutions in \texorpdfstring{$H^1(\Omega)$}{H1}]{The notion of weak solutions in \texorpdfstring{$\boldsymbol{H^1(\Omega)}$}{H1}}
%Subsection 6.1
\begin{notation}
$H^1(\Omega)\coloneqq W^{1,2}(\Omega)$, $H_0^1(\Omega)\coloneqq W_0^{1,2}(\Omega)$.
\end{notation}

$H$ for Hilbert. Note $W^{1,2}$ Hilbert with inner product
\[\langle u,v\rangle=\int_{\Omega}u\cdot v+\int_{\Omega}\nabla u\cdot\nabla v,\]
\[||u||^2_{W^{1,2}}=\langle u,u\rangle.\]

\begin{definition*}
Let $\Omega\subseteq\mathbb{R}^n$ open bounded, $f\in L^2(\Omega)$, $g\in H^1(\Omega)$. $u\in H^1(\Omega)$ is a \textbf{weak solution} to
\begin{empheq}[left=\empheqlbrace]{alignat=2}
-\Delta u=f\ &\text{ in }&&\ \Omega\tag{P}\label{Poisson_H1}\\
u=g\ &\text{ on }&&\ \partial\Omega\tag{BC}\label{BC_H1}
\end{empheq}
if
\begin{empheq}[left=\empheqlbrace]{align}
\int_{\Omega}\nabla u\cdot\nabla\varphi&=\int_{\Omega}f\varphi\ \ \forall\varphi\in C_0^{\infty}(\Omega)\tag{P$'$}\label{Poisson_H1_weak}\\
u-g&\in H_0^1(\Omega)\tag{BC$'$}
\end{empheq}
\end{definition*}

\begin{note}
If $u$ smooth, \eqref{Poisson_H1} $\Rightarrow$ \eqref{Poisson_H1_weak} and conversely.

Integrating by parts and by the fundamental lemma,
\[\text{\eqref{Poisson_H1_weak}}\Longrightarrow\int_{\Omega}(-\Delta u-f)\varphi=0\ \ \forall\varphi\in C_0^{\infty}(\Omega)\Longrightarrow-\Delta u-f=0\text{ in }\Omega\Longrightarrow\text{\eqref{Poisson_H1}}.\]
\end{note}

In Section \ref{heat_equation}, we studied \eqref{Poisson_H1}, \eqref{BC_H1} in special cases:
\begin{itemize}
\item $g=0$, $\Omega=\mathbb{R}^n$;
\item $f=0$, $\Omega$ the halfspace or ball.
\end{itemize}
Now, can treat general $\Omega$, $f$ and $g$!

\subsection{Variational formulation (Dirichlet's principle)}
%Subsection 6.2

\begin{proposition}\label{solution_minimizer}
%Prop 6.1
Suppose $u\in g+H_0^1(\Omega)=\{g+\tilde{u}\,|\,\tilde{u}\in H_0^1(\Omega)\}$ is a minimizer of
\[J[u]\coloneqq\int_{\Omega}\left(\frac{1}{2}\big|Du(x)\big|^2-f(x)u(x)\right)\,dx\]
on $g+H_0^1(\Omega)$. Then $u$ is a weak solution to \eqref{Poisson_H1}, \eqref{BC_H1}.
\end{proposition}

Thus, the PDE is related to a variational problem. The PDE is called the ``Euler-Lagrange equation'' of the variational problem.

\begin{proof}
Suppose $u$ is a minimizer. Let $\varphi\in C_0^{\infty}(\Omega)$. Then $u+\epsilon\varphi\in g+H_0^1(\Omega)$ $\forall\epsilon\in\mathbb{R}$. So $u+\epsilon\varphi$ is an admissible competitor in the minimization.

Now look at $\epsilon\mapsto h(\epsilon)\coloneqq J[u+\epsilon\varphi]$, $h:\mathbb{R}\rightarrow\mathbb{R}$.

If $J$ is minimal at $u$, then $h$ is minimal at $0$. Hence,
\begin{multline*}
0=h'(0)=h'(\epsilon)|_{\epsilon=0}=\left.\frac{d}{d\epsilon}J[u+\epsilon\varphi]\right|_{\epsilon=0}=\left.\frac{d}{d\epsilon}\int_{\Omega}\left[\frac{1}{2}|Du+\epsilon D\varphi|^2-f\cdot(u+\epsilon\varphi)\right]\,dx\,\right|_{\epsilon=0}\\
=\left.\frac{d}{d\epsilon}\int_{\Omega}\left[\frac{1}{2}|Du|^2+\epsilon Du\cdot D\varphi+\frac{1}{2}\epsilon^2|D\varphi|^2-f\cdot u-\epsilon f\cdot\varphi\right]\,dx\,\right|_{\epsilon=0}\\
=\left.\int_{\Omega}\big[Du\cdot D\varphi+\epsilon|D\varphi|^2-f\cdot\varphi\big]\,dx\,\right|_{\epsilon=0}=\int_{\Omega}[Du\cdot D\varphi-f\varphi]\,dx.
\end{multline*}

True $\forall\varphi\in C_0^{\infty}(\Omega)$, so $u$ is a weak solution to \eqref{Poisson_H1}.
\end{proof}

\subsection{Abstract formulation of minimization problem and uniqueness}
%Subsection 6.3
$J$ is of form ``quadratic and linear'', so consider problems of the form
\[\text{Minimize }J[v]\coloneqq\frac{1}{2}a(v,v)-F(v)\text{ over }v\in K,\]
where $K$ is a subset of some vector space $V$, $a:V\times V\rightarrow\mathbb{R}$ bilinear, $F:V\rightarrow\mathbb{R}$ linear.

\begin{proposition}\label{uniqueness_minimizer}
%Prop. 6.2
\emph{\textbf{(Uniqueness)}} Suppose:
\begin{itemize}
\item $K\subseteq V$ affine subspace, i.e., $K=v_0+W$, $v_0\in V$, $W$ subspace of $V$;
\item $a:V\times V\rightarrow\mathbb{R}$ symmetric\footnote{$a(v,w)=a(w,v)$ $\forall w,v\in V$} and positive definite\footnote{$a(v,v)\geq0$, $a(v,v)=0\Leftrightarrow v=0$};
\end{itemize}
then the minimization problem has at most $1$ minimizer.
\end{proposition}

\begin{proof}
Suppose $u,u'$ minimizers. RTP: $u=u'$.

Consider $J[u+\epsilon(u-u')]$. Note $u-u'\in W$, so $u+\epsilon(u-u')\in K$ $\forall\epsilon\in\mathbb{R}$.

By proceeding as in the proof of Proposition \ref{solution_minimizer}, since $a$ is symmetric,
\begin{align*}
u\text{ minimizer}\Longrightarrow a(u,u-u')-F(u-u')&=0,\ \text{``Euler-Lagrange for }u\text{ with }\varphi=u-u'\text{''};\\
u'\text{ minimizer}\Longrightarrow a(u',u-u')-F(u-u')&=0,\ \text{``Euler-Lagrange for }u'\text{ with }\varphi=u-u'\text{''}.
\end{align*}

Hence, since $a$ is bilinear,
\[a(u-u',u-u')=a(u,u-u')-a(u',u-u')=0.\]

Since $a$ is positive definite,
\[u-u'=0.\]
\end{proof}

\subsection{Existence of minimizers for the abstract problem}
%Subsection 6.4
Add topological assumptions to $V$, $W$, $a$ and $F$.

\begin{theorem}\label{existence_minimizer}
%Thm 6.1
Let $V$ be a Banach space, $W$ a closed subspace, $v_0\in V$. Assume
\begin{itemize}
\item $a:V\times V\rightarrow\mathbb{R}$ bilinear, positive definite, symmetric, continuous, $V$-elliptic;
\item $F:V\rightarrow\mathbb{R}$ linear continuous.
\end{itemize}
Then, there exists a unique minimizer of $J[u]=\frac{1}{2}a(u,u)-F(u)$ on $K=v_0+W$.
\end{theorem}

\begin{definition*}
$a:V\times V\rightarrow\mathbb{R}$ is called \textbf{$\boldsymbol{V}$-elliptic} if $\exists c>0$ such that $a(v,v)\geq c||v||^2$ $\forall v\in V$.
\end{definition*}

This definition and the condition that $a$ be continuous link $a$ to the norm on the Banach space.

You can think of this as a ``modelling constraint'' on casting a PDE in useful functional-analytic form. In the Poisson equation case,
\[a(v,v)=\int_{\Omega}|Dv(x)|^2\,dx,\]
so $||v||^2$ must be closely related to this integral, essentially forcing you into Sobolev spaces.

\begin{proof}
(Existence) (Uniqueness follows from Proposition \ref{uniqueness_minimizer} even without the topological assumptions.)

\begin{enumerate}[label=\arabic*.]
\item $J$ is bounded from below, since for any $u\in V$,
\[J[u]=\frac{1}{2}a(u,u)-F(u)\underset{V\text{-ell.}}{\geq}\frac{c}{2}||u||^2-F(u)\underset{F\text{ cts.}}{\geq}\frac{c}{2}||u||^2-||F||_{V'}||u||,\]
where
\[||F||_{V'}=\sup_{v\in V\setminus\{0\}}\frac{|F(v)|}{||v||}<\infty,\]
since $F$ is continuous.

\[||F||_{V'}||u||=\sqrt{\frac{2}{c}}||F||_{V'}\sqrt{\frac{c}{2}}||u||\underset{ab\leq\frac{a^2+b^2}{2}}{\leq}\frac{1}{2}\left[\frac{2}{c}||F||_{V'}^2+\frac{c}{2}||u||^2\right],\]
\[J[u]\geq\frac{c}{4}||u||^2-\frac{1}{c}||F||_{V'}^2\geq-\frac{1}{c}||F||_{V'}^2.\]
Hence,
\[j_0\coloneqq\inf_{u\in K}J[u]>-\infty.\]

\item Let $u^{(n)}$ be a minimizing sequence, i.e., $\lim_{n\to\infty}J[u^{(n)}]=j_0$, $u^{(n)}\in K$. We may assume
\[J\big[u^{(n)}\big]\leq j_0+\frac{1}{n}\ \ \forall n.\]

\begin{claim*}
$u^{(n)}$ is Cauchy.
\end{claim*}

\begin{proof}
(Magic) Write $u_n$, $u_m$:
\begin{multline*}
c||u_n-u_m||^2\leq a(u_n-u_m,u_n-u_m)=2a(u_n,u_n)+2a(u_m,u_m)-a(u_m+u_n,u_m+u_m),\\
=2a(u_n,u_n)+2a(u_m,u_m)-4a\left(\frac{u_m+u_n}{2},\frac{u_m+u_n}{2}\right)=2\underbrace{\big(a(u_n,u_n)-2F(u_n)\big)}_{2F[u_n]}\\
+2\big(a(u_m,u_m)-2F(u_m)\big)-4\left(a\left(\frac{u_m+u_n}{2},\frac{u_m+u_n}{2}\right)-2F\left(\frac{u_m+u_n}{2}\right)\right)\\
=4J[u_n]+4J[u_m]-8J\left[\frac{u_m+u_n}{2}\right]\leq4\left(j_0+\frac{1}{n}\right)+4\left(j_0+\frac{1}{m}\right)-8j_0\\
\leq4\left(\frac{1}{n}+\frac{1}{m}\right)\xrightarrow[\min\{m,n\}\to\infty]{}0,
\end{multline*}
so $\{u_m\}$ is Cauchy.
\end{proof}
$V$ Banach implies $u_m\rightarrow u$ (``strong'' convergence in $V$) for some $u\in V$.

$K$ closed implies $u\in K$.

$u\mapsto a(u,u)$ and $u\mapsto F(u)$ continuous imply that $u\mapsto J[u]$ is continuous, so
\[J[u]=J\left[\lim_{n\to\infty}u_n\right]=\lim_{n\to\infty}J[u_n]=j_0.\]

Hence, $u$ is a minimizer of $J$.
\end{enumerate}
\end{proof}

\subsection{Application to Poisson's equation}
%Subsection 6.5
\begin{theorem}\label{Poisson_Sobolev}
%Thm 6.2
\emph{\textbf{(Existence and uniqueness for Poisson's equation with boundary conditions)}} $\Omega\subseteq\mathbb{R}^n$ open bounded, $g\in H^1(\Omega)$, $f\in L^2(\Omega)$. Then, there exists a unique weak solution to
\[\left\{\begin{array}{rcl}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]
\end{theorem}

\begin{proof}
($g=0$) Apply Theorem \ref{existence_minimizer} with $V=W=H_0^1(\Omega)$, $v_0=0$,
\[a(u,v)=\int_{\Omega}Du\cdot Dv,\hspace{3mm}F(u)=\int_{\Omega}f\cdot u.\]

\[J[u]=\frac{1}{2}a(u,u)-F(u)=\frac{1}{2}\int_{\Omega}|Du|^2-\int_{\Omega}f\cdot u.\]

Need to check assumptions of Theorem \ref{existence_minimizer}:
\begin{itemize}
\item $V$ Banach, since Sobolev spaces are Banach (Section \ref{Sobolev_spaces});
\item $a$ symmetric: trivial;
\item $a$ positive definite: $\int_{\Omega}|Du|^2=0$, $u\in H_0^1(\Omega)$ $\Rightarrow$ $u=0$;
\item $a$ continuous:
\[\big|a(u,v)\big|=\left|\int_{\Omega}Du\cdot Dv\right|\underset{\substack{\text{Cauchy-}\\\text{Schwarz}}}{\leq}||Du||_{L^2}\cdot||Dv||_{L^2}\leq||u||_{H_0^1}\cdot||v||_{H_0^1};\]
\item $F$ continuous:
\[|F(u)|=\left|\int_{\Omega}f\cdot u\right|\underset{\substack{\text{Cauchy-}\\\text{Schwarz}}}{\leq}||f||_{L^2}||u||_{L^2}\leq||f||_{L^2}||u||_{H_0^1};\]
\item $a$ $V$-elliptic: interesting! ($a$ comes from PDE, $V$ comes from function space we're using.)
\end{itemize}
\end{proof}

\begin{proposition}
%Prop. 6.3
\emph{\textbf{(Poincar\'{e} inequality)}} $\Omega\subseteq\mathbb{R}^n$ open bounded. $\exists C'(\Omega)>0$ such that
\[\int_{\Omega}|u|^2\leq C'(\Omega)\int_{\Omega}|Du|^2\ \ \forall u\in H_0^1(\Omega).\]
\end{proposition}

\begin{proof}
Follows from Sobolev's or Morrey's inequality. See class. Hence,
\[||u||_{H^1}^2=\int_{\Omega}\big(|u|^2+|Du|^2\big)\leq(C'+1)\int_{\Omega}|Du|^2=(C'+1)a(u,u),\]
\[\frac{1}{C'+1}||u||_{H^1}^2\leq a(u,u),\]
i.e., $a$ is $V$-elliptic.
\end{proof}

%14/07
\begin{proof}
(Existence in Theorem \ref{Poisson_Sobolev} with nonzero boundary conditions $u|_{\partial_{\Omega}}=g$)
%Thm 7.1

\begin{idea}
(First) $V=H^1(\Omega)$, $W=H_0^1(\Omega)$, $v_0=g$, so $K=g+H_0^1(\Omega)$ and $a,F$ as before.
\end{idea}

\begin{question}
Is $a$ $V$-elliptic? I.e., $\exists c>0$ such that
\[\int_{\Omega}|Du|^2=a(u,u)\geq c||u||_{H^1}^2=c\left(\int_{\Omega}|Du|^2+\int_{\Omega}|u|^2\right)\ \ \forall u\in H^1\text{?}\]
\end{question}

\begin{answer}
No! E.g., $u\equiv1$.
\end{answer}

\begin{idea}
(Second) ``Change of variables''
\[g+H_0^1\ni u\longmapsto u-g\eqqcolon\tilde{u}\in H_0^1.\]
\end{idea}

Re-write
\[J(u)=\frac{1}{2}a(u,u)-F(u)\overset{!}{=}\widetilde{J}(\tilde{u}).\]
\begin{multline*}
J(u)=\frac{1}{2}\int_{\Omega}\nabla u\cdot\nabla u-\int_{\Omega}fu\\
=\underbrace{\frac{1}{2}\int_{\Omega}\nabla u\cdot\nabla u-\int_{\Omega}\nabla u\cdot\nabla g+\frac{1}{2}\int_{\Omega}\nabla g\cdot\nabla g}_{\frac{1}{2}\int_{\Omega}|\nabla(u-g)|^2}+\underbrace{\int_{\Omega}\nabla u\cdot\nabla g}_{\mathclap{\int_{\Omega}\nabla(u-g)\cdot\nabla g+\int_{\Omega}|\nabla g|^2}}-\frac{1}{2}\int_{\Omega}|\nabla g|^2-\int_{\Omega}f\cdot(u-g)-\int_{\Omega}f\cdot g\\
=\underbrace{\frac{1}{2}\int_{\Omega}\nabla(u-g)\cdot\nabla(u-g)}_{\frac{1}{2}a(u-g,u-g)}-\underbrace{\left[\int_{\Omega}f\cdot(u-g)-\int_{\Omega}\nabla g\cdot\nabla(u-g)\right]}_{\widetilde{F}(u-g)\text{ with }\widetilde{F}(\tilde{u})\coloneqq\int_{\Omega}f\cdot\tilde{u}-\int_{\Omega}\nabla g\cdot\nabla\tilde{u}}+\underbrace{\left[\int_{\Omega}|\nabla g|^2-\int_{\Omega}f\cdot g\right]}_{\eqqcolon c_0}.
\end{multline*}
\[u\text{ minimizer of }J\text{ on }g+H_0^1\Longleftrightarrow\tilde{u}\coloneqq u-g\text{ minimizer of }\widetilde{J}(\tilde{u})=\frac{1}{2}a(\tilde{u},\tilde{u})-\widetilde{F}(\tilde{u})\text{ on }H_0^1.\]

For $\widetilde{J}$, take $V=W=H_0^1,v_0=0,a$ as before (already know that assumptions of Theorem \ref{existence_minimizer}, in particular $a$ is $V$-elliptic on $V=H_0^1$), new $\widetilde{F}$.

$\widetilde{F}$ linear: \checkmark

$\widetilde{F}$ continuous:
\[\big|\widetilde{F}(\tilde{u})\big|=\left|\int_{\Omega}f\tilde{u}-\int_{\Omega}\nabla g\cdot\nabla\tilde{u}\right|\underset{\substack{\text{Cauchy-}\\\text{Schwarz}}}{\leq}||f||_{L^2}||\tilde{u}||_{L^2}+||\nabla g||_{L^2}||\nabla\tilde{u}||_{L^2}\leq\big(||f||_{L^2}+||\nabla g||_{L^2}\big)\underbrace{||\tilde{u}||_{H_0^1}}_{\mathclap{\sqrt{||\tilde{u}||_{L^2}^2+||D\tilde{u}||_{L^2}^2}\hspace{8mm}}}.\]
\end{proof}

\begin{proof}
(Uniqueness of weak solutions in Theorem \ref{Poisson_Sobolev})
\[\left\{\begin{array}{rcl}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]

\begin{idea}
(General) (Both for classical and weak solutions): subtract 2 solutions, multiply by the difference, integrate.
\end{idea}

Suppose $u,u'$ weak solutions.
\[\int_{\Omega}Du\cdot D\varphi-\int_{\Omega}f\varphi=0\ \ \forall\varphi\in C_0^{\infty}(\Omega),\]
\[\int_{\Omega}Du'\cdot D\varphi-\int_{\Omega}f\varphi=0\ \ \forall\varphi\in C_0^{\infty}(\Omega),\]
\begin{equation}\tag{$*$}\label{Poisson_difference}
\int_{\Omega}D(u-u')\cdot D\varphi=0\ \ \forall\varphi\in C_0^{\infty}(\Omega).
\end{equation}

Would like to take $\varphi=u-u'$. Problem: $u-u'\notin C_0^{\infty}(\Omega)$ in general. But $u,u'\in g+H_0^1(\Omega)$. Hence, $u-u'\in H_0^1(\Omega)$.

Way out: take sequence $\varphi_f\in C_0^{\infty}$ with $\varphi_f\rightarrow u-u'$ in $H_0^1(\Omega)$.

(Exists since by definition, $H_0^1$ is the closure of $C_0^{\infty}$ in the $H^1$ norm.)

Apply \eqref{Poisson_difference} to $\varphi_j$:
\[0=\int_{\Omega}D(u-u')\cdot D\varphi_j\xrightarrow[j\to\infty]{}\int_{\Omega}D(u-u')\cdot D(u-u')=a(u-u',u-u').\]
Since $a$ is positive definite on $H_0^1$,
\[u-u'=0.\]
\end{proof}

\begin{proof}
(A more abstract proof of uniqueness of weak solutions)
\begin{align*}
u\text{ weak solution to \eqref{Poisson_H1}, \eqref{BC_H1}}&\Longleftrightarrow\int_{\Omega}Du\cdot D\varphi-\int_{\Omega}f\varphi=0\ \ \forall\varphi\in C_0^{\infty}(\Omega)\\
&\Longleftrightarrow a(u,\varphi)-F(\varphi)=0\ \ \forall\varphi\in C_0^{\infty}(\Omega).
\end{align*}
Since $C_0^{\infty}$ is a dense subset of $W=H_0^1$, if $a$ and $F$ are continuous,
\begin{equation}\tag{$*$}\label{abstract_weak}
u\text{ weak solution to \eqref{Poisson_H1}, \eqref{BC_H1}}\Longleftrightarrow a(u,\varphi)-F(\varphi)=0\ \ \forall\varphi\in W
\end{equation}
\end{proof}

\begin{lemma}\label{abstract_uniqueness}
%Lemma 6.2
\emph{\textbf{(Abstract uniqueness of weak solutions)}} Under the assumptions of Theorem \ref{existence_minimizer}, $\exists$ a unique $u\in K=v_0+W$ such that \eqref{abstract_weak} holds.
\end{lemma}

\begin{proof}
Suppose $u,u'\in K$ satisfy \eqref{abstract_weak}. Then,
\[a(u,\varphi)-F(\varphi)=0\ \ \forall\varphi\in W,\]
\[a(u',\varphi)-F(\varphi)=0\ \ \forall\varphi\in W,\]
\[a(u-u',\varphi)=0\ \ \forall\varphi\in W,\]
since $a$ is bilinear. Taking $\varphi=u-u'\in W$,
\[a(u-u',u-u')=0.\]
Since $a$ is positive definite,
\[u-u'=0.\]
\end{proof}

\begin{remark}
Method not limited to
\[\left\{\begin{array}{rcl}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]

Could consider, e.g.,
\[-\diver\big(A(x)\nabla u\big)=f,\ \ A(x)\in M^{n\times n},\]
$A$ symmetric,
\[c|\xi|^2\leq\langle\xi,A(x)\xi\rangle\leq C|\xi|^2\]
$\forall x$ and some $c,C'>0$.
\end{remark}

\section{Lax-Milgram theorem}
%Section 7
\begin{example*}
(Motivating example: Stokes equation) $\Omega\subseteq\mathbb{R}^n$ open bounded,
\begin{empheq}[left=\empheqlbrace]{alignat=2}
-\Delta u+b\cdot\nabla u=f\ &\text{ in }&&\ \Omega,\tag{S}\\
u=0\ &\text{ on }&&\ \partial\Omega;\tag{BC}
\end{empheq}
$b\in L^{\infty}(\Omega;\mathbb{R}^n)$ bounded vector field.

This arises by linearization of the stationary Navier-Stokes equation from fluid dynamics.

$u:\Omega\subseteq\mathbb{R}^3\rightarrow\mathbb{R}^3$,
\begin{equation}\tag{Navier-Stokes}
\begin{array}{c}
u_t+(u\cdot\nabla)u-\nu\Delta u=-\nabla p,\\
\diver u=0.
\end{array}
\end{equation}
Stationary solutions:
\[-\nu\Delta u+(u\cdot\nabla)u=-\nabla p.\]

Linearize at $u_0$, i.e., $u=u_0+\tilde{u}$:
\[-\nu\Delta\tilde{u}+u_0\cdot\nabla\tilde{u}+\nabla u_0\cdot\tilde{u}=f,\]
i.e., equation of form
\[-\nu\Delta\tilde{u}+b\cdot\nabla\tilde{u}+c\tilde{u}=f.\]

Weak formulation: $u\in H_0^1(\Omega)$,
\[-\Delta u+b\cdot\nabla u=f,\]
multiplying by $\varphi\in C_0^{\infty}$ and integrating:
\[\underbrace{\int_{\Omega}\nabla u\cdot\nabla\varphi+\int_{\Omega}(b\cdot\nabla u)\varphi}_{\eqqcolon a(u,\varphi)}=\underbrace{\int_{\Omega}f\varphi}_{\eqqcolon F(\varphi)}\ \ \forall\varphi\in C_0^{\infty}(\Omega),\]
$a:V\times V\rightarrow\mathbb{R}$ bilinear, $F:V\rightarrow\mathbb{R}$ linear, $V=H_0^1(\Omega)$.

\begin{question}
Is the theory of Section \ref{Poisson_general} applicable?
\end{question}

\begin{answer}
No, because the bilinear form is not symmetric (the $b$ term has a gradient on $u$ but not on $\varphi$).
\end{answer}

\begin{multline*}
a(u,v)-a(v,u)=\int_{\Omega}\nabla u\cdot\nabla v+\int_{\Omega}(b\cdot\nabla u)v-\int_{\Omega}\nabla v\cdot\nabla u-\underbrace{\int_{\Omega}(b\cdot\nabla v)u}_{\text{parts}}\\
=\int_{\Omega}(b\cdot\nabla u)v-\int_{\Omega}\underbrace{\diver(bu)}_{\mathclap{(\diver b)u+b\cdot\nabla u}}v=\underbrace{2\int_{\Omega}(b\cdot\nabla u)v}_{\neq0}+\underbrace{\int_{\Omega}(\diver b)uv}_{=0},
\end{multline*}
choosing $v=b\cdot\nabla u$ and assuming $b$ to be divergence free (in applications to Navier-Stokes).

Cannot look for solutions by minimizing a function as $\frac{1}{2}a(u,u)-F(u)$, since Euler-Lagrange equations only depend on symmetric part of functional.
\end{example*}

\begin{example*}
In $\mathbb{R}^n$,
\[\underset{x\in\mathbb{R}^n}{\text{minimize }}\frac{1}{2}\langle x,Ax\rangle-\langle b,x\rangle,\]
\[\frac{A+A^{\intercal}}{2}x=b.\]

To solve nonsymmetric problems of form
\[a(u,w)=F(w)\ \ \forall w\in W,\]
need different approach: Lax-Milgram theorem.
\end{example*}

%19/07
\begin{theorem}
%Thm 7.1
\emph{\textbf{(Lax-Milgram)}} $V$ Banach, $W$ closed subspace, $K=v_0+W$, $v_0\in V$, $a:V\times V\rightarrow\mathbb{R}$ bilinear, continuous, $V$-elliptic, i.e., $\exists\alpha>0$ such that $a(v,v)\geq\alpha||v||^2$ $\forall v\in V$, $F:V\rightarrow\mathbb{R}$ linear, continuous.

Then, there exists a unique $u\in K$ such that
\[a(u,w)=F(w)\ \ \forall w\in W.\]
Moreover, we have, if $v_0=0$,
\[||u||\leq\frac{1}{\alpha}||F||_{V'}.\]
\end{theorem}

\begin{remark}
If $a$ symmetric, this is Theorem \ref{existence_minimizer} (with the abstract version of uniqueness from Lemma \ref{abstract_uniqueness}).
\end{remark}

\begin{example*}
\begin{empheq}[left=\empheqlbrace]{alignat=2}
-\Delta u+b\cdot\nabla u=f\ &\text{ in }&&\ \Omega,\tag{S}\label{Stokes}\\
u=0\ &\text{ on }&&\ \partial\Omega.\tag{BC}\label{Stokes_BC}
\end{empheq}

If $f\in L^2(\Omega)$, $b\in L^{\infty}(\Omega;\mathbb{R}^n)$, $||b||_{L^{\infty}}$ sufficiently small, then \eqref{Stokes}, \eqref{Stokes_BC} has a unique weak solution.

\begin{proof}
Recall $u\in H_0^1(\Omega)$ is a weak solution if
\[\int_{\Omega}\nabla u\cdot\nabla\varphi+b\cdot\nabla u\cdot\varphi=\int_{\Omega}f\varphi\ \ \forall\varphi\in C_0^{\infty}(\Omega).\]
Since $C_0^{\infty}$ is dense in $H_0^1$, this is equivalent to
\[\underbrace{\int_{\Omega}\nabla u\cdot\nabla w+b\cdot\nabla u\cdot w}_{\eqqcolon a(u,w)}=\underbrace{\int_{\Omega}fw}_{\eqqcolon F(w)}\ \ \forall w\in\underbrace{H_0^1(\Omega)}_{\eqqcolon W}.\]
It takes the form
\[a(u,w)=F(w)\ \ \forall w\in W,\]
which is covered by Lax-Milgram theorem with $V=W$, $v_0=0$, $K=W$.

Need to check assumtions on $a$ and $F$.

$a$ bilinear \checkmark

$a$ continuous:

$1$\textsuperscript{st} term $\int_{\Omega}\nabla u\cdot\nabla w$ \checkmark (see Theorem \ref{existence_minimizer})

$2$\textsuperscript{nd} term $\int_{\Omega}b\cdot\nabla u\cdot w$:
\[\left|\int_{\Omega}b\cdot\nabla u\cdot w\right|\leq||b||_{\infty}\int_{\Omega}|\nabla u|\cdot|w|\underset{\text{C-S}}{\leq}||b||_{\infty}||\nabla u||_{L^2}||w||_{L^2}\leq||b||_{\infty}||u||_{H^1}||w||_{H^1}.\ \checkmark\]

$V$-elliptic? Yes, but only if $||b||_{\infty}$ is small:
\[a(u,u)=\int_{\Omega}|\nabla u|^2+\int_{\Omega}b\cdot\nabla u\cdot u\geq||\nabla u||_{L^2}^2-||b||_{\infty}||\nabla u||_{L^2}||u||_{L^2}.\]
Use $a\cdot b\leq\frac{1}{2}(a^2+b^2)$:
\[||\nabla u||_{L^2}||u||_{L^2}=\frac{1}{\sqrt{||b||_{\infty}}}||\nabla u||_{L^2}\cdot\sqrt{||b||_{\infty}}||u||_{L^2}\leq\frac{1}{2||b||_{\infty}}||\nabla u||_{L^2}^2+\frac{||b||_{\infty}}{2}||u||_{L^2}^2.\]
By Poincar\'{e} inequality, $||u||_{L^2}^2\leq C||\nabla u||_{L^2}^2$ and $||u||_{H^1}^2\leq(C+1)||\nabla u||_{L^2}^2$. Hence,
\[a(u,u)\geq\frac{1}{2}||\nabla u||_{L^2}^2-\frac{||b||_{\infty}^2}{2}||u||_{L^2}^2\geq\left(\frac{1}{2}-\frac{C||b||_{\infty}^2}{2}\right)||\nabla u||_{L^2}^2\geq\underbrace{\left(\frac{1}{2}-\frac{C||b||_{\infty}^2}{2}\right)}_{\mathclap{>0\text{ if }||b||_{\infty}\text{ small enough}}}\frac{1}{C+1}||u||_{H^1}^2.\]

$F$ linear \checkmark continuous \checkmark (see Theorem \ref{existence_minimizer})

By Lax-Milgram, $\exists$ unique weak solution to \eqref{Stokes}, \eqref{Stokes_BC}.
\end{proof}
\end{example*}

\begin{proof}
(Estimate on $u$) Apply equation with $w=u$:
\[\alpha||u||_V^2\underset{V\text{-ell}}{\leq}a(u,u)=F(u)\leq||u||_V||F||_{V'}.\]
\end{proof}

\textbf{Meaning of such an estimate.}

Suppose $\widetilde{F}$ perturbation of $F$ (e.g., numerical approximation error, inaccurate data).

$u$ solution to $a(u,w)=F(w)$ $\forall w\in W$,

$\tilde{u}$ solution to $a(\tilde{u},w)=\widetilde{F}(w)$ $\forall w\in W$.

Since $a$ is lineal in the $1$\textsuperscript{st} argument, $a(u-\tilde{u},w)=(F-\widetilde{F})(w)$ $\forall w\in W$.

Hence,
\[||u-\tilde{u}||\leq\frac{1}{\alpha}||F-\widetilde{F}||_{V'}.\]

So, if RHS of equation is perturbed a little, then the solution only changes a little (``stability result'').

\begin{proof}
(Existence in Lax-Milgram theorem)
\begin{idea}
\begin{itemize}
\item Continuation argument, starting from symmetric case;
\item use Banach's fixed point theorem.
\end{itemize}
\end{idea}

Introduce
\[a_t(u,v)\coloneqq a_0(u,v)+tb(u,v)\ \ t\in[0,1].\]

$a_0$ is the symmetric part of $a$:
\[a_0=\frac{1}{2}\big(a(u,v)+a(v,u)\big);\]
$b$ is the antisymmetric part of $a$:
\[b=\frac{1}{2}\big(a(u,v)-a(v,u)\big).\]

Note $a_1=a_t|_{t=1}=a_0+b=a$, $a_t$ is $V$-elliptic since $a_t(u,u)=a(u,u)$ $\forall t$.

We'll show:
\begin{enumerate}[label=(\arabic*)]
\item the problem
\[a_t(u,w)=F(w)\ \ \forall w\in W\]
has a unique solution for $t=0$;
\item if the problem
\[a_t(u,w)=F(w)\ \ \forall w\in W\]
has a unique solution for some $t\in[0,1]$, then
\[a_{\tau}(u,w)=F(w)\ \ \forall w\in W\]
has a unique solution for all $\tau\in[t,t+\delta t]$ for some $\delta t>0$, $\delta t$ independent of $t$.
\end{enumerate}

Like an induction argument:

$t=0$ is the start of induction $n=0$,

$t\Rightarrow[t,t+\delta t]$ is the step of induction $n\Rightarrow n+1$.

\begin{proof}
\begin{enumerate}[label=(\arabic*)]
\item $a_0$ symmetric so claim follows from Theorem \ref{existence_minimizer}.

\item Want to solve
\[a_{\tau}(u,w)=a_t(u,w)+(\tau-t)b(u,w)\overset{!}{=}F(w)\ \ \forall w\in W,\]
which is equivalent to
\begin{equation}\tag{$**$}\label{LM_u-dep}
a_t(u,w)\overset{!}{=}F(w)-(\tau-t)b(u,w)\eqqcolon F_u(w)\ \ \forall w\in W.
\end{equation}
$F_u(w)$ is the new RHS which depends on $u$.

Can solve
\begin{equation}\tag{$*$}\label{LM_phi-dep}
a_t(u,w)\overset{!}{=}F_{\varphi}(w)\ \ \forall w\in W,
\end{equation}
$\varphi$ any fixed element of $V$.

Solution map:
\begin{align*}
T:V&\longrightarrow K\subseteq V.\\
\varphi&\longmapsto u\text{ solution to \eqref{LM_phi-dep}}
\end{align*}

Any fixed point of the solution map $T$, i.e., $u$ such that $T(u)=u$, solves \eqref{LM_u-dep}. Apply Banach's fixed point theorem to $T$.

\begin{theorem*}
\emph{\textbf{(Banach's fixed point)}} Suppose $V$ Banach, $T:V\rightarrow V$ contraction, i.e., $\forall x,y\in V$
\[\big|\big|T(x)-T(y)\big|\big|\leq\eta||x-y||\]
for some $\eta\in(0,1)$. Then $T$ has a unique fixed point, i.e., $x_*\in V$ such that $T(x_*)=x_*$.
\end{theorem*}

Need to check that $T$ is a contraction (if $\tau$ is close to $t$).
\begin{multline*}
\big|\big|T(\varphi_1)-T(\varphi_2)\big|\big|\underset{\substack{\text{stability}\\\text{result}}}{\leq}\frac{1}{\alpha}||F_{\varphi_1}-F_{\varphi_2}||_{V'}\underset{\substack{\text{def. of}\\||\,\cdot\,||_{V'}}}{=}\frac{1}{\alpha}\sup_{\substack{v\in V\\||v||=1}}\big|F_{\varphi_1}(v)-F_{\varphi_2}(v)\big|\\
=\frac{1}{\alpha}\sup_{\substack{v\in V\\||v||=1}}\Big|\big[F(v)-(\tau-t)b(\varphi_1,v)\big]-\big[F(v)-(\tau-t)b(\varphi_2,v)\big]\Big|\\
=\frac{|\tau-t|}{\alpha}\sup_{\substack{v\in V\\||v||=1}}\big|b(\varphi_1-\varphi_2,v)\big|\leq\underbrace{\frac{|\tau-t|}{\alpha}C_a}_{\eqqcolon\eta}||\varphi_1-\varphi_2||.
\end{multline*}
$\eta\leq\frac{1}{2}$ provided $\tau\in[t,t+\frac{\alpha}{2C_a}]$.

$C_a$ is the constant from continuity of $a$, i.e., such that $|a(u,v)|\leq C_a||u||\cdot||v||$.

So for $\tau$ in above interval, $T$ is a contraction.

BFT implies $\exists$ unique fixed point $u\in V$ such that $T(u)=u$.

Since $T(u)\in K$ $\forall u\in V$, $u\in K$, i.e., $u$ solution to \eqref{LM_u-dep}.
\end{enumerate}
\end{proof}
\end{proof}

%21/07
\section{Neumann boundary conditions}
%Section 8
Consider
\begin{empheq}[left=\empheqlbrace]{alignat=2}
-\Delta u=f\ &\text{ in }&&\ \Omega,\tag{P}\label{Poisson_Neumann}\\
\frac{\partial u}{\partial\nu}=g\ &\text{ on }&&\ \partial\Omega,\tag{N}\label{Neumann_Neumann}
\end{empheq}
where $\frac{\partial u}{\partial\nu}\coloneqq\nabla u(x)\cdot\nu$ is the normal derivative; $\Omega\subseteq\mathbb{R}^n$ open, bounded, connected, $C^1$ boundary.

[Recall physical meaning: e.g., $u$ is the temperature and $\frac{\partial u}{\partial\nu}(x)$ is the heat flux through boundary at $x$] [$g=0$ means the domain is insulated] [solutions to \eqref{Poisson_Neumann}, \eqref{Neumann_Neumann} are stationary solutions to heat equation $\frac{\partial u}{\partial t}-\Delta u=f$ in $\Omega$, $\frac{\partial u}{\partial\nu}=g$ on $\partial\Omega$].

Problem for Sobolev space/weak solution setting: we're used to looking for solutions $u\in H^1(\Omega)$, but this only means $\nabla u\in L^2(\Omega)$, so $\nabla u|_{\partial\Omega}$ undefined ($\partial\Omega$ has measure $0$).

The trace theorem gave us $u|_{\partial\Omega}\in L^2(\partial\Omega)$ if $\nabla u\in L^2(\Omega)$, but no info on $\nabla|_{\partial\Omega}$.

$1$\textsuperscript{st} attempt: work in Sobolev space $V=H^2(\Omega)=W^{2,2}(\Omega)$,
\[||u||_{H^2}^2=||u||_{L^2}^2+||Du||_{L^2}^2+||D^2u||_{L^2}^2.\]
Then $\nabla u|_{\partial\Omega}$ well defined as element of $L^2(\partial\Omega)$, by trace theorem. But then $a(u,v)=\int_{\Omega}\nabla u\cdot\nabla v$ is not $V$-elliptic, i.e., $\nexists c$ such that $a(u,u)\geq c||u||_{H^1}^2$.

$2$\textsuperscript{nd} attempt: figure out a notion of weak solution:

suppose $-\Delta u=f$ in $\Omega$, $\frac{\partial u}{\partial\nu}=g$ on $\partial\Omega$, $u\in C^2(\Omega)\cap C^1(\overline{\Omega})$.

Multiply with a test function $\varphi\in C^1(\overline{\Omega})$ and integrate:
\[0=\int_{\Omega}(-\Delta u-f)\cdot\varphi=\int_{\Omega}\nabla u\cdot\nabla\varphi-\int_{\partial\Omega}\underbrace{\frac{\partial u}{\partial\nu}}_{\mathclap{=g\text{ by BC}}}\cdot\varphi\,dS-\int_{\Omega}f\cdot\varphi.\]

Note. The RHS makes sense for $u\in H^1(\Omega)$!

\begin{definition}
\textbf{(Weak solution)} Let $\Omega\subseteq\mathbb{R}^n$ be open bounded connected with $C^1$ boundary, $f\in L^2(\Omega)$, $g\in L^2(\partial\Omega)$. A function $u\in H^1(\Omega)$ is called a \textbf{weak solution} to \eqref{Poisson_Neumann}, \eqref{Neumann_Neumann} if
\[\int_{\Omega}\nabla u\cdot\nabla\varphi=\int_{\partial\Omega}g\cdot\varphi\,dS+\int_{\Omega}f\cdot\varphi\ \ \forall\varphi\in C^1(\overline{\Omega})\]
or, equivalently, since $C^1(\overline{\Omega})$ dense in $H^1(\Omega)$,
\[\int_{\Omega}\nabla u\cdot\nabla\varphi=\int_{\partial\Omega}g\cdot T(\varphi)\,dS+\int_{\Omega}f\cdot\varphi\ \ \forall\varphi\in H^1(\Omega),\]
where $T:H^1(\Omega)\rightarrow L^2(\partial\Omega)$ is the trace operator (see Theorem \ref{trace_operator}) which, for $\varphi\in C^1(\overline{\Omega})$, is $T(\varphi)=\varphi|_{\partial\Omega}$.
\end{definition}

\begin{question}
Do there always exist weak solutions?
\end{question}

\begin{answer}
No. Take e.g. $\varphi\equiv1$.

\[\exists\text{ a weak solution }u\Longrightarrow\int_{\Omega}\nabla u\cdot\underbrace{\nabla1}_{=0}=\int_{\partial\Omega}g\,dS+\int_{\Omega}f\Longleftrightarrow0=\int_{\partial\Omega}g\,dS+\int_{\Omega}f,\]
\begin{equation}\tag{$*$}\label{outflux}
\Longleftrightarrow-\int_{\partial\Omega}g\,dS=\int_{\Omega}f.
\end{equation}
I.e., \eqref{outflux} is a necessary condition for the existence of weak solutions.
\end{answer}

\textbf{Physical interpretation.} $\exists$ solution to \eqref{Poisson_Neumann}, \eqref{Neumann_Neumann} $\Leftrightarrow$ $\exists$ stationary solution to
\[\left\{\begin{array}{rcl}\displaystyle{\frac{\partial u}{\partial t}-\Delta u=f}&\text{in}&\Omega,\\\displaystyle{\frac{\partial u}{\partial\nu}=g}&\text{on}&\partial\Omega.\end{array}\right.\]

Heat equation, $-\frac{\partial u}{\partial\nu}(x)$ outflux of heat through $x\in\partial\Omega$, $f(x)$ heat supplied at $x\in\Omega$.

\eqref{outflux} says that total outflux equals total amount of heat supplied. Thus for the heat equation to have a stationary solution, heat supply must balance outflux.

\begin{theorem}\label{Neumann_existence}
%Thm 8.1
Let $\Omega$, $f$, $g$ be as in the definition of weak solution and assume \eqref{outflux}. Then there exists an up to an additive constant unique weak solution to \eqref{Poisson_Neumann}, \eqref{Neumann_Neumann}.
\end{theorem}

\begin{idea}
Use variational methods or Lax-Milgram in a suitable space.
\end{idea}
\[\underbrace{\int_{\Omega}\nabla u\cdot\nabla\varphi}_{\eqqcolon a(u,\varphi)}=\underbrace{\int_{\Omega}f\varphi+\int_{\partial\Omega}gT(\varphi)}_{\eqqcolon F(\varphi)}\ \ \forall\varphi\in V.\]

Minor issue: $a$ not $V$-elliptic on $H^1$, i.e., $\nexists c>0$ such that $a(u,u)\geq c||u||_{H^1}$ because for $u\equiv\text{const}\neq0$, $\text{LHS}=\int_{\Omega}|\nabla u|^2=0$, but $\text{RHS}>0$.

Way out: exclude constants, by taking
\begin{equation}\tag{$**$}\label{exclude_constants}
V\coloneqq\left\{u\in H^1(\Omega)\,\left|\,\int_{\Omega}u\cdot1=0\right.\right\}.
\end{equation}
For this $V$, $a$ is $V$-elliptic, because of following theorem.

\begin{theorem}
%Thm 8.2
\emph{\textbf{(Poincar\'{e}-Wirtinger inequality)}} $\Omega\subseteq\mathbb{R}^n$ open, bounded, connected with $C^1$ boundary, $1\leq p<\infty$. Then, $\exists c=c(p,\Omega)$ such that
\[||u-\bar{u}||_{L^p(\Omega)}\leq c||Du||_{L^p(\Omega)}\ \ \forall u\in W^{1,p}(\Omega),\]
where
\[\bar{u}=\frac{1}{|\Omega|}\int_{\Omega}u.\]

In particular, by setting $p=2$,
\[||u||_{L^2(\Omega)}\leq c||Du||_{L^2(\Omega)}\ \ \forall u\in V.\]
(Note $\bar{u}=0$ for $u\in V$.)
\end{theorem}

\begin{proof}
(Theorem \ref{Neumann_existence}) Apply Theorem \ref{existence_minimizer} or Lax-Milgram with $V$ as in \eqref{exclude_constants}, $W=V$, $v_0=0$, $a,F$ as above.

$a$ symmetric, bilinear, $V$-elliptic, continuous: \checkmark

$F$ continuous:
\begin{multline*}
\big|F(\varphi)\big|=\left|\int_{\Omega}f\varphi+\int_{\partial\Omega}gT(\varphi)\right|\underset{\text{C-S}}{\leq}||f||_{L^2}||\varphi||_{L^2}+||g||_{L^2(\partial\Omega)}\big|\big|T(\varphi)\big|\big|_{L^2(\partial\Omega)}\\
\leq\max\big\{||f||_{L^2},C||g||_{L^2(\partial\Omega)}\big\}\cdot||\varphi||_{H^1(\Omega)},
\end{multline*}
since $||T(\varphi)||_{L^2(\partial\Omega)}\leq C||\varphi||_{H^1(\Omega)}$ by Theorem \ref{trace_operator}.

Hence $\exists!u\in V=H^1(\Omega)\cap\{\int_{\Omega}u=0\}$ such that
\begin{equation}\tag{W}\label{LM_trace}
\int_{\Omega}\nabla u\cdot\nabla\varphi=a(u,\varphi)=F(\varphi)=\int_{\Omega}f\cdot\varphi+\int_{\partial\Omega}g\cdot T(\varphi)\ \ \forall\varphi\in V=H^1(\Omega)\cap\left\{\int_{\Omega}\varphi=0\right\}.
\end{equation}

Now suppose $\varphi\in H^1(\Omega)$ (without $\int_{\Omega}\varphi=0$). Write
\[\varphi=(\varphi-\bar{\varphi})+\bar{\varphi},\hspace{5mm}\tilde{\varphi}\coloneqq\varphi-\bar{\varphi}\in V,\hspace{5mm}\bar{\varphi}=\frac{1}{|\Omega|}\int_{\Omega}\varphi\equiv\text{constant}.\]

By the assumption that $f,g$ satisfy \eqref{outflux},
\begin{multline*}
\int_{\Omega}\nabla u\cdot\nabla\varphi=\int_{\Omega}\nabla u\cdot\nabla\tilde{\varphi}\underset{\text{\eqref{LM_trace}}}{=}\int_{\Omega}f\tilde{\varphi}+\int_{\partial\Omega}g\cdot T(\tilde{\varphi})\\
\underset{\text{\eqref{outflux}}}{=}\int_{\Omega}f\tilde{\varphi}+\int_{\partial\Omega}g\cdot T(\tilde{\varphi})+\underbrace{\int_{\Omega}f\cdot\bar{\varphi}+\int_{\partial\Omega}g\cdot T(\bar{\varphi})}_{=0}=\int_{\Omega}f\underbrace{(\tilde{\varphi}+\bar{\varphi})}_{=\varphi}+\int_{\partial\Omega}g\cdot T\underbrace{(\tilde{\varphi}+\bar{\varphi})}_{=\varphi}.
\end{multline*}
So \eqref{LM_trace} in fact holds $\forall\varphi\in H^1(\Omega)$, i.e., $u$ is a weak solution to \eqref{Poisson_Neumann}, \eqref{Neumann_Neumann}.
\end{proof}

%26/07
\section{Regularity}
%Section 9
So far, have settled existence and uniqueness of weak solutions to PDE's like
\[\left\{\begin{array}{rcl}-\Delta u=g&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]
\begin{recall}
$u$ is a weak solution if $u\in H^1(\Omega)=W^{1,2}(\Omega)$ and
\[\left\{\begin{array}{l}\displaystyle{\int_{\Omega}\nabla u\cdot\nabla v=\int_{\Omega}fv\ \ \forall v\in C_0^{\infty}(\Omega)\text{ or equivalently }H_0^1(\Omega),}\\u-g\in H_0^1(\Omega).\end{array}\right.\]

Theorem \ref{Poisson_Sobolev}: existence and uniqueness if $g\in H^1(\Omega),f\in L^2(\Omega)$.
\end{recall}

Open problem:
\begin{align*}
-\Delta:&\{\text{functions with 2 weak derivatives in }L^2\}=W^{2,2}\longrightarrow L^2,\\
(-\Delta)^{-1}:&L^2\overset{?}{\longrightarrow}\{\text{functions with 2 weak derivatives in }L^2\}=W^{2,2}.
\end{align*}

So far, we only know
\begin{align*}
(-\Delta)^{-1}:L^2&\longrightarrow\{\text{functions with 1 weak derivative in }L^2\}=W^{1,2}.\\
f&\longmapsto u
\end{align*}

Deep fact: indeed $(-\Delta)^{-1}:L^2\rightarrow W^{2,2}$ (for nice $\Omega$ and $g$).

Weak solutions have ``higher regularity''.

For $g=0$:
\[-\Delta:H^2(\Omega)\cap H_0^1(\Omega)\overset{\sim}{\longrightarrow}L^2(\Omega)\]
is an isomorphism, continuous in both directions.

Completes the functional-analytic view of PDEs as $\infty$D versions of Linear Algebra problems in Sobolev spaces.
\[\begin{tikzcd}\text{Linear Algebra}\arrow[d,shift right,shift right,"\text{theory}",swap]&Ax\overset{!}{=}b&\text{unique solution }\forall b\Leftrightarrow A:\mathbb{R}^n\rightarrow\mathbb{R}^n\text{ invertible},\\\text{PDE}\arrow[u,shift right, shift right,"\text{numerics}",swap]&-\Delta u=f&\text{unique solution }\forall f\Leftrightarrow-\Delta:H^2\cap H_0^1\rightarrow L^2\text{ invertible}.\end{tikzcd}\]

\begin{warning}
Proving higher regularity is not trivial. Since the property of being a weak solution is very indirect [... integrands of $\nabla u$ times gradients of test functions equals such that ...]
\end{warning}

\subsection{Difference quotients}
%Subsection 9.1
Let $\Omega\subseteq\mathbb{R}^n$ open, $\Omega'\subset\subset\Omega$ (i.e., $\overline{\Omega'}\subseteq\Omega$, $\overline{\Omega'}$ compact). For $x'\in\Omega'$, $k\in\mathbb{R}$, $|h|<\dist(\Omega',\partial\Omega)$, can define the \textbf{difference quotient}
\[\partial_i^hu(x)\coloneqq\frac{u(x+h\vec{e}_i)-u(x)}{h},\]
\[\vec{e}_i=(0,\ldots,0,\underbrace{1}_{\mathclap{i-\text{th pos.}}},0,\ldots,0).\]
$\partial_i^hu\in L^p(\Omega')$ if $u\in L^p(\Omega)$,
\[D^hu\coloneqq(\partial_1^hu,\ldots,\partial_n^hu)\in L^p(\Omega';\mathbb{R}^n).\]

\begin{lemma}\label{uniform_bound}
%Lemma 9.1
\emph{\textbf{(Uniform bound on difference quotients implies existence of weak derivatives)}}
\begin{enumerate}[label=(\roman*)]
\item\label{uniform_bound_difference} For $1\leq p<\infty$ and $u\in W^{1,p}(\Omega),$
\[||D^hu||_{L^p(\Omega')}^p=\sum_i||\partial_i^hu||_{L^p(\Omega')}^p\leq\sum_i||\partial_iu||_{L^p(\Omega)}^p.\]

\item\label{uniform_bound_differential} For $1<p<\infty$ and $u\in L^p(\Omega)$, if $||D^hu||_{L^p(\Omega')}\leq C$ for some constant $C$ and all $|h|<\dist(\Omega',\partial\Omega)$, then
\[u\in W^{1,p}(\Omega'),\hspace{5mm}||Du||_{L^p(\Omega')}\leq C.\]
\end{enumerate}
\end{lemma}

\begin{proof}
\begin{enumerate}[label=(\roman*)]
\item By Meyes-Serrin (Theorem \ref{Meyers_Serrin}), can assume w.l.o.g. $u$ smooth.
\[u(x+he_i)-u(x)\underset{\text{FTC}}{=}\int_0^1\frac{d}{dt}u(x+the_i)\,dt\underset{\text{chain}}{=}\int_0^1\underbrace{\nabla u(x+the_i)\cdot he_i}_{h\partial_iu(x+the_i)}dt,\]
\[\left|\frac{u(x+he_i)-u(x)}{h}\right|\leq\int_0^1\big|\partial_iu(x+the_i)\big|\,dt,\]
\begin{multline*}
\int_{\Omega'}\left|\frac{u(x+he_i)-u(x)}{h}\right|^pdx\leq\int_{\Omega'}\left(\int_0^11\cdot\big|\partial_iu(x+the_i)\big|dt\right)^pdx\\
\underset{\text{H\"{o}lder}}{\leq}\int_{\Omega'}\left(\int_0^11^{p'}\right)^{1/p'}\left(\int_0^1\big|\partial_iu(x+the_i)\big|^p\right)^{1/p}dx=\int_{\Omega'}\int_0^1\big|\partial_iu(x+the_i)\big|^p\,dt\,dx\\
\underset{\text{Fubini}}{=}\int_0^1\left(\int_{\Omega'}\big|\partial_iu(x+the_i)\big|^p\,dx\right)dt\leq\int_{\Omega}|\partial_iu|^p\,dx.
\end{multline*}
Hence,
\[\sum_i\int_{\Omega'}|\partial_i^hu|^p\leq\sum_i\int_{\Omega}|\partial_iu|^p\,dx.\]

\item Tool: weak convergence in $L^p(\Omega)$.
\end{enumerate}
\end{proof}

\begin{definition}
\begin{enumerate}[label=\alph*)]
\item Let $X$ Banach, $X'$ its dual (space of continuous linear functionals $L:X\rightarrow\mathbb{R}$). A sequence $(x_n)_{n\in\mathbb{N}}$, $x_n\in X$, is said to converge \textbf{weakly} to $x\in X$, notation: $x_n\rightharpoonup x$, if
\[L(x_n)\longrightarrow L(x)\ \ \forall L\in X'.\]

\item If $X=L^p(\Omega)$, $1\leq p<\infty$, each such $L$ is known to be of form
\[L(u)=\int_{\Omega}vu\]
for some $v\in L^{p'}(\Omega)$, $\frac{1}{p'}+\frac{1}{p}=1$, i.e.,
\[\big(L^p(\Omega)\big)'\cong L^{p'}(\Omega).\]

Hence $(u_n)_{n\in\mathbb{N}}$ in $L^p(\Omega)$ converges \textbf{weakly} to $u\in L^p(\Omega)$, notation: $u_n\rightharpoonup u$, if
\[\int_{\Omega}vu_n\longrightarrow\int_{\Omega}vu\ \ \forall v\in L^{p'}(\Omega).\]
\end{enumerate}
\end{definition}

\begin{remark}
\[u_n\rightarrow u\text{ in }L^p\underset{\not\Leftarrow}{\Rightarrow}u_n\rightharpoonup u\text{ in }L^p.\]
\end{remark}

\begin{proof}
``$\Rightarrow$''
\[\left|\int_{\Omega}vu_n-\int_{\Omega}vu\right|=\left|\int_{\Omega}v(u_n-u)\right|\underset{\text{H\"{o}lder}}{\leq}||v||_{L^{p'}}||u_n-u||_{L^p}\longrightarrow0,\]
since $||v||_{L^{p'}}<\infty$ since $v\in L^{p'}$ and $||u_n-u||_{L^p}\rightarrow0$.

``$\not\Leftarrow$'' Standard counterexample:

$\Omega=[0,1]$, $u_n$ oscillates between 2 values $A$ and $B$, $\lambda\in(0,1)$ volume fraction of region where $u_n=B$,
\[u(x)=\left\{\begin{array}{cccc}B&\text{if}&\displaystyle{\frac{k}{n}<x<\frac{k+\lambda}{n},}&k\in\mathbb{N}_0,\\\\A&\text{if}&\displaystyle{\frac{k+\lambda}{n}<x<\frac{k+1}{n},}&k\in\mathbb{N}_0.\end{array}\right.\]

\begin{center}
\begin{tikzpicture}[scale=10]
%A=0.2
%B=0.5
%n=6
%lambda=2/3
\newcommand{\Avar}{0.2}
\newcommand{\Bvar}{0.5}
\newcommand{\nvar}{6}
\newcommand{\lambdavar}{2/3}
\newcommand{\exc}{0.1}
\newcommand{\tickw}{0.01}
\newcommand{\sep}{0.01}

\draw [->] (-\exc,0) -- (1+\exc,0);
\draw [->] (0,-\exc) -- (0,\Bvar+\exc);
\foreach \kvar in {1,...,\nvar} {
\draw ({(\kvar-1)/\nvar},\Bvar) -- ({(\kvar-1)/\nvar+\lambdavar/\nvar},\Bvar);
\draw ({(\kvar-1)/\nvar+\lambdavar/\nvar},\Avar) -- (\kvar/\nvar,\Avar);
\draw [dash pattern=on 4pt off 4pt] ({(\kvar-1)/\nvar+\lambdavar/\nvar},\Bvar) -- ({(\kvar-1)/\nvar+\lambdavar/\nvar},\Avar);
\ifnum\kvar<\nvar
\draw [dash pattern=on 4pt off 4pt] (\kvar/\nvar,\Avar) -- (\kvar/\nvar,\Bvar);
\fi
}
\draw (0,{\Bvar*\lambdavar+\Avar*(1-\lambdavar)}) -- (1,{\Bvar*\lambdavar+\Avar*(1-\lambdavar)});
\draw [left] (0,\Bvar+\exc) node {$u_n$};
\draw [right] (1,{\Bvar*\lambdavar+\Avar*(1-\lambdavar)}) node {$u$};
\draw [right] (1+\exc,0) node {$x$};
\draw (-\tickw,\Bvar) -- (\tickw,\Bvar);
\draw [left] (-\tickw,\Bvar) node {$B$};
\draw (-\tickw,\Avar) -- (\tickw,\Avar);
\draw [left] (-\tickw,\Avar) node {$A$};
\draw [below left] (-\tickw,-\tickw) node {$0$};
\draw (\lambdavar/\nvar,-\tickw) -- (\lambdavar/\nvar,\tickw);
\draw [below] (\lambdavar/\nvar-\sep,-\tickw) node {$\lambda\frac{1}{n}$};
\draw (1/\nvar,-\tickw) -- (1/\nvar,\tickw);
\draw [below] (1/\nvar,-\tickw) node {$\frac{1}{n}$};
\draw (1,-\tickw) -- (1,\tickw);
\draw [below] (1,-\tickw) node {$1$};
\end{tikzpicture}
\end{center}

\[u_n\underset{L^p(\Omega)}{\rightharpoonup}u(x)\equiv\lambda B+(1-\lambda)A,\]
\[||u_n-u||_{L^p(\Omega)}\equiv\text{const}>0.\]
\end{proof}

\textbf{Existence of weakly convergent subsequences}

$\Omega\subseteq\mathbb{R}^n$ measurable, $1<p<\infty$. Every bounded sequence in $L^p(\Omega)$ has a weakly convergent subsequence.

[Special case of Banach-Alaoglu theorem from functional analysis.]

\begin{proof}
(Lemma \ref{uniform_bound})
\begin{enumerate}[label=(\roman*)]
\setcounter{enumi}{1}
\item Let $u\in L^p(\Omega)$, $\varphi\in C_0^{\infty}(\Omega')$. Doing the change of variable $y=x+he_i$ for the $1$\textsuperscript{st} term and $y=x$ for the $2$\textsuperscript{nd} term,
\begin{multline}\tag{$*$}\label{minus_difference}
\int_{\Omega'}u(\partial_i^h\varphi)\,dx=\int_{\Omega'}u(x)\frac{\varphi(x+he_i)-\varphi(x)}{h}\,dx\\
=\int_{\Omega'}\frac{u(y-he_i)}{h}\varphi(y)\,dy-\int_{\Omega'}\frac{u(y)\varphi(y)}{h}\,dy=-\int_{\Omega'}(\partial_i^{-h}u)\varphi,
\end{multline}
since
\[\partial_i^{-h}u(x)=\frac{u(x-he_i)-u(x)}{-h}.\]
Like integration by parts, but forward resp. backward difference quotient.

$(\partial_i^{-h}u)$ bounded in $L^p(\Omega')$ by assumption. Hence, $\exists$ subsequence and $v_i\in L^p(\Omega')$ such that
\[\partial_i^{-h}u\rightharpoonup v_i\text{ in }L^p(\Omega').\]

Hence by passing to the limit in \eqref{minus_difference},
\[\int_{\Omega'}u\frac{\partial\varphi}{\partial x_i}=-\int_{\Omega'}v_i\varphi\ \ \forall\varphi\in C_0^{\infty}(\Omega').\]

Hence $u$ has a weak derivative $v_i\in L^p(\Omega')$ with respect to $x_i$.

True $\forall i$ $\Rightarrow$ $u\in W^{1,p}(\Omega')$. The estimate $||Du||_{L^p}\leq C$ follows from general fact in Banach spaces that
\[||x||\leq\liminf_{j\to\infty}||x_j||\ \ \forall\text{sequences }x_j\rightharpoonup x.\]
(Norm is lower semicontinuous with respect to weak convergence.)
\end{enumerate}
\end{proof}

\subsection{Interior regularity}
%Subsection 9.2
\begin{theorem}\label{interior_regularity}
%Thm 9.1
\emph{\textbf{(Interior regularity)}} Let $g\in H^2(\Omega)$, $f\in L^2(\Omega)$, $u\in H^1(\Omega)$, $u$ weak solution to
\[\left\{\begin{array}{rcl}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega.\end{array}\right.\]
Then,
\begin{enumerate}[label=(\roman*)]
\item $u\in H_{\text{loc}}^2(\Omega)$;
\item $\forall\Omega'\subset\subset\Omega$ $\exists C$ constant such that
\[||D^2u||_{L^2(\Omega')}\leq C\big(||Du||_{L^2(\Omega)}+||f||_{L^2(\Omega)}+||D^2g||_{L^2(\Omega)}\big).\]
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}[label=\arabic*.]
\item W.l.o.g. $g=0$, otherwise consider $u-g$, which is a weak solution to
\[-\Delta(u-g)=f+\Delta g\eqqcolon\tilde{f},\]
\[u-g|_{\partial\Omega}=0.\]

\item Get an estimate on difference quotients $\partial_i^h\nabla u$, by choosing a clever test function.

Recall weak formulation of PDE:
\begin{equation}\tag{W}\label{Weak}
\int_{\Omega}\nabla u\cdot\nabla v=\int_{\Omega}fv\ \ \forall v\in H_0^1(\Omega).
\end{equation}

Test function:
\[v=-\partial_i^{-h}\zeta^2\partial_i^hu,\]
where $\zeta$ is a cutoff function, $W$ chosen such that $\Omega'\subset\subset W\subset\subset\Omega$,
\[\zeta\left\{\begin{array}{lcl}=1&\text{in}&\Omega',\\\in[0,1]&\text{in}&W\setminus\Omega',\\=0&\text{in}&\Omega\setminus W.\end{array}\right.\]

Calculate:
\begin{multline*}
\int_{\Omega}f(-\partial_i^{-h}\zeta^2\partial_i^hu)=\int_{\Omega}f\cdot v=\int_{\Omega}\nabla u\cdot\nabla v=\int_{\Omega}\nabla u\cdot\big[-\underbrace{\nabla\partial_i^{-h}}_{=\partial_i^{-h}\nabla}\zeta^2\partial_i^hu\big]=\int_{\Omega}\partial_i^h\nabla u\cdot\nabla(\zeta^2\partial_i^hu)\\
=\int_{\Omega}\partial_i^h\nabla u\cdot\big((\nabla\zeta^2)\partial_i^hu+\zeta^2\nabla\partial_i^hu\big)=\underbrace{\int_{\Omega}\zeta^2|\partial_i^h\nabla u|^2}_{\geq\int_{\Omega'}|\partial_i^h\nabla u|^2}+\underbrace{\int_{\Omega}2\zeta\nabla\zeta\cdot\partial_i^h\nabla u\cdot\partial_i^hu}_{\text{idea: this is ``small''}}.
\end{multline*}

\item\label{reference_appendix} After some calculation (see appendix), we find
\[\int_{\Omega'}|\partial_i^h\nabla u|^2\leq C\big(||f||_{L^2(\Omega)}^2+||\nabla u||_{L^2(\Omega)}^2\big).\]

\item Apply Lemma \ref{uniform_bound} \ref{uniform_bound_differential}, get assertion.
\end{enumerate}
\end{proof}

\begin{corollary}
%Corollary 9.1
\emph{\textbf{(Infinite differentiability)}} If in addition $f,g\in C^{\infty}(\Omega)$, then so is the weak solution $u$. In particular, $u$ is a classical solution to the PDE $-\Delta u=f$.
\end{corollary}

\begin{proof}
Take weak derivative of PDE with respect to $x_i$. From $-\Delta u=f$, applying weak Schwarz, we get
\[-\Delta(\partial_iu)=\partial_i(-\Delta u)=\partial_if.\]

Theorem \ref{interior_regularity} for $\partial_iu$ implies $\partial_iu\in H_{\text{loc}}^2(\Omega)$ $\forall i=1,\ldots,n$, i.e., $u\in H_{\text{loc}}^3(\Omega)$.

Iterate to get
\[u\in\bigcap_{m=1}^{\infty}H_{\text{loc}}^m(\Omega).\]

Sobolev embedding theorem (\ref{Sobolev_embeddings}) implies
%Theorem 5.10
\[u\in\bigcap_{k=1}^{\infty}C^k(\Omega)=C^{\infty}(\Omega).\]
\end{proof}

\subsubsection*{Appendix}
Details, Step \ref{reference_appendix} of proof of Theorem \ref{interior_regularity}.

Since
\[ab=\frac{1}{\sqrt{2}}a\cdot\sqrt{2}b\leq\frac{a^2}{2\epsilon}+\frac{\epsilon b^2}{2},\]
\begin{multline*}
\int_{\Omega}\zeta^2|\partial_i^h\nabla u|^2=\int_{\Omega}f(-\partial_i^{-h}\zeta^2\partial_i^hu)+2\int_{\Omega}(\nabla\zeta)\partial_i^hu\cdot\zeta\partial_i^h\nabla u\\
\leq\frac{1}{2\epsilon}\int_{\Omega}f^2+\frac{\epsilon}{2}\int_{\Omega}|\partial_i^{-h}\zeta^2\partial_i^hu|^2+\frac{1}{\epsilon}\int_{\Omega}|\nabla\zeta|^2(\partial_i^hu)^2+\epsilon\int_{\Omega}\zeta^2|\partial_i^h\nabla u|^2.
\end{multline*}
\begin{multline*}
\frac{\epsilon}{2}\int_{\Omega}|\partial_i^{-h}\zeta^2\partial_i^hu|^2\underset{\text{L \ref{uniform_bound} \ref{uniform_bound_difference}}}{\leq}\frac{\epsilon}{2}\int_{\Omega}|\partial_i\zeta^2\partial_i^hu|^2=\frac{\epsilon}{2}\int_{\Omega}\big|(\partial_i\zeta^2)\partial_i^hu+\zeta^2\partial_i^h\partial_iu\big|^2\\
\underset{\substack{(a+b)^2\\\leq2a^2+2b^2}}{\leq}\epsilon\int_{\Omega}|\partial_i\zeta^2|^2(\partial_i^hu)^2+\epsilon\int_{\Omega}\underbrace{\zeta^4}_{\mathclap{\substack{\leq\zeta^2\\\text{ since }0\leq\zeta\leq1}}}|\partial_i^h\partial_iu|^2\underset{\text{L \ref{uniform_bound} \ref{uniform_bound_difference}}}{\leq}\epsilon||\nabla\zeta^2||_{\infty}\int_{\Omega}|\partial_iu|^2+\epsilon\int_{\Omega}\zeta^2|\partial_i^h\nabla u|^2.
\end{multline*}
\[\frac{1}{\epsilon}\int_{\Omega}|\nabla\zeta|^2(\partial_i^hu)^2\leq\frac{||\nabla\zeta||_{\infty}}{\epsilon}\int_{\Omega}(\partial_i^hu)^2\underset{\text{L \ref{uniform_bound} \ref{uniform_bound_difference}}}{\leq}\frac{||\nabla\zeta||_{\infty}}{\epsilon}\int_{\Omega}|\partial_iu|^2.\]

Hence,
\[(1-2\epsilon)\int_{\Omega'}|\partial_i^h\nabla u|^2\leq(1-2\epsilon)\int_{\Omega}\zeta^2|\partial_i^h\nabla u|^2\leq\frac{1}{2\epsilon}\int_{\Omega}f^2+\left(\epsilon||\nabla\zeta^2||_{\infty}+\frac{||\nabla\zeta||_{\infty}}{\epsilon}\right)\int_{\Omega}|Du|^2.\]
Choose e.g. $\epsilon=\frac{1}{3}$. Then
\[\int_{\Omega'}|\partial_i^h\nabla u|^2\leq C\big(||f||_{L^2(\Omega)}^2+||Du||_{L^2(\Omega)}^2\big),\]
with
\[C=3\cdot\max\left\{\frac{1}{2\cdot1/3},\frac{1}{3}||\nabla\zeta^2||_{\infty}+\frac{||\nabla\zeta||_{\infty}}{1/3}\right\}.\]

%28/07
\subsection{Regularity up to the boundary}
%Subsection 9.3
\begin{theorem}\label{regular_H2}
%Thm 9.2
If $\Omega\subseteq\mathbb{R}^n$ open, bounded, $C^2$ boundary, $u\in H^1(\Omega)$ weak solution to
\[\left\{\begin{array}{rcl}-\Delta u=f&\text{in}&\Omega,\\u=g&\text{on}&\partial\Omega,\end{array}\right.\]
$f\in L^2(\Omega)$, $g\in H^2(\Omega)$, then $u\in H^2(\Omega)$ and
\[||u||_{H^2(\Omega)}\leq c\big(||\nabla u||_{L^2(\Omega)}+||f||_{L^2(\Omega)}+||D^2g||_{L^2(\Omega)}\big).\]
\end{theorem}

\begin{proof}
See \cite{evans2010partial} Evans Section 6.3.
\end{proof}

\begin{corollary}
%Cor. 9.2
$\Omega$ as above. Then $-\Delta:H^2(\Omega)\cap H_0^1(\Omega)\rightarrow L^2(\Omega)$ is a continuous invertible linear operator with continuous inverse.
\end{corollary}

\begin{proof}
\begin{enumerate}[label=(\roman*)]
\item Existence of inverse operator: Theorem \ref{Poisson_Sobolev} implies $\forall f\in L^2$ $\exists(-\Delta)^{-1}f=u\in H_0^1$. Theorem \ref{regular_H2} with $g=0$ implies $\exists(-\Delta)^{-1}f=u\in H^2\cap H_0^1$.

\item Continuity of $-\Delta$: easy,
\[||-\Delta u||_{L^2}=\left|\left|\sum_{i=1}^n\partial_i^2u\right|\right|_{L^2}\leq\sum_i||\partial_i^2u||_{L^2}\leq||D^2u||_{L^2}\leq||u||_{H^2}.\]

\item Inverse of a continuous linear invertible operator between Banach spaces is always continuous (corollary of ``open mapping theorem'' of functional analysis).
\end{enumerate}
\end{proof}

Have thus completed the treatment of $-\Delta u=f$ (within modern theory of PDEs) analogously to $Ax=b$ in linear algebra.

Thus, have satisfactorily analyzed certain infinite-dimensional systems of linear equations which are of great interest in applications.

\begin{thebibliography}{1}
\bibitem{evans2010partial} L. C. Evans, \emph{Partial Differential Equations}, vol. 19. American Mathematical Soc., 2010.
\end{thebibliography}
\end{document}
